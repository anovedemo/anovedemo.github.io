<?xml version="1.0" encoding="utf-8"?>
<draftsman project-name="Demo" xmlns="https://tracepaper.draftsman.io">
	<global>
		<pattern name="ControlFrameworkArn" regex="^controlframework:[a-z0-9]+$"></pattern>
		<pattern name="ThirdPartyLink" regex="^{{ThirdPartyArn}}(;{{ThirdPartyArn}})*$"></pattern>
		<pattern name="IntegrationImplementationArn" regex="^{{CompanyArn}}:integration:[^\s]+$"></pattern>
		<pattern name="RequirementLink" regex="^{{RequirementArn}}(;{{RequirementArn}})*$"></pattern>
		<pattern name="ControlTemplateArn" regex="^controltemplate:[a-z0-9]+$"></pattern>
		<pattern name="RequirementArn" regex="^{{ControlFrameworkArn}}:[a-z0-9]+$"></pattern>
		<pattern name="ThirdPartyTaskArn" regex="^{{ThirdPartyArn}}:[^\s]+$"></pattern>
		<pattern name="RiskTemplateReference" regex="^{{RiskTemplateArn}}:[0-9]+(-PREVIEW)?$"></pattern>
		<pattern name="AssetArn" regex="^{{CompanyArn}}:asset:[^\s]+$"></pattern>
		<pattern name="ObjectiveArn" regex="^{{CompanyArn}}:objective:[^\s]+$"></pattern>
		<pattern name="RiskArn" regex="^{{CompanyArn}}:risk:[^\s]+$"></pattern>
		<pattern name="ProcessingActivityArn" regex="^{{CompanyArn}}:processingactivity:[^\s]+$"></pattern>
		<pattern name="CountryArn" regex="^{{RegionArn}}:country:[A-Z]+$"></pattern>
		<pattern name="ThirdPartyTemplateArn" regex="^thirdpartytemplate:[a-z0-9]+$"></pattern>
		<pattern name="MaturityLevel" regex="^(1|2|3|4|5)$"></pattern>
		<pattern name="ControlTemplateReference" regex="^{{ControlTemplateArn}}:[0-9]+(-PREVIEW)?$"></pattern>
		<pattern name="ControlFrameworkType" regex="^(standard|regulation|framework)$"></pattern>
		<pattern name="EmployeeArn" regex="^{{CompanyArn}}:employee:[^\s]+$"></pattern>
		<pattern name="RiskTemplateArn" regex="^risktemplate:[a-z0-9]+$"></pattern>
		<pattern name="GeoCode" regex="^[A-Z]+$"></pattern>
		<pattern name="AssessmentArn" regex="^{{CompanyArn}}:thirdparty:[^\s]+:assessment:[^\s]+$"></pattern>
		<pattern name="Date" regex="^(?:20)\d{2}-\d{2}-\d{2}$"></pattern>
		<pattern name="ThirdPartyArn" regex="^{{CompanyArn}}:thirdparty:[^\s]+$"></pattern>
		<pattern name="ProcessingActivityTaskArn" regex="^{{ProcessingActivityArn}}:[^\s]+$"></pattern>
		<pattern name="ObjectiveTaskArn" regex="^{{ObjectiveArn}}:[^\s]+$"></pattern>
		<pattern name="TenantKey" regex="^[a-z]+$"></pattern>
		<pattern name="IndustryArn" regex="^industry:[a-z]+$"></pattern>
		<pattern name="IntegrationArn" regex="^integration:[a-z0-9]+$"></pattern>
		<pattern name="AssesmentCategory" regex="^(self|control|audit|effectiveness)$"></pattern>
		<pattern name="IndustryLink" regex="^{{IndustryArn}}(;{{IndustryArn}})*$"></pattern>
		<pattern name="CompanyArn" regex="^{{TenantKey}}:company:[a-z]+$"></pattern>
		<pattern name="CiapRating" regex="^(0|1|2|3)$"></pattern>
		<pattern name="RegionArn" regex="^region:[A-Z]+$"></pattern>
		<pattern name="ControlArn" regex="^{{CompanyArn}}:control:[^\s]+$"></pattern>
		<pattern name="AssetTaskArn" regex="^{{AssetArn}}:[^\s]+$"></pattern>
		<expression name="isObjectiveAdministrator" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:objective-administrator"></expression>
		<expression name="truncateArn" type="TriggerKeyField" input="arn;length" expression="':'.join(arn.split(':')[:int(length)])"></expression>
		<expression name="isProcessingActivityAdministrator" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:processingactivity-administrator"></expression>
		<expression name="isAssessmentAdministrator" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:assessment-administrator"></expression>
		<expression name="isThirdPartyAdministrator" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:thirdparty-administrator"></expression>
		<expression name="isIntegrationAdministrator" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:integration-administrator"></expression>
		<expression name="isAssetAdministrator" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:asset-administrator"></expression>
		<expression name="isControlAdministrator" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:control-administrator"></expression>
		<expression name="isCompanyAdministrator" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:company-administrator"></expression>
		<expression name="isCompanyViewer" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:company-viewer"></expression>
		<expression name="isRiskAdministrator" type="ActorEventRole" input="arn" expression="${arn.split(':')[0]}:${arn.split(':')[1]}:${arn.split(':')[2]}:risk-administrator"></expression>
	</global>
	<events>
		<event graphql-namespace="ControlTemplate" graphql-name="update" name="UpdateControlTemplateRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="requirementLinks" type="String" pattern="{{RequirementLink}}"></field>
			<field name="arn" type="String" pattern="{{ControlTemplateArn}}"></field>
		</event>
		<event graphql-namespace="ControlTemplate" graphql-name="release" name="ReleaseControlTemplateRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ControlTemplateArn}}"></field>
		</event>
		<event graphql-namespace="ControlTemplate" graphql-name="delete" name="DeleteControlTemplateRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ControlTemplateArn}}"></field>
		</event>
		<event graphql-namespace="ControlTemplate" graphql-name="create" name="CreateControlTemplateRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="requirementLinks" type="String" pattern="{{RequirementLink}}"></field>
			<field name="arn" type="String" pattern="{{ControlTemplateArn}}"></field>
		</event>
		<event graphql-namespace="User" graphql-name="update" name="UpdateUserRequested" type="ActorEvent" authorization="authenticated">
			<field name="username" type="String" auto-fill="username"></field>
			<field name="firstName" type="String"></field>
			<field name="lastName" type="String"></field>
			<field name="email" type="String"></field>
		</event>
		<event graphql-namespace="User" graphql-name="activate" name="ActivateUserRequested" authorization="authenticated" type="ActorEvent">
			<field name="username" type="String" auto-fill="username"></field>
			<field name="firstName" type="String"></field>
			<field name="lastName" type="String"></field>
			<field name="email" type="String"></field>
		</event>
		<event graphql-namespace="RiskTemplate" graphql-name="update" name="UpdateRiskTemplateRequested" type="ActorEvent" authorization="role" role="administrator">
			<field name="arn" type="String" pattern="{{RiskTemplateArn}}"></field>
			<field name="name" type="String" default=""></field>
			<field name="description" type="String" default=""></field>
			<field name="grossLikelihood" type="Int" default="0"></field>
			<field name="grossImpact" type="Int" default="0"></field>
			<field name="reviewPeriodicity" type="String" default=""></field>
		</event>
		<event graphql-namespace="RiskTemplate" graphql-name="delete" name="DeleteRiskTemplateRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{RiskTemplateArn}}"></field>
		</event>
		<event graphql-namespace="RiskTemplate" graphql-name="create" name="CreateRiskTemplateRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{RiskTemplateArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="grossLikelihood" type="Int"></field>
			<field name="grossImpact" type="Int"></field>
			<field name="reviewPeriodicity" type="String"></field>
		</event>
		<event graphql-namespace="RiskTemplate" graphql-name="release" name="ReleaseRiskTemplateRequested" type="ActorEvent" authorization="role" role="administrator">
			<field name="arn" type="String" pattern="{{RiskTemplateArn}}"></field>
		</event>
		<event graphql-namespace="ThirdPartyTemplate" graphql-name="create" name="CreateThirdPartyTemplateRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyTemplateArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="country" type="String" pattern="{{CountryArn}}"></field>
			<field name="knownCertification" type="String"></field>
		</event>
		<event graphql-namespace="ThirdPartyTemplate" graphql-name="update" name="UpdateThirdPartyTemplateRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyTemplateArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="country" type="String" pattern="{{CountryArn}}"></field>
			<field name="knownCertification" type="String"></field>
		</event>
		<event graphql-namespace="ThirdPartyTemplate" graphql-name="delete" name="DeleteThirdPartyTemplateRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyTemplateArn}}"></field>
		</event>
		<event graphql-namespace="ControlFramework" graphql-name="add" name="AddControlFrameworkRequested" authorization="role" type="ActorEvent" role="administrator">
			<field name="arn" type="String" pattern="{{ControlFrameworkArn}}"></field>
			<field name="description" type="String"></field>
			<field name="name" type="String"></field>
			<field name="category" type="String" pattern="{{ControlFrameworkType}}"></field>
			<field name="edition" type="String"></field>
			<field name="unit" type="String"></field>
			<field name="acronym" type="String"></field>
			<field name="active" type="Boolean"></field>
		</event>
		<event graphql-namespace="ControlFramework" graphql-name="delete" name="DeleteControlFrameworkRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ControlFrameworkArn}}"></field>
		</event>
		<event graphql-namespace="ControlFramework" graphql-name="update" name="UpdateControlFrameworkRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ControlFrameworkArn}}"></field>
			<field name="description" type="String" default=""></field>
			<field name="name" type="String" default=""></field>
			<field name="category" type="String" pattern="{{ControlFrameworkType}}" default=""></field>
			<field name="edition" type="String" default=""></field>
			<field name="unit" type="String" default=""></field>
			<field name="acronym" type="String" default=""></field>
			<field name="active" type="Boolean"></field>
		</event>
		<event graphql-namespace="Tenant" graphql-name="linkStyleSheet" name="LinkStyleSheetTenantRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="reference" type="String" pattern="{{TenantKey}}"></field>
			<field name="path" type="String"></field>
		</event>
		<event graphql-namespace="Tenant" graphql-name="update" name="UpdateTenantRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="key" type="String" pattern="{{TenantKey}}"></field>
			<field name="name" type="String"></field>
		</event>
		<event graphql-namespace="Tenant" graphql-name="linkLogo" name="LinkLogoTenantRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="reference" type="String" pattern="{{TenantKey}}"></field>
			<field name="path" type="String"></field>
		</event>
		<event graphql-namespace="Tenant" graphql-name="delete" name="DeleteTenantRequested" type="ActorEvent" authorization="role" role="administrator">
			<field name="key" type="String" pattern="{{TenantKey}}"></field>
		</event>
		<event graphql-namespace="Tenant" graphql-name="create" name="CreateTenantRequested" authorization="role" type="ActorEvent" role="administrator">
			<field name="key" type="String" pattern="{{TenantKey}}"></field>
			<field name="name" type="String"></field>
		</event>
		<event graphql-namespace="Integrations" graphql-name="linkLogo" name="LinkLogoIntegrationsRequested" type="ActorEvent" authorization="role" role="administrator">
			<field name="reference" type="String" pattern="{{IntegrationArn}}"></field>
			<field name="path" type="String"></field>
		</event>
		<event graphql-namespace="Integrations" graphql-name="create" name="CreateIntegrationsRequested" type="ActorEvent" authorization="role" role="administrator">
			<field name="arn" type="String" pattern="{{IntegrationArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</event>
		<event graphql-namespace="Integrations" graphql-name="update" name="UpdateIntegrationsRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{IntegrationArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</event>
		<event graphql-namespace="Integrations" graphql-name="delete" name="DeleteIntegrationsRequested" type="ActorEvent" authorization="role" role="administrator">
			<field name="arn" type="String" pattern="{{IntegrationArn}}"></field>
		</event>
		<event graphql-namespace="Requirement" graphql-name="delete" name="DeleteRequirementRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{RequirementArn}}"></field>
		</event>
		<event graphql-namespace="Requirement" graphql-name="add" name="AddRequirementRequested" authorization="role" type="ActorEvent" role="administrator">
			<field name="arn" type="String" pattern="{{RequirementArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="mandatory" type="Boolean"></field>
			<field name="summary" type="String"></field>
		</event>
		<event graphql-namespace="Requirement" graphql-name="update" name="UpdateRequirementRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{RequirementArn}}"></field>
			<field name="name" type="String" default=""></field>
			<field name="description" type="String" default=""></field>
			<field name="mandatory" type="Boolean"></field>
			<field name="summary" type="String" default=""></field>
		</event>
		<event graphql-namespace="Company" graphql-name="linkLogo" name="LinkLogoCompanyRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="path" type="String"></field>
		</event>
		<event graphql-namespace="Company" graphql-name="unlinkControlFramework" name="UnlinkControlFrameworkCompanyRequested" authorization="role" type="ActorEvent" role="#global.isCompanyAdministrator(arn)">
			<field name="arn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="controlFrameworkArn" type="String" pattern="{{ControlFrameworkArn}}"></field>
		</event>
		<event graphql-namespace="Company" graphql-name="update" name="UpdateCompanyRequested" authorization="role" role="#global.isCompanyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="description" type="String" default=""></field>
			<field name="companySize" type="Int" default="0"></field>
			<field name="revenue" type="String" default=""></field>
			<field name="industryLink" type="String" default="" pattern="{{IndustryLink}}"></field>
			<field name="countryArn" type="String" default=""></field>
		</event>
		<event graphql-namespace="Company" graphql-name="create" name="CreateCompanyRequested" authorization="authenticated" type="ActorEvent">
			<field name="arn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="companySize" type="Int"></field>
			<field name="revenue" type="String"></field>
			<field name="industry" type="String" pattern="{{IndustryLink}}"></field>
			<field name="user" type="String" auto-fill="username"></field>
			<field name="country" type="String" pattern="{{CountryArn}}"></field>
		</event>
		<event graphql-namespace="Company" graphql-name="linkControlFramework" name="LinkControlFrameworkCompanyRequested" authorization="role" type="ActorEvent" role="#global.isCompanyAdministrator(arn)">
			<field name="arn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="controlFrameworkArn" type="String" pattern="{{ControlFrameworkArn}}"></field>
		</event>
		<event graphql-namespace="Company" graphql-name="delete" name="DeleteCompanyRequested" authorization="role" role="#global.isCompanyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{CompanyArn}}"></field>
		</event>
		<event graphql-namespace="Company.Control" graphql-name="update" name="UpdateCompanyControlRequested" authorization="role" type="ActorEvent" role="#global.isControlAdministrator(arn)">
			<field name="description" type="String"></field>
			<field name="controlTemplateArn" type="String" default=""></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="desiredMaturityLevel" type="Int"></field>
			<field name="businessUnit" type="String"></field>
			<field name="requirements" type="String" pattern="{{RequirementLink}}"></field>
			<field name="nextAssessmentDate" type="String" pattern="{{Date}}"></field>
			<field name="controlOwner" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="arn" type="String"></field>
		</event>
		<event graphql-namespace="Company.Control" graphql-name="create" name="CreateCompanyControlRequested" authorization="role" type="ActorEvent" role="#global.isControlAdministrator(companyArn)">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="controlTemplateArn" type="String" default=""></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="desiredMaturityLevel" type="Int"></field>
			<field name="businessUnit" type="String"></field>
			<field name="companyArn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="requirements" type="String" pattern="{{RequirementLink}}"></field>
			<field name="nextAssessmentDate" type="String" pattern="{{Date}}"></field>
			<field name="controlOwner" type="String" pattern="{{EmployeeArn}}"></field>
		</event>
		<event graphql-namespace="Company.Control" graphql-name="createFromTemplate" name="CreateFromTemplateCompanyControlRequested" type="ActorEvent" authorization="role" role="#global.isControlAdministrator(companyArn)">
			<field name="controlTemplateReference" type="String" pattern="{{ControlTemplateReference}}"></field>
			<field name="desiredMaturityLevel" type="Int"></field>
			<field name="businessUnit" type="String"></field>
			<field name="companyArn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="nextAssessmentDate" type="String" pattern="{{Date}}"></field>
			<field name="controlOwner" type="String" pattern="{{EmployeeArn}}"></field>
		</event>
		<event graphql-namespace="Company.Control" graphql-name="delete" name="DeleteCompanyControlRequested" authorization="role" role="#global.isControlAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ControlArn}}"></field>
		</event>
		<event graphql-namespace="Company.Control.Assessment" graphql-name="start" name="StartCompanyControlAssessmentRequested" authorization="role" type="ActorEvent" role="#global.isControlAdministrator(controlArn)">
			<field name="controlArn" type="String"></field>
			<field name="dueDate" type="String" default="" pattern="{{Date}}"></field>
			<field name="category" type="String" pattern="{{AssesmentCategory}}" default=""></field>
			<field name="assessorLink" type="String" default="" pattern="{{EmployeeArn}}"></field>
		</event>
		<event graphql-namespace="Company.Control.Assessment" graphql-name="complete" name="CompleteCompanyControlAssessmentRequested" authorization="role" type="ActorEvent" role="#global.isControlAdministrator(arn)">
			<field name="arn" type="String"></field>
		</event>
		<event graphql-namespace="Company.Control.Assessment" graphql-name="update" name="UpdateCompanyControlAssessmentRequested" authorization="role" type="ActorEvent" role="#global.isControlAdministrator(arn)">
			<field name="arn" type="String"></field>
			<nested-object name="assessment">
				<field name="dueDate" type="String" pattern="{{Date}}"></field>
				<field name="notes" type="String"></field>
				<field name="arn" type="String"></field>
				<field name="assessedMaturityLevel" type="String" pattern="{{MaturityLevel}}"></field>
				<field name="assessedMaturityDescription" type="String"></field>
				<field name="linkToEvidence" type="String"></field>
				<field name="assessorLink" type="String" pattern="{{EmployeeArn}}"></field>
			</nested-object>
		</event>
		<event graphql-namespace="Company.ThirdParty" graphql-name="delete" name="DeleteCompanyThirdPartyRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyArn}}"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty" graphql-name="linkSubprocessor" name="LinkSubprocessorCompanyThirdPartyRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyArn}}"></field>
			<field name="subprocessorArn" type="String" pattern="{{ThirdPartyArn}}"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty" graphql-name="update" name="UpdateCompanyThirdPartyRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="role" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="country" type="String" pattern="{{CountryArn}}"></field>
			<field name="knownCertification" type="String"></field>
			<field name="isCritical" type="Boolean"></field>
			<field name="isDirectThirdParty" type="Boolean"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty" graphql-name="create" name="CreateCompanyThirdPartyRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="role" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="country" type="String" pattern="{{CountryArn}}"></field>
			<field name="knownCertification" type="String"></field>
			<field name="isCritical" type="Boolean"></field>
			<field name="isDirectThirdParty" type="Boolean"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty" graphql-name="unlinkSubprocessor" name="UnlinkSubprocessorCompanyThirdPartyRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyArn}}"></field>
			<field name="subprocessorArn" type="String" pattern="{{ThirdPartyArn}}"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty" graphql-name="createFromTemplate" name="CreateFromTemplateCompanyThirdPartyRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyArn}}"></field>
			<field name="role" type="String"></field>
			<field name="isCritical" type="Boolean"></field>
			<field name="isDirectThirdParty" type="Boolean"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="templateArn" type="String" pattern="{{ThirdPartyTemplateArn}}"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty.Assessment" graphql-name="create" name="CreateCompanyThirdPartyAssessmentRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{AssessmentArn}}"></field>
			<field name="name" type="String"></field>
			<field name="formBricksId" type="String"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty.Assessment" graphql-name="delete" name="DeleteCompanyThirdPartyAssessmentRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{AssessmentArn}}"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty.Assessment" graphql-name="update" name="UpdateCompanyThirdPartyAssessmentRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{AssessmentArn}}"></field>
			<field name="name" type="String"></field>
			<field name="formBricksId" type="String"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty.Task" graphql-name="update" name="UpdateCompanyThirdPartyTaskRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyTaskArn}}"></field>
			<field name="name" type="String" default=""></field>
			<field name="description" type="String" default=""></field>
			<field name="assignee" type="String" pattern="{{EmployeeArn}}" default=""></field>
			<field name="dueDate" type="String" default="" pattern="{{Date}}"></field>
			<field name="notes" type="String" default="default value"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty.Task" graphql-name="create" name="CreateCompanyThirdPartyTaskRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyTaskArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="dueDate" type="String" pattern="{{Date}}"></field>
			<field name="notes" type="String"></field>
		</event>
		<event graphql-namespace="Company.ThirdParty.Task" graphql-name="complete" name="CompleteCompanyThirdPartyTaskRequested" authorization="role" role="#global.isThirdPartyAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ThirdPartyTaskArn}}"></field>
			<field name="username" type="String" auto-fill="username"></field>
		</event>
		<event graphql-namespace="Company.Employee" graphql-name="updateRoles" name="UpdateRolesCompanyEmployeeRequested" authorization="role" type="ActorEvent" role="#global.isCompanyAdministrator(arn)">
			<field name="arn" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="roles" type="String"></field>
		</event>
		<event graphql-namespace="Company.BusinessUnit" graphql-name="remove" name="RemoveCompanyBusinessUnitRequested" authorization="role" type="ActorEvent" role="#global.isCompanyAdministrator(arn)">
			<field name="arn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="name" type="String"></field>
		</event>
		<event graphql-namespace="Company.BusinessUnit" graphql-name="add" name="AddCompanyBusinessUnitRequested" authorization="role" type="ActorEvent" role="#global.isCompanyAdministrator(arn)">
			<field name="arn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</event>
		<event graphql-namespace="Company.BusinessUnit" graphql-name="update" name="UpdateCompanyBusinessUnitRequested" authorization="role" type="ActorEvent" role="#global.isCompanyAdministrator(arn)">
			<field name="arn" type="String" pattern="{{CompanyArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</event>
		<event graphql-namespace="Company.IntegrationImplementation" graphql-name="addNote" name="AddNoteCompanyIntegrationImplementationRequested" authorization="role" role="#global.isIntegrationAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{IntegrationImplementationArn}}"></field>
			<field name="uuid" type="String" auto-fill="uuid"></field>
			<field name="message" type="String"></field>
			<field name="user" type="String" auto-fill="username"></field>
		</event>
		<event graphql-namespace="Company.IntegrationImplementation" graphql-name="request" name="RequestCompanyIntegrationImplementationRequested" authorization="role" role="#global.isIntegrationAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{IntegrationImplementationArn}}"></field>
			<field name="requirements" type="String"></field>
			<field name="reference" type="String" pattern="{{IntegrationArn}}"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
		</event>
		<event graphql-namespace="Company.IntegrationImplementation" graphql-name="changeStatus" name="ChangeStatusCompanyIntegrationImplementationRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{IntegrationImplementationArn}}"></field>
			<field name="uuid" type="String" auto-fill="uuid"></field>
			<field name="message" type="String"></field>
			<field name="user" type="String" auto-fill="username"></field>
			<field name="status" type="String"></field>
		</event>
		<event graphql-namespace="Company.IntegrationImplementation" graphql-name="delete" name="DeleteCompanyIntegrationImplementationRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{IntegrationImplementationArn}}"></field>
		</event>
		<event graphql-namespace="Company.Objective" graphql-name="create" name="CreateCompanyObjectiveRequested" authorization="role" role="#global.isObjectiveAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ObjectiveArn}}"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="startDate" type="String" pattern="{{Date}}"></field>
			<field name="dueDate" type="String" pattern="{{Date}}"></field>
			<field name="definitionOfDone" type="String"></field>
			<field name="name" type="String"></field>
		</event>
		<event graphql-namespace="Company.Objective" graphql-name="update" name="UpdateCompanyObjectiveRequested" authorization="role" role="#global.isObjectiveAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ObjectiveArn}}"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}" default=""></field>
			<field name="dueDate" type="String" pattern="{{Date}}" default=""></field>
			<field name="definitionOfDone" type="String" default=""></field>
			<field name="completionPercentage" type="Int" default="0"></field>
			<field name="name" type="String" default=""></field>
		</event>
		<event graphql-namespace="Company.Objective" graphql-name="reopen" name="ReopenCompanyObjectiveRequested" authorization="role" role="#global.isObjectiveAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ObjectiveArn}}"></field>
		</event>
		<event graphql-namespace="Company.Objective" graphql-name="delete" name="DeleteCompanyObjectiveRequested" authorization="role" role="#global.isObjectiveAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ObjectiveArn}}"></field>
		</event>
		<event graphql-namespace="Company.Objective.Task" graphql-name="update" name="UpdateCompanyObjectiveTaskRequested" type="ActorEvent" authorization="role" role="#global.isObjectiveAdministrator(arn)">
			<field name="arn" type="String" pattern="{{ObjectiveTaskArn}}"></field>
			<field name="name" type="String" default=""></field>
			<field name="description" type="String" default=""></field>
			<field name="assignee" type="String" pattern="{{EmployeeArn}}" default=""></field>
			<field name="dueDate" type="String" pattern="{{Date}}" default=""></field>
			<field name="notes" type="String" default=""></field>
		</event>
		<event graphql-namespace="Company.Objective.Task" graphql-name="complete" name="CompleteCompanyObjectiveTaskRequested" authorization="role" role="#global.isObjectiveAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ObjectiveTaskArn}}"></field>
			<field name="username" type="String" auto-fill="username"></field>
		</event>
		<event graphql-namespace="Company.Objective.Task" graphql-name="create" name="CreateCompanyObjectiveTaskRequested" type="ActorEvent" authorization="role" role="#global.isObjectiveAdministrator(arn)">
			<field name="arn" type="String" pattern="{{ObjectiveTaskArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="dueDate" type="String" pattern="{{Date}}"></field>
			<field name="notes" type="String"></field>
		</event>
		<event graphql-namespace="Company.Asset" graphql-name="create" name="CreateCompanyAssetRequested" type="ActorEvent" authorization="role" role="#global.isAssetAdministrator(arn)">
			<field name="arn" type="String" pattern="{{AssetArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="confidentiality" type="String" pattern="{{CiapRating}}"></field>
			<field name="integrity" type="String" pattern="{{CiapRating}}"></field>
			<field name="availability" type="String" pattern="{{CiapRating}}"></field>
			<field name="privacy" type="String" pattern="{{CiapRating}}"></field>
		</event>
		<event graphql-namespace="Company.Asset" graphql-name="delete" name="DeleteCompanyAssetRequested" authorization="role" role="#global.isAssetAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{AssetArn}}"></field>
		</event>
		<event graphql-namespace="Company.Asset" graphql-name="update" name="UpdateCompanyAssetRequested" authorization="role" role="#global.isAssetAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{AssetArn}}"></field>
			<field name="name" type="String" default=""></field>
			<field name="description" type="String" default=""></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}" default=""></field>
			<field name="confidentiality" type="String" pattern="{{CiapRating}}" default=""></field>
			<field name="integrity" type="String" pattern="{{CiapRating}}" default=""></field>
			<field name="availability" type="String" pattern="{{CiapRating}}" default=""></field>
			<field name="privacy" type="String" pattern="{{CiapRating}}" default=""></field>
		</event>
		<event graphql-namespace="Company.Asset.Task" graphql-name="complete" name="CompleteCompanyAssetTaskRequested" type="ActorEvent" authorization="authenticated">
			<field name="arn" type="String" pattern="{{AssetTaskArn}}"></field>
			<field name="username" type="String" auto-fill="username"></field>
		</event>
		<event graphql-namespace="Company.Asset.Task" graphql-name="update" name="UpdateCompanyAssetTaskRequested" authorization="role" role="#global.isAssetAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{AssetTaskArn}}"></field>
			<field name="name" type="String" default=""></field>
			<field name="description" type="String" default=""></field>
			<field name="assignee" type="String" pattern="{{EmployeeArn}}" default=""></field>
			<field name="dueDate" type="String" pattern="{{Date}}" default=""></field>
			<field name="notes" type="String" default=""></field>
		</event>
		<event graphql-namespace="Company.Asset.Task" graphql-name="create" name="CreateCompanyAssetTaskRequested" type="ActorEvent" authorization="role" role="#global.isAssetAdministrator(arn)">
			<field name="arn" type="String" pattern="{{AssetTaskArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="dueDate" type="String" pattern="{{Date}}"></field>
			<field name="notes" type="String"></field>
		</event>
		<event graphql-namespace="Company.ProcessingActivity" graphql-name="create" name="CreateCompanyProcessingActivityRequested" authorization="role" role="#global.isProcessingActivityAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ProcessingActivityArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="requiresDpia" type="Boolean"></field>
			<field name="weight" type="Int"></field>
		</event>
		<event graphql-namespace="Company.ProcessingActivity" graphql-name="update" name="UpdateCompanyProcessingActivityRequested" authorization="role" role="#global.isProcessingActivityAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ProcessingActivityArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="requiresDpia" type="Boolean"></field>
			<field name="weight" type="Int"></field>
		</event>
		<event graphql-namespace="Company.ProcessingActivity" graphql-name="delete" name="DeleteCompanyProcessingActivityRequested" authorization="role" role="#global.isProcessingActivityAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ProcessingActivityArn}}"></field>
		</event>
		<event graphql-namespace="Company.ProcessingActivity.Task" graphql-name="update" name="UpdateCompanyProcessingActivityTaskRequested" authorization="role" role="#global.isProcessingActivityAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ProcessingActivityTaskArn}}"></field>
			<field name="name" type="String" default=""></field>
			<field name="description" type="String" default=""></field>
			<field name="assignee" type="String" pattern="{{EmployeeArn}}" default=""></field>
			<field name="dueDate" type="String" pattern="{{Date}}" default=""></field>
			<field name="notes" type="String" default=""></field>
		</event>
		<event graphql-namespace="Company.ProcessingActivity.Task" graphql-name="create" name="CreateCompanyProcessingActivityTaskRequested" authorization="role" role="#global.isProcessingActivityAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ProcessingActivityTaskArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="dueDate" type="String" pattern="{{Date}}"></field>
			<field name="notes" type="String"></field>
		</event>
		<event graphql-namespace="Company.ProcessingActivity.Task" graphql-name="complete" name="CompleteCompanyProcessingActivityTaskRequested" authorization="role" role="#global.isProcessingActivityAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{ProcessingActivityTaskArn}}"></field>
			<field name="username" type="String" auto-fill="username"></field>
		</event>
		<event graphql-namespace="Company.Risk" graphql-name="startAssessment" name="StartAssessmentCompanyRiskRequested" authorization="role" type="ActorEvent" role="#global.isRiskAdministrator(arn)">
			<field name="arn" type="String"></field>
			<field name="id" type="String" auto-fill="uuid"></field>
		</event>
		<event graphql-namespace="Company.Risk" graphql-name="createFromTemplate" name="CreateFromTemplateCompanyRiskRequested" type="ActorEvent" authorization="role" role="#global.isRiskAdministrator(arn)">
			<field name="arn" type="String" pattern="{{RiskArn}}"></field>
			<field name="template" type="String" pattern="{{RiskTemplateReference}}"></field>
			<field name="apetiteLikelihood" type="Int"></field>
			<field name="apetiteImpact" type="Int"></field>
			<field name="nextReviewDate" type="String" pattern="{{Date}}"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
		</event>
		<event graphql-namespace="Company.Risk" graphql-name="delete" name="DeleteCompanyRiskRequested" authorization="role" role="#global.isRiskAdministrator(arn)" type="ActorEvent">
			<field name="arn" type="String" pattern="{{RiskArn}}"></field>
		</event>
		<event graphql-namespace="Company.Risk" graphql-name="update" name="UpdateCompanyRiskRequested" authorization="role" type="ActorEvent" role="#global.isRiskAdministrator(arn)">
			<field name="arn" type="String"></field>
			<field name="description" type="String"></field>
			<field name="grossLikelihood" type="Int"></field>
			<field name="grossImpact" type="Int"></field>
			<field name="apetiteLikelihood" type="Int"></field>
			<field name="apetiteImpact" type="Int"></field>
			<field name="reviewPeriodicity" type="String"></field>
			<field name="nextReviewDate" type="String"></field>
			<field name="owner" type="String" pattern="{{EmployeeArn}}"></field>
			<nested-object name="controlLinks">
				<field name="arn" type="String"></field>
				<field name="impactOnRisk" type="Int"></field>
			</nested-object>
			<nested-object name="treatmentPlan">
				<field name="type" type="String"></field>
				<field name="description" type="String"></field>
			</nested-object>
		</event>
		<event graphql-namespace="Company.Risk" graphql-name="create" name="CreateCompanyRiskRequested" authorization="role" type="ActorEvent" role="#global.isRiskAdministrator(arn)">
			<field name="arn" type="String" pattern="{{RiskArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="grossLikelihood" type="Int"></field>
			<field name="grossImpact" type="Int"></field>
			<field name="apetiteLikelihood" type="Int"></field>
			<field name="apetiteImpact" type="Int"></field>
			<field name="reviewPeriodicity" type="String"></field>
			<field name="nextReviewDate" type="String"></field>
			<field name="owner" type="String"></field>
			<nested-object name="controlLinks">
				<field name="arn" type="String"></field>
				<field name="impactOnRisk" type="Int"></field>
			</nested-object>
			<nested-object name="treatmentPlan">
				<field name="type" type="String"></field>
				<field name="description" type="String"></field>
			</nested-object>
		</event>
		<event graphql-namespace="Company.Risk.Action" graphql-name="update" name="UpdateCompanyRiskActionRequested" authorization="role" type="ActorEvent" role="#global.isRiskAdministrator(arn)">
			<field name="arn" type="String"></field>
			<nested-object name="actions">
				<field name="name" type="String" default=""></field>
				<field name="description" type="String" default=""></field>
				<field name="assignee" type="String" default=""></field>
				<field name="dueDate" type="String" default=""></field>
				<field name="notes" type="String" default=""></field>
				<field name="id" type="String"></field>
			</nested-object>
		</event>
		<event graphql-namespace="Company.Risk.Action" graphql-name="create" name="CreateCompanyRiskActionRequested" authorization="role" type="ActorEvent" role="#global.isRiskAdministrator(arn)">
			<field name="arn" type="String"></field>
			<field name="id" type="String" auto-fill="uuid"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String" pattern="{{EmployeeArn}}"></field>
			<field name="dueDate" type="String" pattern="{{Date}}"></field>
		</event>
		<event graphql-namespace="Company.Risk.Action" graphql-name="complete" name="CompleteCompanyRiskActionRequested" authorization="role" type="ActorEvent" role="#global.isRiskAdministrator(arn)">
			<field name="arn" type="String"></field>
		</event>
		<event graphql-namespace="Industry" graphql-name="add" name="AddIndustryRequested" authorization="role" type="ActorEvent" role="administrator">
			<field name="arn" type="String" pattern="{{IndustryArn}}"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</event>
		<event graphql-namespace="Industry" graphql-name="delete" name="DeleteIndustryRequested" authorization="role" role="administrator" type="ActorEvent">
			<field name="arn" type="String" pattern="{{IndustryArn}}"></field>
		</event>
		<event graphql-namespace="Industry" graphql-name="update" name="UpdateIndustryRequested" type="ActorEvent" authorization="role" role="administrator">
			<field name="arn" type="String"></field>
			<field name="name" type="String" default=""></field>
			<field name="description" type="String" default=""></field>
		</event>
		<event graphql-namespace="Region" graphql-name="delete" name="DeleteRegionRequested" type="ActorEvent" authorization="role" role="administrator">
			<field name="arn" type="String" pattern="{{RegionArn}}"></field>
		</event>
		<event graphql-namespace="Region" graphql-name="update" name="UpdateRegionRequested" authorization="role" type="ActorEvent" role="administrator">
			<field name="arn" type="String" pattern="{{RegionArn}}"></field>
			<field name="code" type="String" pattern="{{GeoCode}}"></field>
			<field name="name" type="String"></field>
			<nested-object name="countries">
				<field name="name" type="String"></field>
				<field name="code" type="String" pattern="{{GeoCode}}"></field>
			</nested-object>
		</event>
		<event name="AssessmentUpdated" source="Customer.Control" type="DomainEvent">
			<field name="arn" type="String"></field>
			<nested-object name="assessment" business-key="arn">
				<field name="dueDate" type="String"></field>
				<field name="notes" type="String"></field>
				<field name="arn" type="String"></field>
				<field name="assessedMaturityLevel" type="String"></field>
				<field name="assessedMaturityDescription" type="String"></field>
				<field name="linkToEvidence" type="String"></field>
				<field name="assessorLink" type="String" default=""></field>
			</nested-object>
		</event>
		<event name="AssessmentCompleted" source="Customer.Control" type="DomainEvent">
			<field name="lastAssessmentDate" type="String"></field>
			<field name="nextAssessmentDate" type="String"></field>
			<field name="hasPendingSelfAssessment" type="Boolean"></field>
			<nested-object name="assessment" business-key="arn">
				<field name="completeDate" type="String"></field>
				<field name="arn" type="String"></field>
			</nested-object>
		</event>
		<event name="ControlUpdated" source="Customer.Control" type="DomainEvent">
			<field name="description" type="String"></field>
			<field name="controlTemplateArn" type="String"></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="desiredMaturityLevel" type="Int"></field>
			<field name="businessUnit" type="String"></field>
			<field name="nextAssessmentDate" type="String"></field>
			<field name="controlOwner" type="String"></field>
		</event>
		<event name="LinkedRequirements" source="Customer.Control" type="DomainEvent">
			<field name="requirements" type="String"></field>
		</event>
		<event name="AssessmentStarted" source="Customer.Control" type="DomainEvent">
			<nested-object name="assessment" business-key="arn">
				<field name="dueDate" type="String"></field>
				<field name="category" type="String"></field>
				<field name="arn" type="String"></field>
				<field name="assessorLink" type="String" default=""></field>
			</nested-object>
			<field name="arn" type="String"></field>
			<field name="hasPendingSelfAssessment" type="Boolean"></field>
			<field name="nextAssessmentDate" type="String"></field>
		</event>
		<event name="ControlDeleted" source="Customer.Control" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="ControlCreated" source="Customer.Control" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="controlTemplateArn" type="String"></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="lastAssessmentDate" type="String"></field>
			<field name="applicability" type="Boolean"></field>
			<field name="desiredMaturityLevel" type="Int"></field>
			<field name="businessUnit" type="String"></field>
			<field name="companyArn" type="String"></field>
			<field name="arn" type="String"></field>
			<field name="nextAssessmentDate" type="String"></field>
			<field name="controlOwner" type="String"></field>
		</event>
		<event name="IntegrationImplementationDeleted" source="Customer.IntegrationImplementation" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="IntegrationImplementationCreated" source="Customer.IntegrationImplementation" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="status" type="String"></field>
			<field name="requirements" type="String"></field>
			<field name="reference" type="String"></field>
			<field name="owner" type="String"></field>
		</event>
		<event name="IntegrationImplementationNoteAdded" source="Customer.IntegrationImplementation" type="DomainEvent">
			<field name="uuid" type="String"></field>
			<field name="message" type="String"></field>
			<field name="user" type="String"></field>
			<field name="status" type="String"></field>
		</event>
		<event name="ObjectiveDeleted" source="Customer.Objective" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="ObjectiveReopened" source="Customer.Objective" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="ObjectiveUpdated" source="Customer.Objective" type="DomainEvent">
			<field name="owner" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="definitionOfDone" type="String"></field>
			<field name="completionPercentage" type="Int"></field>
			<field name="name" type="String"></field>
		</event>
		<event name="ObjectiveTaskCreated" source="Customer.Objective" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="ObjectiveTaskCompleted" source="Customer.Objective" type="DomainEvent">
			<field name="completeDate" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="ObjectiveTaskUpdated" source="Customer.Objective" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="ObjectiveCreated" source="Customer.Objective" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="owner" type="String"></field>
			<field name="startDate" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="definitionOfDone" type="String"></field>
			<field name="name" type="String"></field>
		</event>
		<event name="AssetTaskUpdated" source="Customer.Asset" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="AssetCreated" source="Customer.Asset" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="owner" type="String"></field>
			<field name="confidentiality" type="String"></field>
			<field name="integrity" type="String"></field>
			<field name="availability" type="String"></field>
			<field name="privacy" type="String"></field>
		</event>
		<event name="AssetTaskCompleted" source="Customer.Asset" type="DomainEvent">
			<field name="completeDate" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="AssetTaskCreated" source="Customer.Asset" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="AssetDeleted" source="Customer.Asset" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="AssetUpdated" source="Customer.Asset" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="owner" type="String"></field>
			<field name="confidentiality" type="String"></field>
			<field name="integrity" type="String"></field>
			<field name="availability" type="String"></field>
			<field name="privacy" type="String"></field>
		</event>
		<event name="ProcessingActivityTaskCreated" source="Customer.ProcessingActivity" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="ProcessingActivityTaskCompleted" source="Customer.ProcessingActivity" type="DomainEvent">
			<field name="completeDate" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="ProcessingActivityUpdated" source="Customer.ProcessingActivity" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="owner" type="String"></field>
			<field name="requiresDpia" type="Boolean"></field>
			<field name="weight" type="Int"></field>
		</event>
		<event name="ProcessingActivityDeleted" source="Customer.ProcessingActivity" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="ProcessingActivityCreated" source="Customer.ProcessingActivity" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="owner" type="String"></field>
			<field name="requiresDpia" type="Boolean"></field>
			<field name="weight" type="Int"></field>
		</event>
		<event name="ProcessingActivityTaskUpdated" source="Customer.ProcessingActivity" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="BusinessUnitRemoved" source="Customer.Company" type="DomainEvent">
			<field name="name" type="String"></field>
		</event>
		<event name="RolesUpdated" source="Customer.Company" type="DomainEvent">
			<field name="employeeArn" type="String"></field>
			<field name="roles" type="String"></field>
			<field name="username" type="String"></field>
		</event>
		<event name="CompanyLogoLinked" source="Customer.Company" type="DomainEvent">
			<field name="logoPath" type="String"></field>
		</event>
		<event name="EmployeeArnUpdated" source="Customer.Company" type="DomainEvent">
			<field name="employeeArn" type="String"></field>
			<field name="oldArn" type="String"></field>
			<field name="roles" type="String"></field>
			<field name="username" type="String"></field>
		</event>
		<event name="BusinessUnitAdded" source="Customer.Company" type="DomainEvent">
			<field name="arn" type="String"></field>
			<nested-object name="businessUnits" business-key="newField">
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
			</nested-object>
		</event>
		<event name="BusinessUnitUpdated" source="Customer.Company" type="DomainEvent">
			<field name="arn" type="String"></field>
			<nested-object name="businessUnits" business-key="newField">
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
			</nested-object>
		</event>
		<event name="CompanyCreated" source="Customer.Company" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="companySize" type="Int"></field>
			<field name="revenue" type="String"></field>
			<field name="industry" type="String"></field>
			<field name="user" type="String"></field>
			<field name="country" type="String"></field>
			<field name="roles" type="StringList"></field>
		</event>
		<event name="CompanyDeleted" source="Customer.Company" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="LinkedControlFrameworkToCompany" source="Customer.Company" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="controlFrameworkArn" type="String"></field>
		</event>
		<event name="UnlinkedControlFrameworkFromCompany" source="Customer.Company" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="controlFrameworkArn" type="String"></field>
		</event>
		<event name="CompanyUpdated" source="Customer.Company" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="description" type="String"></field>
			<field name="companySize" type="Int"></field>
			<field name="revenue" type="String"></field>
			<field name="industryLink" type="String"></field>
			<field name="countryArn" type="String"></field>
		</event>
		<event name="RiskActionUpdated" source="Customer.Risk" type="DomainEvent">
			<field name="arn" type="String"></field>
			<nested-object name="actions" business-key="id">
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="assignee" type="String"></field>
				<field name="dueDate" type="String"></field>
				<field name="notes" type="String"></field>
				<field name="id" type="String"></field>
			</nested-object>
		</event>
		<event name="RiskActionCreated" source="Customer.Risk" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="hasPendingSelfAssessment" type="Boolean"></field>
			<nested-object name="actions" business-key="id">
				<field name="id" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="assignee" type="String"></field>
				<field name="dueDate" type="String"></field>
				<field name="arn" type="String"></field>
				<field name="category" type="String"></field>
			</nested-object>
		</event>
		<event name="RiskUpdated" source="Customer.Risk" type="DomainEvent">
			<field name="description" type="String"></field>
			<field name="grossLikelihood" type="Int"></field>
			<field name="grossImpact" type="Int"></field>
			<field name="apetiteLikelihood" type="Int"></field>
			<field name="apetiteImpact" type="Int"></field>
			<field name="reviewPeriodicity" type="String"></field>
			<field name="nextReviewDate" type="String"></field>
			<field name="owner" type="String"></field>
			<nested-object name="changeLog" business-key="timestamp">
				<field name="timestamp" type="String"></field>
				<field name="description" type="String"></field>
				<field name="user" type="String"></field>
			</nested-object>
			<nested-object name="controlLinks" business-key="newField">
				<field name="arn" type="String"></field>
				<field name="impactOnRisk" type="Int"></field>
			</nested-object>
			<nested-object name="treatmentPlan" business-key="type">
				<field name="type" type="String"></field>
				<field name="description" type="String"></field>
			</nested-object>
		</event>
		<event name="RiskActionCompleted" source="Customer.Risk" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="hasPendingSelfAssessment" type="Boolean"></field>
			<field name="lastReviewDate" type="String"></field>
			<field name="nextReviewDate" type="String"></field>
			<nested-object name="actions" business-key="id">
				<field name="completeDate" type="String"></field>
				<field name="id" type="String"></field>
			</nested-object>
		</event>
		<event name="RiskDeleted" source="Customer.Risk" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="RiskCreated" source="Customer.Risk" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="grossLikelihood" type="Int"></field>
			<field name="grossImpact" type="Int"></field>
			<field name="apetiteLikelihood" type="Int"></field>
			<field name="apetiteImpact" type="Int"></field>
			<field name="reviewPeriodicity" type="String"></field>
			<field name="nextReviewDate" type="String"></field>
			<field name="owner" type="String"></field>
			<nested-object name="changeLog" business-key="timestamp">
				<field name="timestamp" type="String"></field>
				<field name="description" type="String"></field>
				<field name="user" type="String"></field>
			</nested-object>
			<nested-object name="controlLinks" business-key="newField">
				<field name="arn" type="String"></field>
				<field name="impactOnRisk" type="Int"></field>
			</nested-object>
			<nested-object name="treatmentPlan" business-key="type">
				<field name="type" type="String"></field>
				<field name="description" type="String"></field>
			</nested-object>
		</event>
		<event name="ThirdPartyTaskCreated" source="ThirdPartyManagement.ThirdParty" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="ThirdPartyCreated" source="ThirdPartyManagement.ThirdParty" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="role" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="country" type="String"></field>
			<field name="knownCertification" type="String"></field>
			<field name="isCritical" type="Boolean"></field>
			<field name="isDirectThirdParty" type="Boolean"></field>
			<field name="owner" type="String"></field>
		</event>
		<event name="ThirdPartyTaskCompleted" source="ThirdPartyManagement.ThirdParty" type="DomainEvent">
			<field name="completeDate" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="SubprocessorLinkedToThirdParty" source="ThirdPartyManagement.ThirdParty" type="DomainEvent">
			<field name="subprocessorArn" type="String"></field>
		</event>
		<event name="ThirdPartyTaskUpdated" source="ThirdPartyManagement.ThirdParty" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String"></field>
		</event>
		<event name="ThirdPartyDeleted" source="ThirdPartyManagement.ThirdParty" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="SubprocessorUnlinkedFromThirdParty" source="ThirdPartyManagement.ThirdParty" type="DomainEvent">
			<field name="subprocessorArn" type="String"></field>
		</event>
		<event name="ThirdPartyUpdated" source="ThirdPartyManagement.ThirdParty" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="role" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="country" type="String"></field>
			<field name="knownCertification" type="String"></field>
			<field name="isCritical" type="Boolean"></field>
			<field name="isDirectThirdParty" type="Boolean"></field>
			<field name="owner" type="String"></field>
		</event>
		<event name="AssessmentCreated" source="ThirdPartyManagement.Assessment" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="formBricksId" type="String"></field>
		</event>
		<event name="AssessmentQuestionaireUpdated" source="ThirdPartyManagement.Assessment" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="formBricksId" type="String"></field>
		</event>
		<event name="AssessmentDeleted" source="ThirdPartyManagement.Assessment" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="ControlTemplateUpdated" source="Admin.ControlTemplate" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="requirementArns" type="String"></field>
			<field name="templateVersion" type="String"></field>
			<field name="reference" type="String"></field>
		</event>
		<event name="ControlTemplateDeleted" source="Admin.ControlTemplate" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="ControlTemplateReleased" source="Admin.ControlTemplate" type="DomainEvent">
			<field name="templateVersion" type="String"></field>
			<field name="reference" type="String"></field>
			<field name="previousVersion" type="String"></field>
		</event>
		<event name="ControlTemplateCreated" source="Admin.ControlTemplate" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="requirementArns" type="String"></field>
			<field name="arn" type="String"></field>
			<field name="templateVersion" type="String"></field>
		</event>
		<event name="CompanyAdministratorCreated" source="Admin.User" type="DomainEvent">
			<field name="username" type="String"></field>
			<field name="companyArn" type="String"></field>
		</event>
		<event name="UserUpdated" source="Admin.User" type="DomainEvent">
			<field name="firstName" type="String"></field>
			<field name="lastName" type="String"></field>
			<field name="email" type="String"></field>
		</event>
		<event name="UserActivated" source="Admin.User" type="DomainEvent">
			<field name="username" type="String"></field>
			<field name="firstName" type="String"></field>
			<field name="lastName" type="String"></field>
			<field name="active" type="Boolean"></field>
			<field name="email" type="String"></field>
			<field name="companyArn" type="String"></field>
		</event>
		<event name="UserAddedToCompany" source="Admin.User" type="DomainEvent">
			<field name="username" type="String"></field>
			<field name="active" type="Boolean"></field>
			<nested-object name="companies" business-key="arn">
				<field name="arn" type="String"></field>
				<field name="employeeArn" type="String"></field>
			</nested-object>
		</event>
		<event name="RiskTemplateDeleted" source="Admin.RiskTemplate" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="RiskTemplateUpdated" source="Admin.RiskTemplate" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="grossLikelihood" type="Int"></field>
			<field name="grossImpact" type="Int"></field>
			<field name="reviewPeriodicity" type="String"></field>
			<field name="templateVersion" type="String"></field>
			<field name="reference" type="String"></field>
		</event>
		<event name="RiskTemplateCreated" source="Admin.RiskTemplate" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="grossLikelihood" type="Int"></field>
			<field name="grossImpact" type="Int"></field>
			<field name="reviewPeriodicity" type="String"></field>
			<field name="templateVersion" type="String"></field>
		</event>
		<event name="RiskTemplateReleased" source="Admin.RiskTemplate" type="DomainEvent">
			<field name="templateVersion" type="String"></field>
			<field name="reference" type="String"></field>
			<field name="previousVersion" type="String"></field>
		</event>
		<event name="ThirdPartyTemplateCreated" source="Admin.ThirdPartyTemplate" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="country" type="String"></field>
			<field name="knownCertification" type="String"></field>
		</event>
		<event name="ThirdPartyTemplateDeleted" source="Admin.ThirdPartyTemplate" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="ThirdPartyTemplateUpdated" source="Admin.ThirdPartyTemplate" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="country" type="String"></field>
			<field name="knownCertification" type="String"></field>
		</event>
		<event name="ControlFrameworkCreated" source="Admin.ControlFramework" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="description" type="String"></field>
			<field name="name" type="String"></field>
			<field name="category" type="String"></field>
			<field name="edition" type="String"></field>
			<field name="unit" type="String"></field>
			<field name="acronym" type="String"></field>
			<field name="active" type="Boolean"></field>
		</event>
		<event name="ControlFrameworkUpdated" source="Admin.ControlFramework" type="DomainEvent">
			<field name="description" type="String"></field>
			<field name="name" type="String"></field>
			<field name="category" type="String"></field>
			<field name="edition" type="String"></field>
			<field name="unit" type="String"></field>
			<field name="acronym" type="String"></field>
			<field name="active" type="Boolean"></field>
		</event>
		<event name="ControlFrameworkDeleted" source="Admin.ControlFramework" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="TenantCreated" source="Admin.Tenant" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="key" type="String"></field>
		</event>
		<event name="StyleSheetLinked" source="Admin.Tenant" type="DomainEvent">
			<field name="css" type="String"></field>
		</event>
		<event name="TenantLogoLinked" source="Admin.Tenant" type="DomainEvent">
			<field name="logoPath" type="String"></field>
		</event>
		<event name="TenantUpdated" source="Admin.Tenant" type="DomainEvent">
			<field name="name" type="String"></field>
		</event>
		<event name="TenantDeleted" source="Admin.Tenant" type="DomainEvent">
			<field name="key" type="String"></field>
		</event>
		<event name="IntegrationDeleted" source="Admin.Integrations" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="IntegrationUpdated" source="Admin.Integrations" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</event>
		<event name="IntegrationCreated" source="Admin.Integrations" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</event>
		<event name="LogoLinkedToIntegration" source="Admin.Integrations" type="DomainEvent">
			<field name="logoPath" type="String"></field>
		</event>
		<event name="RequirementDeleted" source="Admin.Requirement" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="RequirementUpdated" source="Admin.Requirement" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="mandatory" type="Boolean"></field>
			<field name="summary" type="String"></field>
		</event>
		<event name="RequirementCreated" source="Admin.Requirement" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="mandatory" type="Boolean"></field>
			<field name="summary" type="String"></field>
		</event>
		<event name="IndustryDeleted" source="Admin.Industry" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="IndustryCreated" source="Admin.Industry" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</event>
		<event name="IndustryUpdated" source="Admin.Industry" type="DomainEvent">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</event>
		<event name="RegionUpdated" source="Admin.Region" type="DomainEvent">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="code" type="String"></field>
			<nested-object name="countries" business-key="code">
				<field name="code" type="String"></field>
				<field name="name" type="String"></field>
			</nested-object>
		</event>
		<event name="RegionDeleted" source="Admin.Region" type="DomainEvent">
			<field name="arn" type="String"></field>
		</event>
		<event name="FileUploaded" type="DomainEvent" source="appsync">
			<field name="bucket" type="String"></field>
			<field name="uri" type="String"></field>
			<field name="location" type="String"></field>
			<field name="username" type="String"></field>
		</event>
	</events>
	<domain>
		<subdomain name="Customer">
			<aggregate name="Control" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="controlTemplateArn" type="String"></field>
				<field name="assessmentPeriodicity" type="String"></field>
				<field name="lastAssessmentDate" type="String"></field>
				<field name="applicability" type="Boolean"></field>
				<field name="desiredMaturityLevel" type="Int"></field>
				<field name="businessUnit" type="String"></field>
				<field name="requirementArns" type="StringList"></field>
				<field name="companyArn" type="String"></field>
				<field name="arn" type="String"></field>
				<field name="nextAssessmentDate" type="String"></field>
				<field name="controlOwner" type="String"></field>
				<field name="hasPendingSelfAssessment" type="Boolean"></field>
				<command name="Delete">
					<trigger source="DeleteCompanyControlRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="ControlDeleted" id="T7MwvR">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteControl" trigger-event="DeleteCompanyControlRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="ControlDeleted" id="nJsfC6">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="CreateAssessment">
					<trigger source="StartCompanyControlAssessmentRequested" key-field="controlArn">
						<mapping target="arn" value="controlArn"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="category" value="category"></mapping>
						<mapping target="assessorLink" value="assessorLink"></mapping>
					</trigger>
					<processor type="code" id="gB9zmg" file="lib/AssessmentUtils.py" handler="prepare_assessment"></processor>
					<processor type="validator" id="QEJ9wT" condition="not flow.assessmentArn in flow.entity.assessment.keys()" exception="Assessment ARN is not unique"></processor>
					<processor type="emit-event" id="HvGE8N" ref="AssessmentStarted">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="hasPendingSelfAssessment" value="#flow.hasPendingSelfAssessment"></mapping>
						<mapping target="nextAssessmentDate" value="#flow.nextAssessmentDate"></mapping>
						<mapping target="assessment" value="#flow.assessment"></mapping>
					</processor>
					<test-case name="StartSelfAssessment" trigger-event="StartCompanyControlAssesmentRequested" expected-processing-status="success">
						<input name="controlArn" value="anove:company:draftsman:control:test" type="String"></input>
						<input name="dueDate" value="" type="String"></input>
						<input name="category" value="" type="String"></input>
						<input name="assessorLink" value="" type="String"></input>
						<state>{
  "arn": "anove:company:draftsman:control:test",
  "nextAssessmentDate": "2024-08-01",
  "controlOwner": "anove:company:draftsman:employee:j.doe"
}</state>
						<expected domain-event="AssessmentStarted" id="ZwikpJ">
							<field value="anove:company:draftsman:control:test" name="arn" type="String"></field>
							<field value="true" name="hasPendingSelfAssessment" type="Boolean"></field>
						</expected>
						<expected-state pk="anove:company:draftsman:control:test">{
  "hasPendingSelfAssessment": true,
  "assessment": {
    "anove:company:draftsman:control:test:2024-08-01": {
      "dueDate": "2024-08-01",
      "category": "self",
      "arn": "anove:company:draftsman:control:test:2024-08-01",
      "assessorLink": "anove:company:draftsman:employee:j.doe"
    }
  }
}</expected-state>
					</test-case>
				</command>
				<command name="CompleteAssessment">
					<trigger source="CompleteCompanyControlAssessmentRequested" key-field="#global.truncateArn(arn, '5')">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="validator" id="41JAYb" condition="flow.arn in flow.entity.assessment.keys()" exception="Not a valid assessment"></processor>
					<processor type="set-variable" id="zOMdrI" name="assessment" expression="flow.entity.assessment[flow.arn]"></processor>
					<processor type="validator" id="oF83OO" condition='flow.assessment["assessorLink"].endswith(flow.requestor)' exception="The requestor [{flow.requestor}] is not the owner [{flow.assessment['assessorLink']}]'"></processor>
					<processor type="validator" id="H8OaWG" condition="'dueDate' in flow.assessment and flow.assessment['dueDate'] != ''" exception="dueDate is not set"></processor>
					<processor type="validator" id="ryn8XK" condition="'assessedMaturityLevel' in flow.assessment and flow.assessment['assessedMaturityLevel'] != ''" exception="assessedMaturityLevel is not set"></processor>
					<processor type="validator" id="qtF9o2" condition="'assessedMaturityDescription' in flow.assessment and flow.assessment['assessedMaturityDescription'] != ''" exception="assessedMaturityDescription is not set"></processor>
					<processor type="validator" id="ueITsI" condition="'linkToEvidence' in flow.assessment and flow.assessment['linkToEvidence'] != ''" exception="linkToEvidence is not set"></processor>
					<processor type="code" id="BPwzIV" file="lib/AssessmentUtils.py" handler="prepare_completion"></processor>
					<processor type="emit-event" id="PFjOdc" ref="AssessmentCompleted">
						<mapping target="lastAssessmentDate" value="#flow.lastAssessmentDate"></mapping>
						<mapping target="nextAssessmentDate" value="#flow.nextAssessmentDate"></mapping>
						<mapping target="hasPendingSelfAssessment" value="#flow.hasPendingSelfAssessment"></mapping>
						<mapping target="assessment" value="#flow.assessment"></mapping>
					</processor>
					<test-case name="CompleteAssessment" trigger-event="CompleteCompanyControlAssessmentRequested" expected-processing-status="success">
						<input name="arn" value="anove:company:draftsman:control:test:2024-08-01" type="String"></input>
						<expected domain-event="AssessmentCompleted" id="EDwjCK">
							<field value="2025-08-01" name="nextAssessmentDate" type="String"></field>
							<field value="false" name="hasPendingSelfAssessment" type="Boolean"></field>
						</expected>
						<state>{
  "nextAssessmentDate": "2024-08-01",
  "assessmentPeriodicity": "1Y",
  "hasPendingSelfAssessment": true,
  "assessment": {
    "anove:company:draftsman:control:test:2024-08-01": {
      "dueDate": "2024-08-01",
      "notes": "--",
      "arn": "anove:company:draftsman:control:test:2024-08-01",
      "assessedMaturityLevel": "3",
      "assessedMaturityDescription": "--",
      "linkToEvidence": "--",
      "category": "self",
      "assessorLink": "anove:company:draftsman:employee:default-test-user"
    }
  },
  "arn": "anove:company:draftsman:control:test"
}</state>
						<expected-state pk="anove:company:draftsman:control:test">{
  "hasPendingSelfAssessment": false,
  "arn": "anove:company:draftsman:control:test"
}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateCompanyControlRequested" key-field="arn">
						<mapping target="description" value="description"></mapping>
						<mapping target="controlTemplateArn" value="controlTemplateArn"></mapping>
						<mapping target="assessmentPeriodicity" value="assessmentPeriodicity"></mapping>
						<mapping target="desiredMaturityLevel" value="desiredMaturityLevel"></mapping>
						<mapping target="businessUnit" value="businessUnit"></mapping>
						<mapping target="requirementArns" value="requirements"></mapping>
						<mapping target="nextAssessmentDate" value="nextAssessmentDate"></mapping>
						<mapping target="controlOwner" value="controlOwner"></mapping>
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="validator" id="K6SoMJ" condition="flow.entity.version != 0" exception="May not be initial request"></processor>
					<processor type="code" id="0yyCqe" file="lib/AssessmentUtils.py" handler="prepare_control_update"></processor>
					<processor type="emit-event" id="o35kOb" ref="ControlUpdated">
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="controlTemplateArn" value="#flow.controlTemplateArn"></mapping>
						<mapping target="assessmentPeriodicity" value="#flow.assessmentPeriodicity"></mapping>
						<mapping target="desiredMaturityLevel" value="#flow.desiredMaturityLevel"></mapping>
						<mapping target="businessUnit" value="#flow.businessUnit"></mapping>
						<mapping target="nextAssessmentDate" value="#flow.nextAssessmentDate"></mapping>
						<mapping target="controlOwner" value="#flow.controlOwner"></mapping>
					</processor>
					<processor type="emit-event" id="EiVB1g" ref="LinkedRequirements">
						<mapping target="requirements" value="#flow.requirementArns"></mapping>
					</processor>
					<test-case name="UpdateControl" trigger-event="UpdateCompanyControlRequested">
						<input name="description" value="description" type="String"></input>
						<input name="controlTemplateArn" value="controlTemplateArn" type="String"></input>
						<input name="assessmentPeriodicity" value="assessmentPeriodicity" type="String"></input>
						<input name="desiredMaturityLevel" value="3" type="Int"></input>
						<input name="businessUnit" value="businessUnit" type="String"></input>
						<input name="requirements" value="requirementArns" type="String"></input>
						<input name="nextAssessmentDate" value="nextAssessmentDate" type="String"></input>
						<input name="controlOwner" value="controlOwner" type="String"></input>
						<input name="arn" value="arn" type="String"></input>
						<state>{"version": 1}</state>
						<expected domain-event="ControlUpdated">
							<field value="description" name="description" type="String"></field>
							<field value="controlTemplateArn" name="controlTemplateArn" type="String"></field>
							<field value="assessmentPeriodicity" name="assessmentPeriodicity" type="String"></field>
							<field value="3" name="desiredMaturityLevel" type="Int"></field>
							<field value="businessUnit" name="businessUnit" type="String"></field>
							<field value="nextAssessmentDate" name="nextAssessmentDate" type="String"></field>
							<field value="controlOwner" name="controlOwner" type="String"></field>
						</expected>
						<expected domain-event="LinkedRequirements">
							<field value="requirementArns" name="requirements" type="String"></field>
						</expected>
						<expected-state pk="arn">{
  "description": "description",
  "controlTemplateArn": "controlTemplateArn",
  "assessmentPeriodicity": "assessmentPeriodicity",
  "desiredMaturityLevel": 3,
  "businessUnit": "businessUnit",
  "requirementArns": ["requirementArns"],
  "nextAssessmentDate": "nextAssessmentDate",
  "controlOwner": "controlOwner"
}</expected-state>
					</test-case>
				</command>
				<command name="UpdateAssessment">
					<trigger source="UpdateCompanyControlAssessmentRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="assessment" value="assessment"></mapping>
					</trigger>
					<processor type="validator" id="Yzw4Ax" condition="len(flow.assessment) == 1" exception="Request must contain exactly one assessment to be updated"></processor>
					<processor type="set-variable" id="qGJxgG" name="assessmentArn" expression="flow.assessment[0]['arn']"></processor>
					<processor type="validator" id="0ef5HL" condition="flow.assessmentArn in flow.entity.assessment.keys()" exception="Invalid assessment"></processor>
					<processor type="emit-event" id="BboTBH" ref="AssessmentUpdated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="assessment" value="#flow.assessment"></mapping>
					</processor>
					<test-case name="UpdateAssessment" trigger-event="UpdateCompanyControlAssessmentRequested">
						<input name="arn" value="anove:company:draftsman:control:test" type="String"></input>
						<input name="assessment" type="NestedObject">[
  {
    "dueDate": "2024-08-01",
    "notes": "Hello World!",
    "arn": "anove:company:draftsman:control:test:2024-08-01",
    "assessedMaturityLevel": "2",
    "assessedMaturityDescription": "--",
    "linkToEvidence": "--",
    "assessorLink": "anove:company:draftsman:employee:j.doe"
  }
]</input>
						<state>{
  "assessment": {
    "anove:company:draftsman:control:test:2024-08-01": {
      "assessorLink": "anove:company:draftsman:employee:default-test-user"
    }
  }
}</state>
						<expected domain-event="AssessmentUpdated">
							<field value="anove:company:draftsman:control:test" name="arn" type="String"></field>
						</expected>
						<expected-state pk="anove:company:draftsman:control:test">{
  "assessment": {
    "anove:company:draftsman:control:test:2024-08-01": {
        "dueDate": "2024-08-01",
        "notes": "Hello World!",
        "arn": "anove:company:draftsman:control:test:2024-08-01",
        "assessedMaturityLevel": "2",
        "assessedMaturityDescription": "--",
        "linkToEvidence": "--",
        "assessorLink": "anove:company:draftsman:employee:j.doe"
      }
  }
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="CreateCompanyControlRequested" key-field="#event.companyArn + ':control:' + &quot;&quot;.join(filter(str.isalnum, #event.name.lower()))">
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="controlTemplateArn" value="controlTemplateArn"></mapping>
						<mapping target="assessmentPeriodicity" value="assessmentPeriodicity"></mapping>
						<mapping target="desiredMaturityLevel" value="desiredMaturityLevel"></mapping>
						<mapping target="businessUnit" value="businessUnit"></mapping>
						<mapping target="companyArn" value="companyArn"></mapping>
						<mapping target="requirements" value="requirements"></mapping>
						<mapping target="nextAssessmentDate" value="nextAssessmentDate"></mapping>
						<mapping target="controlOwner" value="controlOwner"></mapping>
					</trigger>
					<processor type="validator" id="jQLLrp" condition="not flow.identity.endswith(':')" exception="Invalid name"></processor>
					<processor type="code" id="atEF4m" file="" handler="" code='flow.arn = flow.identity|LB|flow.lastAssessmentDate = "1970-01-01"|LB|flow.applicability = True'></processor>
					<processor type="emit-event" id="C8jHy9" ref="ControlCreated">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="controlTemplateArn" value="#flow.controlTemplateArn"></mapping>
						<mapping target="assessmentPeriodicity" value="#flow.assessmentPeriodicity"></mapping>
						<mapping target="lastAssessmentDate" value="#flow.lastAssessmentDate"></mapping>
						<mapping target="applicability" value="#flow.applicability"></mapping>
						<mapping target="desiredMaturityLevel" value="#flow.desiredMaturityLevel"></mapping>
						<mapping target="businessUnit" value="#flow.businessUnit"></mapping>
						<mapping target="companyArn" value="#flow.companyArn"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="nextAssessmentDate" value="#flow.nextAssessmentDate"></mapping>
						<mapping target="controlOwner" value="#flow.controlOwner"></mapping>
					</processor>
					<processor type="emit-event" id="3ywvp5" ref="LinkedRequirements">
						<mapping target="requirements" value="#flow.requirements"></mapping>
					</processor>
					<test-case name="CreateControl" trigger-event="CreateCompanyControlRequested" expected-processing-status="success">
						<input name="name" value="My Control" type="String"></input>
						<input name="description" value="Hello World!" type="String"></input>
						<input name="controlTemplateArn" value="" type="String"></input>
						<input name="assessmentPeriodicity" value="1M" type="String"></input>
						<input name="desiredMaturityLevel" value="4" type="Int"></input>
						<input name="businessUnit" value="Engineering" type="String"></input>
						<input name="companyArn" value="company:draftsman" type="String"></input>
						<input name="requirements" value="req1;req2" type="String"></input>
						<input name="nextAssessmentDate" value="2024-08-01" type="String"></input>
						<input name="controlOwner" value="company:draftsman:eployee:j.doe" type="String"></input>
						<expected domain-event="ControlCreated">
							<field value="My Control" name="name" type="String"></field>
							<field value="Hello World!" name="description" type="String"></field>
							<field value="" name="controlTemplateArn" type="String"></field>
							<field value="1M" name="assessmentPeriodicity" type="String"></field>
							<field value="1970-01-01" name="lastAssessmentDate" type="String"></field>
							<field value="true" name="applicability" type="Boolean"></field>
							<field value="4" name="desiredMaturityLevel" type="Int"></field>
							<field value="Engineering" name="businessUnit" type="String"></field>
							<field value="company:draftsman" name="companyArn" type="String"></field>
							<field value="company:draftsman:control:mycontrol" name="arn" type="String"></field>
							<field value="2024-08-01" name="nextAssessmentDate" type="String"></field>
							<field value="company:draftsman:eployee:j.doe" name="controlOwner" type="String"></field>
						</expected>
						<expected domain-event="LinkedRequirements">
							<field value="req1;req2" name="requirements" type="String"></field>
						</expected>
						<expected-state pk="company:draftsman:control:mycontrol">{
  "name": "My Control",
  "description": "Hello World!",
  "controlTemplateArn": "",
  "assessmentPeriodicity": "1M",
  "lastAssessmentDate": "1970-01-01",
  "applicability": true,
  "desiredMaturityLevel": 4,
  "businessUnit": "Engineering",
  "requirementArns": ["req1","req2"],
  "companyArn": "company:draftsman",
  "arn": "company:draftsman:control:mycontrol",
  "nextAssessmentDate": "2024-08-01",
  "controlOwner": "company:draftsman:eployee:j.doe"
}</expected-state>
						<state>{}</state>
					</test-case>
				</command>
				<event-handler on="AssessmentUpdated">
					<nested-mapping source="assessment" target="assessment" business-key="arn">
						<mapping target="dueDate" operand="set" value="dueDate"></mapping>
						<mapping target="notes" operand="set" value="notes"></mapping>
						<mapping target="arn" operand="set" value="arn"></mapping>
						<mapping target="assessedMaturityLevel" operand="set" value="assessedMaturityLevel"></mapping>
						<mapping target="assessedMaturityDescription" operand="set" value="assessedMaturityDescription"></mapping>
						<mapping target="linkToEvidence" operand="set" value="linkToEvidence"></mapping>
						<mapping target="assessorLink" operand="set" value="assessorLink"></mapping>
					</nested-mapping>
				</event-handler>
				<event-handler on="AssessmentCompleted">
					<mapping target="lastAssessmentDate" operand="set" value="lastAssessmentDate"></mapping>
					<mapping target="nextAssessmentDate" operand="set" value="nextAssessmentDate"></mapping>
					<mapping target="hasPendingSelfAssessment" operand="set" value="hasPendingSelfAssessment"></mapping>
					<nested-mapping source="assessment" target="assessment" business-key="arn">
						<mapping target="completeDate" operand="set" value="completeDate"></mapping>
					</nested-mapping>
				</event-handler>
				<event-handler on="ControlUpdated">
					<mapping target="description" operand="set" value="description"></mapping>
					<mapping target="controlTemplateArn" operand="set" value="controlTemplateArn"></mapping>
					<mapping target="assessmentPeriodicity" operand="set" value="assessmentPeriodicity"></mapping>
					<mapping target="desiredMaturityLevel" operand="set" value="desiredMaturityLevel"></mapping>
					<mapping target="businessUnit" operand="set" value="businessUnit"></mapping>
					<mapping target="nextAssessmentDate" operand="set" value="nextAssessmentDate"></mapping>
					<mapping target="controlOwner" operand="set" value="controlOwner"></mapping>
				</event-handler>
				<event-handler on="LinkedRequirements" code='self.requirementArns = list(dict.fromkeys(event.requirements.split(";")))'></event-handler>
				<event-handler on="AssessmentStarted">
					<nested-mapping source="assessment" target="assessment" business-key="arn">
						<mapping target="dueDate" operand="set" value="dueDate"></mapping>
						<mapping target="category" operand="set" value="category"></mapping>
						<mapping target="arn" operand="set" value="arn"></mapping>
						<mapping target="assessorLink" operand="set" value="assessorLink"></mapping>
					</nested-mapping>
					<mapping target="hasPendingSelfAssessment" operand="set" value="hasPendingSelfAssessment"></mapping>
					<mapping target="nextAssessmentDate" operand="set" value="nextAssessmentDate"></mapping>
				</event-handler>
				<event-handler on="ControlDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="ControlCreated">
					<mapping target="name" operand="set" value="name"></mapping>
					<mapping target="description" operand="set" value="description"></mapping>
					<mapping target="controlTemplateArn" operand="set" value="controlTemplateArn"></mapping>
					<mapping target="assessmentPeriodicity" operand="set" value="assessmentPeriodicity"></mapping>
					<mapping target="lastAssessmentDate" operand="set" value="lastAssessmentDate"></mapping>
					<mapping target="applicability" operand="set" value="applicability"></mapping>
					<mapping target="desiredMaturityLevel" operand="set" value="desiredMaturityLevel"></mapping>
					<mapping target="companyArn" operand="set" value="companyArn"></mapping>
					<mapping target="arn" operand="set" value="arn"></mapping>
					<mapping target="businessUnit" operand="set" value="businessUnit"></mapping>
					<mapping target="nextAssessmentDate" operand="set" value="nextAssessmentDate"></mapping>
					<mapping target="controlOwner" operand="set" value="controlOwner"></mapping>
				</event-handler>
				<nested-object name="assessment" business-key="arn">
					<field name="dueDate" type="String"></field>
					<field name="notes" type="String"></field>
					<field name="completeDate" type="String"></field>
					<field name="category" type="String"></field>
					<field name="arn" type="String"></field>
					<field name="assessedMaturityLevel" type="String"></field>
					<field name="assessedMaturityDescription" type="String"></field>
					<field name="linkToEvidence" type="String"></field>
					<field name="assessorLink" type="String" default=""></field>
				</nested-object>
			</aggregate>
			<aggregate name="IntegrationImplementation" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="status" type="String"></field>
				<field name="requirements" type="String"></field>
				<field name="reference" type="String"></field>
				<field name="owner" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteCompanyIntegrationImplementationRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" id="YSMjrB" ref="IntegrationImplementationDeleted">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="Delete" trigger-event="DeleteCompanyIntegrationImplementationRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="IntegrationImplementationDeleted" id="PTb3jx">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy",
  "isDeleted": ""
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "isDeleted": "soft"
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true" reactivate-command="false">
					<trigger source="RequestCompanyIntegrationImplementationRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="requirements" value="requirements"></mapping>
						<mapping target="reference" value="reference"></mapping>
						<mapping target="owner" value="owner"></mapping>
					</trigger>
					<test-case name="Create" trigger-event="RequestCompanyIntegrationImplementationRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="requirements" type="String" value="requirements"></input>
						<input name="reference" type="String" value="test"></input>
						<input name="owner" type="String" value="user"></input>
						<expected domain-event="IntegrationImplementationCreated" id="9CpR3m">
							<field name="arn" type="String" value="dummy"></field>
							<field name="status" type="String" value="requested"></field>
							<field name="requirements" type="String" value="requirements"></field>
							<field name="reference" type="String" value="test"></field>
							<field name="owner" type="String" value="user"></field>
						</expected>
						<state>{}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "status": "requested",
  "requirements": "requirements",
  "reference": "test",
  "owner": "user"
}</expected-state>
					</test-case>
					<processor type="emit-event" id="xPAqmW" ref="IntegrationImplementationCreated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="status" value="#'requested'"></mapping>
						<mapping target="requirements" value="#flow.requirements"></mapping>
						<mapping target="reference" value="#flow.reference"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
					</processor>
				</command>
				<command name="AddNote">
					<trigger source="AddNoteCompanyIntegrationImplementationRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="uuid" value="uuid"></mapping>
						<mapping target="message" value="message"></mapping>
						<mapping target="user" value="user"></mapping>
						<mapping target="status" value="#''"></mapping>
					</trigger>
					<trigger source="ChangeStatusCompanyIntegrationImplementationRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="uuid" value="uuid"></mapping>
						<mapping target="message" value="message"></mapping>
						<mapping target="user" value="user"></mapping>
						<mapping target="status" value="status"></mapping>
					</trigger>
					<processor type="emit-event" ref="IntegrationImplementationNoteAdded" id="77IRRa">
						<mapping target="uuid" value="#flow.uuid"></mapping>
						<mapping target="message" value="#flow.message"></mapping>
						<mapping target="user" value="#flow.user"></mapping>
						<mapping target="status" value="#flow.status"></mapping>
					</processor>
					<test-case name="AddNote" trigger-event="AddNoteCompanyIntegrationImplementationRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="uuid" type="String" value="123456"></input>
						<input name="message" type="String" value="Hello World!"></input>
						<input name="user" type="String" value="j.doe"></input>
						<expected domain-event="IntegrationImplementationNoteAdded" id="FRs5Aq">
							<field name="uuid" type="String" value="123456"></field>
							<field name="message" type="String" value="Hello World!"></field>
							<field name="user" type="String" value="j.doe"></field>
							<field name="status" type="String" value=""></field>
						</expected>
						<state>{
  "version": 1,
  "status": "requested",
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","note":{"123456":{"uuid":"123456","message":"Hello World!","user":"j.doe","order":1}},"status":"requested"}</expected-state>
					</test-case>
					<test-case name="ChangeStatus" trigger-event="ChangeStatusCompanyIntegrationImplementationRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="uuid" type="String" value="123456"></input>
						<input name="message" type="String" value="Accept the request"></input>
						<input name="user" type="String" value="j.doe"></input>
						<input name="status" type="String" value="accepted"></input>
						<state>{
  "arn": "dummy",
  "status": "requested",
  "version": 1
}</state>
						<expected domain-event="IntegrationImplementationNoteAdded" id="r9uM2K">
							<field name="uuid" type="String" value="123456"></field>
							<field name="message" type="String" value="Accept the request"></field>
							<field name="user" type="String" value="j.doe"></field>
							<field name="status" type="String" value="accepted"></field>
						</expected>
						<expected-state pk="dummy">{"arn":"dummy","status":"accepted"}</expected-state>
					</test-case>
				</command>
				<event-handler on="IntegrationImplementationDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="IntegrationImplementationCreated">
					<mapping target="arn" value="arn" operand="set"></mapping>
					<mapping target="status" value="status" operand="set"></mapping>
					<mapping target="requirements" value="requirements" operand="set"></mapping>
					<mapping target="reference" value="reference" operand="set"></mapping>
					<mapping operand="set" target="owner" value="owner"></mapping>
				</event-handler>
				<event-handler on="IntegrationImplementationNoteAdded" code='target = retrieve_nested_target(event.uuid, self.note, {})|LB|target["uuid"] = event.uuid|LB|target["message"] = event.message|LB|target["user"] = event.user|LB|target["order"] = self.version|LB|self.note[event.uuid] = target|LB|if event.status:|LB|    self.status = event.status'></event-handler>
				<nested-object name="note" business-key="uuid">
					<field name="uuid" type="String"></field>
					<field name="message" type="String"></field>
					<field name="user" type="String"></field>
					<field name="order" type="Int"></field>
				</nested-object>
			</aggregate>
			<aggregate name="Objective" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="owner" type="String"></field>
				<field name="startDate" type="String"></field>
				<field name="dueDate" type="String"></field>
				<field name="definitionOfDone" type="String"></field>
				<field name="completionPercentage" type="Int"></field>
				<field name="name" type="String"></field>
				<command name="UpdateTask">
					<trigger source="UpdateCompanyObjectiveTaskRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assignee" value="assignee"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="notes" value="notes"></mapping>
					</trigger>
					<processor type="validator" condition="flow.arn in flow.entity.task" exception="Task with arn {flow.arn} not found in objective" id="EWw6f9"></processor>
					<processor type="emit-event" ref="ObjectiveTaskUpdated" id="SJsSSu">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assignee" value="#flow.assignee"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="notes" value="#flow.notes"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="UpdateTask" trigger-event="UpdateCompanyObjectiveTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
						<input name="name" type="String" value="Test"></input>
						<input name="description" type="String" value=""></input>
						<input name="assignee" type="String" value=""></input>
						<input name="dueDate" type="String" value=""></input>
						<input name="notes" type="String" value="Meanigfull notes"></input>
						<state>{
  "version": 1,
  "arn": "anove:company:gate:objective:myobjective",
  "task": {
    "anove:company:gate:objective:myobjective:mytask": {
      "arn": "anove:company:gate:objective:myobjective:mytask",
      "name": "My Task",
      "description": "Hello World",
      "assignee": "j.doe",
      "dueDate": "2024-08-01",
      "completeDate": "",
      "notes": "My Notes"
    }
  }
}</state>
						<expected domain-event="ObjectiveTaskUpdated" id="hfGbvE">
							<field name="name" type="String" value="Test"></field>
							<field name="description" type="String" value=""></field>
							<field name="assignee" type="String" value=""></field>
							<field name="dueDate" type="String" value=""></field>
							<field name="notes" type="String" value="Meanigfull notes"></field>
							<field name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></field>
						</expected>
						<expected-state pk="anove:company:gate:objective:myobjective">{
  "arn": "anove:company:gate:objective:myobjective",
  "task": {
    "anove:company:gate:objective:myobjective:mytask": {
      "arn": "anove:company:gate:objective:myobjective:mytask",
      "name": "Test",
      "description": "Hello World",
      "assignee": "j.doe",
      "dueDate": "2024-08-01",
      "completeDate": "",
      "notes": "Meanigfull notes"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="TaskDoesNotExist" trigger-event="UpdateCompanyObjectiveTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{}</state>
					</test-case>
				</command>
				<command name="CompleteTask">
					<trigger source="CompleteCompanyObjectiveTaskRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="username" value="username"></mapping>
					</trigger>
					<processor type="validator" id="krhc9a" condition="flow.arn in flow.entity.task" exception="Task with arn {flow.arn} not found in objective"></processor>
					<processor condition='flow.entity.task[flow.arn]["completeDate"] == ""' type="validator" id="lT1jW2" exception="Task already completed"></processor>
					<processor type="validator" condition='flow.entity.task[flow.arn]["assignee"].endswith(flow.username)' id="aCCQEu" exception="User {flow.username} is not the owner of this task"></processor>
					<processor type="code" code='from datetime import date|LB|flow.completeDate = date.today().strftime("%Y-%m-%d")' id="vyIgIF"></processor>
					<processor type="emit-event" id="7ylYYX" ref="ObjectiveTaskCompleted">
						<mapping target="completeDate" value="#flow.completeDate"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="CompleteTask" trigger-event="CompleteCompanyObjectiveTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
						<input name="username" type="String" value="j.doe"></input>
						<expected domain-event="ObjectiveTaskCompleted" id="dY6AAd">
							<field name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></field>
						</expected>
						<state>{
  "arn": "anove:company:gate:objective:myobjective",
  "task": {
    "anove:company:gate:objective:myobjective:mytask": {
      "arn": "anove:company:gate:objective:myobjective:mytask",
      "name": "text",
      "description": "text",
      "assignee": "j.doe",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</state>
						<expected-state pk="businessKey">{
  "arn": "businessKey"
}</expected-state>
					</test-case>
					<test-case name="TaskNotFound" trigger-event="CompleteCompanyObjectiveTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{}</state>
					</test-case>
					<test-case name="TaskAlreadyCompleted" trigger-event="CompleteCompanyObjectiveTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{
  "arn": "anove:company:gate:objective:myobjective",
  "task": {
    "anove:company:gate:objective:myobjective:mytask": {
      "arn": "anove:company:gate:objective:myobjective:mytask",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "2024-08-01",
      "notes": "text"
    }
  }
}</state>
					</test-case>
				</command>
				<command name="Delete">
					<trigger source="DeleteCompanyObjectiveRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" id="cnojgY" ref="ObjectiveDeleted">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteObjective" trigger-event="DeleteCompanyObjectiveRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="ObjectiveDeleted" id="M9c2uL">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateCompanyObjectiveRequested" key-field="arn">
						<mapping target="owner" value="owner"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="definitionOfDone" value="definitionOfDone"></mapping>
						<mapping target="completionPercentage" value="completionPercentage"></mapping>
						<mapping target="name" value="name"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="dZ7Tbj" exception="May not be the initial request"></processor>
					<processor type="validator" condition="flow.entity.completionPercentage != 100" exception="Objective is completed, no update allowed" id="M6xxoD"></processor>
					<processor condition="flow.completionPercentage &lt;= 100" type="validator" id="HMQDFP" exception="Completion percentage may not exceed 100%"></processor>
					<processor condition="flow.completionPercentage &gt;= 0" type="validator" id="o0ua0x" exception="Completion may not be negative"></processor>
					<processor type="emit-event" id="ipvpx5" ref="ObjectiveUpdated">
						<mapping target="owner" value="#flow.owner"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="definitionOfDone" value="#flow.definitionOfDone"></mapping>
						<mapping target="completionPercentage" value="#flow.completionPercentage"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
					</processor>
					<test-case name="UpdateObjective" trigger-event="UpdateCompanyObjectiveRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:objective:myobjective"></input>
						<input name="owner" type="String" value=""></input>
						<input name="name" type="String" value=""></input>
						<input name="dueDate" type="String" value="2024-11-01"></input>
						<input name="definitionOfDone" type="String" value=""></input>
						<input name="completionPercentage" type="Int" value="20"></input>
						<expected domain-event="ObjectiveUpdated" id="LUeP2c">
							<field name="owner" type="String" value=""></field>
							<field name="name" type="String" value=""></field>
							<field name="dueDate" type="String" value="2024-11-01"></field>
							<field name="definitionOfDone" type="String" value=""></field>
							<field name="completionPercentage" type="Int" value="20"></field>
						</expected>
						<state>{
  "arn": "anove:company:draftsman:objective:myobjective",
  "owner": "anove:company:draftsman:employee:j.doe",
  "startDate": "2024-08-01",
  "dueDate": "2024-10-01",
  "definitionOfDone": "Hello World!",
  "completionPercentage": 10,
  "version": 1
}</state>
						<expected-state pk="anove:company:draftsman:objective:myobjective">{
  "arn": "anove:company:draftsman:objective:myobjective",
  "owner": "anove:company:draftsman:employee:j.doe",
  "startDate": "2024-08-01",
  "dueDate": "2024-11-01",
  "definitionOfDone": "Hello World!",
  "completionPercentage": 20
}</expected-state>
					</test-case>
					<test-case name="InitialRequest" trigger-event="UpdateCompanyObjectiveRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:objective:myobjective"></input>
						<input name="owner" type="String" value=""></input>
						<input name="dueDate" type="String" value="2024-11-01"></input>
						<input name="definitionOfDone" type="String" value=""></input>
						<input name="completionPercentage" type="Int" value="20"></input>
						<input name="name" type="String" value=""></input>
						<state>{}</state>
					</test-case>
					<test-case name="AlreadyCompleted" trigger-event="UpdateCompanyObjectiveRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:objective:myobjective"></input>
						<input name="owner" type="String" value=""></input>
						<input name="dueDate" type="String" value="2024-11-01"></input>
						<input name="definitionOfDone" type="String" value=""></input>
						<input name="completionPercentage" type="Int" value="20"></input>
						<input name="name" type="String" value=""></input>
						<state>{
  "completionPercentage": 100,
  "version": 1
}</state>
					</test-case>
					<test-case name="PercentageToHigh" trigger-event="UpdateCompanyObjectiveRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:objective:myobjective"></input>
						<input name="owner" type="String" value=""></input>
						<input name="dueDate" type="String" value="2024-11-01"></input>
						<input name="definitionOfDone" type="String" value=""></input>
						<input name="completionPercentage" type="Int" value="101"></input>
						<input name="name" type="String" value=""></input>
						<state>{
  "version": 1
}</state>
					</test-case>
					<test-case name="NegativePercentage" trigger-event="UpdateCompanyObjectiveRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:objective:myobjective"></input>
						<input name="owner" type="String" value=""></input>
						<input name="dueDate" type="String" value="2024-11-01"></input>
						<input name="definitionOfDone" type="String" value=""></input>
						<input name="completionPercentage" type="Int" value="-1"></input>
						<input name="name" type="String" value=""></input>
						<state>{
  "version": 1
}</state>
					</test-case>
				</command>
				<command name="CreateTask">
					<trigger source="CreateCompanyObjectiveTaskRequested" key-field="#global.truncateArn(arn, '5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assignee" value="assignee"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="notes" value="notes"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" exception="Parent objective must exist" id="msajyO"></processor>
					<processor type="validator" condition="not flow.arn in flow.entity.task" exception="Task with arn {flow.arn} already exists" id="86rQbQ"></processor>
					<processor type="emit-event" ref="ObjectiveTaskCreated" id="DCiHuh">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assignee" value="#flow.assignee"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="notes" value="#flow.notes"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="CreateTask" trigger-event="CreateCompanyObjectiveTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
						<input name="name" type="String" value="My Task"></input>
						<input name="description" type="String" value="Hello World!"></input>
						<input name="assignee" type="String" value="anove:company:gate:employee:j.doe"></input>
						<input name="dueDate" type="String" value="2025-01-01"></input>
						<input name="notes" type="String" value="Some longer text"></input>
						<state>{
  "version": 1,
  "arn": "anove:company:gate:objective:myobjective"
}</state>
						<expected domain-event="ObjectiveTaskCreated" id="3NKC1D">
							<field name="name" type="String" value="My Task"></field>
							<field name="description" type="String" value="Hello World!"></field>
							<field name="assignee" type="String" value="anove:company:gate:employee:j.doe"></field>
							<field name="dueDate" type="String" value="2025-01-01"></field>
							<field name="notes" type="String" value="Some longer text"></field>
							<field name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></field>
						</expected>
						<expected-state pk="anove:company:gate:objective:myobjective">{
  "arn": "anove:company:gate:objective:myobjective",
  "task": {
    "anove:company:gate:objective:myobjective:mytask": {
      "arn": "anove:company:gate:objective:myobjective:mytask",
      "name": "My Task",
      "description": "Hello World!",
      "assignee": "anove:company:gate:employee:j.doe",
      "dueDate": "2025-01-01",
      "completeDate": "",
      "notes": "Some longer text"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="ParentDoesNotExist" trigger-event="CreateCompanyObjectiveTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
						<input name="name" type="String" value="My Task"></input>
						<input name="description" type="String" value="Hello World!"></input>
						<input name="assignee" type="String" value="anove:company:gate:employee:j.doe"></input>
						<input name="dueDate" type="String" value="2025-01-01"></input>
						<input name="notes" type="String" value="Some longer text"></input>
						<state>{}</state>
					</test-case>
					<test-case name="TaskWithArnAlreadyExist" trigger-event="CreateCompanyObjectiveTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
						<input name="name" type="String" value="My Task"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{
  "version": 1,
  "task": {
    "anove:company:gate:objective:myobjective:mytask": {
      "arn": "anove:company:gate:objective:myobjective:mytask",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "text",
      "notes": "text"
    }
  }
}</state>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="CreateCompanyObjectiveRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="owner" value="owner"></mapping>
						<mapping target="startDate" value="startDate"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="definitionOfDone" value="definitionOfDone"></mapping>
						<mapping target="name" value="name"></mapping>
					</trigger>
					<processor type="emit-event" ref="ObjectiveCreated" id="NOTKAp">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
						<mapping target="startDate" value="#flow.startDate"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="definitionOfDone" value="#flow.definitionOfDone"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
					</processor>
					<test-case name="CreateObjective" trigger-event="CreateCompanyObjectiveRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:tracepaper:objective:myobjective"></input>
						<input name="owner" type="String" value="anove:company:tracepaper:employee:j.doe"></input>
						<input name="startDate" type="String" value="2024-08-01"></input>
						<input name="dueDate" type="String" value="2025-08-01"></input>
						<input name="definitionOfDone" type="String" value="Hello World!"></input>
						<input name="name" type="String" value="My Objective"></input>
						<expected domain-event="ObjectiveCreated" id="EE13AU">
							<field name="arn" type="String" value="anove:company:tracepaper:objective:myobjective"></field>
							<field name="owner" type="String" value="anove:company:tracepaper:employee:j.doe"></field>
							<field name="startDate" type="String" value="2024-08-01"></field>
							<field name="dueDate" type="String" value="2025-08-01"></field>
							<field name="definitionOfDone" type="String" value="Hello World!"></field>
							<field name="name" type="String" value="My Objective"></field>
						</expected>
						<expected-state pk="anove:company:tracepaper:objective:myobjective">{
  "arn": "anove:company:tracepaper:objective:myobjective",
  "owner": "anove:company:tracepaper:employee:j.doe",
  "startDate": "2024-08-01",
      "name": "My Objective",
  "dueDate": "2025-08-01",
  "definitionOfDone": "Hello World!",
  "completionPercentage": 0,
  "version": 1
}</expected-state>
						<state>{}</state>
					</test-case>
				</command>
				<command name="Reopen">
					<trigger source="ReopenCompanyObjectiveRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.completionPercentage == 100" id="c5fdma" exception="Objective is already open for updates"></processor>
					<processor type="emit-event" id="agGboW" ref="ObjectiveReopened">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="ReopenObjective" trigger-event="ReopenCompanyObjectiveRequested" expected-processing-status="success">
						<input name="arn" type="String" value="myobjective"></input>
						<state>{
  "completionPercentage": 100,
  "arn": "myobjective"
}</state>
						<expected domain-event="ObjectiveReopened" id="W5S5zD">
							<field name="arn" type="String" value="myobjective"></field>
						</expected>
						<expected-state pk="myobjective">{
  "arn": "myobjective",
  "completionPercentage": 80
}</expected-state>
					</test-case>
				</command>
				<event-handler on="ObjectiveDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="ObjectiveReopened" code="self.completionPercentage = 80"></event-handler>
				<event-handler on="ObjectiveUpdated" code="|LB|if event.owner:|LB|    self.owner = event.owner|LB|if event.dueDate:|LB|    self.dueDate = event.dueDate|LB|if event.definitionOfDone:|LB|    self.definitionOfDone = event.definitionOfDone|LB|if event.completionPercentage:|LB|    self.completionPercentage = event.completionPercentage|LB|if event.name:|LB|    self.name = event.name"></event-handler>
				<event-handler on="ObjectiveTaskCreated" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|target["name"] = event.name|LB|target["description"] = event.description|LB|target["assignee"] = event.assignee|LB|target["dueDate"] = event.dueDate|LB|target["completeDate"] = ""|LB|target["notes"] = event.notes|LB|target["arn"] = event.arn|LB|target["createdAt"] = event.published_at|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="ObjectiveTaskCompleted" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|target["completeDate"] = event.completeDate|LB|target["completedAt"] = event.published_at|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="ObjectiveTaskUpdated" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|if event.name:|LB|    target["name"] = event.name|LB|if event.description:|LB|    target["description"] = event.description|LB|if event.assignee:|LB|    target["assignee"] = event.assignee|LB|if event.dueDate:|LB|    target["dueDate"] = event.dueDate|LB|if event.notes:|LB|    target["notes"] = event.notes|LB|target["updatedAt"] = event.published_at|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="ObjectiveCreated">
					<mapping target="arn" value="arn" operand="set"></mapping>
					<mapping target="owner" value="owner" operand="set"></mapping>
					<mapping target="startDate" value="startDate" operand="set"></mapping>
					<mapping target="dueDate" value="dueDate" operand="set"></mapping>
					<mapping target="definitionOfDone" value="definitionOfDone" operand="set"></mapping>
					<mapping target="name" value="name" operand="set"></mapping>
				</event-handler>
				<nested-object name="task" business-key="arn">
					<field name="name" type="String"></field>
					<field name="description" type="String"></field>
					<field name="assignee" type="String"></field>
					<field name="dueDate" type="String"></field>
					<field name="completeDate" type="String"></field>
					<field name="notes" type="String"></field>
					<field name="arn" type="String"></field>
					<field name="createdAt" type="Int"></field>
					<field name="updatedAt" type="Int"></field>
					<field name="completedAt" type="Int"></field>
				</nested-object>
			</aggregate>
			<aggregate name="Asset" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="owner" type="String"></field>
				<field name="confidentiality" type="String"></field>
				<field name="integrity" type="String"></field>
				<field name="availability" type="String"></field>
				<field name="privacy" type="String"></field>
				<command name="UpdateTask">
					<trigger source="UpdateCompanyAssetTaskRequested" key-field="#global.truncateArn(arn, '5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assignee" value="assignee"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="notes" value="notes"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="3gJkMr" exception="Asset does not exist"></processor>
					<processor condition="flow.arn in flow.entity.task" type="validator" id="V529Pn" exception="Task with arn {flow.arn} not found in asset"></processor>
					<processor type="validator" id="bSkipW" condition='"completeDate" not in flow.entity.task[flow.arn] or flow.entity.task[flow.arn]["completeDate"] == ""' exception="Task already completed"></processor>
					<processor type="emit-event" ref="AssetTaskUpdated" id="uEv0av">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assignee" value="#flow.assignee"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="notes" value="#flow.notes"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="UpdateTask" trigger-event="UpdateCompanyAssetTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:task"></input>
						<input name="name" type="String" value="Hello World!"></input>
						<input name="description" type="String" value=""></input>
						<input name="assignee" type="String" value=""></input>
						<input name="dueDate" type="String" value=""></input>
						<input name="notes" type="String" value=""></input>
						<expected domain-event="AssetTaskUpdated" id="fOxTgq">
							<field name="name" type="String" value="Hello World!"></field>
							<field name="description" type="String" value=""></field>
							<field name="assignee" type="String" value=""></field>
							<field name="dueDate" type="String" value=""></field>
							<field name="notes" type="String" value=""></field>
							<field name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:task"></field>
						</expected>
						<state>{
  "arn": "anove:company:draftsman:asset:tracepaper",
  "version": 1,
  "task": {
    "anove:company:draftsman:asset:tracepaper:task": {
      "arn": "anove:company:draftsman:asset:tracepaper:task",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</state>
						<expected-state pk="anove:company:draftsman:asset:tracepaper">{
  "arn": "anove:company:draftsman:asset:tracepaper",
  "task": {
    "anove:company:draftsman:asset:tracepaper:task": {
      "arn": "anove:company:draftsman:asset:tracepaper:task",
      "name": "Hello World!",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="AssetDoesNotExist" trigger-event="UpdateCompanyAssetTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:task"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{}</state>
					</test-case>
					<test-case name="TaskDoesNotExist" trigger-event="UpdateCompanyAssetTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:task"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{
  "arn": "anove:company:draftsman:asset:tracepaper",
  "version": 1
}</state>
					</test-case>
				</command>
				<command name="CompleteTask">
					<trigger source="CompleteCompanyAssetTaskRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="username" value="username"></mapping>
					</trigger>
					<processor type="validator" id="krhc9a" condition="flow.arn in flow.entity.task" exception="Task with arn {flow.arn} not found in asset"></processor>
					<processor condition='flow.entity.task[flow.arn]["completeDate"] == ""' type="validator" id="lT1jW2" exception="Task already completed"></processor>
					<processor type="validator" condition='flow.entity.task[flow.arn]["assignee"].endswith(flow.username)' id="aCCQEu" exception="User {flow.username} is not the owner of this task"></processor>
					<processor type="code" code='from datetime import date|LB|flow.completeDate = date.today().strftime("%Y-%m-%d")' id="vyIgIF"></processor>
					<processor type="emit-event" ref="AssetTaskCompleted" id="VdoU61">
						<mapping target="completeDate" value="#flow.completeDate"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="CompleteTask" trigger-event="CompleteCompanyAssetTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:task"></input>
						<input name="username" type="String" value="j.doe"></input>
						<expected domain-event="AssetTaskCompleted" id="GhkiEH">
							<field name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:task"></field>
						</expected>
						<state>{
  "arn": "anove:company:draftsman:asset:tracepaper",
  "task": {
    "anove:company:draftsman:asset:tracepaper:task": {
      "arn": "anove:company:draftsman:asset:tracepaper:task",
      "name": "text",
      "description": "text",
      "assignee": "anove:company:draftsman:employee:j.doe",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</state>
						<expected-state pk="businessKey">{
  "arn": "businessKey"
}</expected-state>
					</test-case>
					<test-case name="TaskDoesNotExist" trigger-event="CompleteCompanyAssetTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:task"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{}</state>
					</test-case>
					<test-case name="AlreadyCompleted" trigger-event="CompleteCompanyAssetTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:task"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{
  "task": {
    "anove:company:draftsman:asset:tracepaper:task": {
      "arn": "anove:company:draftsman:asset:tracepaper:task",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "text",
      "notes": "text"
    }
  }
}</state>
					</test-case>
					<test-case name="NotTaskOwner" trigger-event="CompleteCompanyAssetTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="text"></input>
						<input name="username" type="String" value="text"></input>
						<state>{
  "task": {
    "anove:company:draftsman:asset:tracepaper:task": {
      "arn": "anove:company:draftsman:asset:tracepaper:task",
      "name": "text",
      "description": "text",
      "assignee": "anove:company:draftsman:employee:john",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</state>
					</test-case>
				</command>
				<command name="Delete">
					<trigger source="DeleteCompanyAssetRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="AssetDeleted" id="wcK2Pp">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteAsset" trigger-event="DeleteCompanyAssetRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="AssetDeleted" id="ZYEzzx">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateCompanyAssetRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="owner" value="owner"></mapping>
						<mapping target="confidentiality" value="confidentiality"></mapping>
						<mapping target="integrity" value="integrity"></mapping>
						<mapping target="availability" value="availability"></mapping>
						<mapping target="privacy" value="privacy"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" exception="Asset does not exist" id="mBgF7r"></processor>
					<processor type="emit-event" ref="AssetUpdated" id="Z89MVz">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
						<mapping target="confidentiality" value="#flow.confidentiality"></mapping>
						<mapping target="integrity" value="#flow.integrity"></mapping>
						<mapping target="availability" value="#flow.availability"></mapping>
						<mapping target="privacy" value="#flow.privacy"></mapping>
					</processor>
					<test-case name="UpdateAsset" trigger-event="UpdateCompanyAssetRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="Hello World!"></input>
						<input name="description" type="String" value=""></input>
						<input name="owner" type="String" value=""></input>
						<input name="confidentiality" type="String" value=""></input>
						<input name="integrity" type="String" value=""></input>
						<input name="availability" type="String" value=""></input>
						<input name="privacy" type="String" value=""></input>
						<expected domain-event="AssetUpdated" id="VUqh7b">
							<field name="arn" type="String" value="dummy"></field>
							<field name="name" type="String" value="Hello World!"></field>
						</expected>
						<state>{
  "arn": "dummy",
  "version": 1
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "name": "Hello World!"
}</expected-state>
					</test-case>
					<test-case name="UpdateUnknownAsset" trigger-event="UpdateCompanyAssetRequested" expected-processing-status="error">
						<input name="arn" type="String" value="text"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="owner" type="String" value="text"></input>
						<input name="confidentiality" type="String" value="text"></input>
						<input name="integrity" type="String" value="text"></input>
						<input name="availability" type="String" value="text"></input>
						<input name="privacy" type="String" value="text"></input>
						<state>{}</state>
					</test-case>
				</command>
				<command name="CreateTask">
					<trigger source="CreateCompanyAssetTaskRequested" key-field="#global.truncateArn(arn, '5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assignee" value="assignee"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="notes" value="notes"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" exception="Asset does not exist" id="RURggY"></processor>
					<processor type="validator" condition="not flow.arn in flow.entity.task" exception="Task with {flow.arn} already exists" id="ZYyThj"></processor>
					<processor type="emit-event" ref="AssetTaskCreated" id="mYSpLH">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assignee" value="#flow.assignee"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="notes" value="#flow.notes"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="CreateTask" trigger-event="CreateCompanyAssetTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:mytask"></input>
						<input name="name" type="String" value="Hello World!"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<expected domain-event="AssetTaskCreated" id="nzOkhK">
							<field name="name" type="String" value="Hello World!"></field>
							<field name="description" type="String" value="text"></field>
							<field name="assignee" type="String" value="text"></field>
							<field name="dueDate" type="String" value="text"></field>
							<field name="notes" type="String" value="text"></field>
							<field name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:mytask"></field>
						</expected>
						<state>{
  "arn": "anove:company:draftsman:asset:tracepaper",
  "version": 1
}</state>
						<expected-state pk="anove:company:draftsman:asset:tracepaper">{
  "arn": "anove:company:draftsman:asset:tracepaper",
  "task": {
    "anove:company:draftsman:asset:tracepaper:mytask": {
      "arn": "anove:company:draftsman:asset:tracepaper:mytask",
      "name": "Hello World!",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="AssetDoesNotExist" trigger-event="CreateCompanyAssetTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:mytask"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{}</state>
					</test-case>
					<test-case name="TaskAlreadyExist" trigger-event="CreateCompanyAssetTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper:mytask"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{
  "version": 1,
  "task": {
    "anove:company:draftsman:asset:tracepaper:mytask": {
      "arn": "anove:company:draftsman:asset:tracepaper:mytask",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "text",
      "notes": "text"
    }
  }
}</state>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="CreateCompanyAssetRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="owner" value="owner"></mapping>
						<mapping target="confidentiality" value="confidentiality"></mapping>
						<mapping target="integrity" value="integrity"></mapping>
						<mapping target="availability" value="availability"></mapping>
						<mapping target="privacy" value="privacy"></mapping>
					</trigger>
					<processor type="emit-event" id="knBWJ2" ref="AssetCreated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
						<mapping target="confidentiality" value="#flow.confidentiality"></mapping>
						<mapping target="integrity" value="#flow.integrity"></mapping>
						<mapping target="availability" value="#flow.availability"></mapping>
						<mapping target="privacy" value="#flow.privacy"></mapping>
					</processor>
					<test-case name="CreateAsset" trigger-event="CreateCompanyAssetRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:asset:tracepaper"></input>
						<input name="name" type="String" value="Tracepaper"></input>
						<input name="description" type="String" value="SaaS"></input>
						<input name="owner" type="String" value="anove:company:draftsman:employee:j.doe"></input>
						<input name="confidentiality" type="String" value="1"></input>
						<input name="integrity" type="String" value="2"></input>
						<input name="availability" type="String" value="3"></input>
						<input name="privacy" type="String" value="1"></input>
						<state>{}</state>
						<expected domain-event="AssetCreated" id="JAfqp1">
							<field name="arn" type="String" value="anove:company:draftsman:asset:tracepaper"></field>
							<field name="name" type="String" value="Tracepaper"></field>
							<field name="description" type="String" value="SaaS"></field>
							<field name="owner" type="String" value="anove:company:draftsman:employee:j.doe"></field>
							<field name="confidentiality" type="String" value="1"></field>
							<field name="integrity" type="String" value="2"></field>
							<field name="availability" type="String" value="3"></field>
							<field name="privacy" type="String" value="1"></field>
						</expected>
						<expected-state pk="anove:company:draftsman:asset:tracepaper">{
  "arn": "anove:company:draftsman:asset:tracepaper",
  "name": "Tracepaper",
  "description": "SaaS",
  "owner": "anove:company:draftsman:employee:j.doe",
  "confidentiality": "1",
  "integrity": "2",
  "availability": "3",
  "privacy": "1",
  "version": 1
}</expected-state>
					</test-case>
				</command>
				<event-handler on="AssetTaskUpdated" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|if event.name:|LB|    target["name"] = event.name|LB|if event.description:|LB|    target["description"] = event.description|LB|if event.assignee:|LB|    target["assignee"] = event.assignee|LB|if event.dueDate:|LB|    target["dueDate"] = event.dueDate|LB|if event.notes:|LB|    target["notes"] = event.notes|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="AssetCreated">
					<mapping operand="set" target="arn" value="arn"></mapping>
					<mapping operand="set" target="name" value="name"></mapping>
					<mapping operand="set" target="description" value="description"></mapping>
					<mapping operand="set" target="owner" value="owner"></mapping>
					<mapping operand="set" target="confidentiality" value="confidentiality"></mapping>
					<mapping operand="set" target="integrity" value="integrity"></mapping>
					<mapping operand="set" target="availability" value="availability"></mapping>
					<mapping operand="set" target="privacy" value="privacy"></mapping>
				</event-handler>
				<event-handler on="AssetTaskCompleted" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|target["completeDate"] = event.completeDate|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="AssetTaskCreated" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|target["name"] = event.name|LB|target["description"] = event.description|LB|target["assignee"] = event.assignee|LB|target["dueDate"] = event.dueDate|LB|target["notes"] = event.notes|LB|target["arn"] = event.arn|LB|target["completeDate"] = ""|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="AssetDeleted" code='self.isDeleted = "soft"'></event-handler>
				<event-handler on="AssetUpdated" code="if event.name:|LB|    self.name = event.name|LB|if event.description:|LB|    self.description = event.description|LB|if event.owner:|LB|    self.owner = event.owner|LB|if event.confidentiality:|LB|    self.confidentiality = event.confidentiality|LB|if event.integrity:|LB|    self.integrity = event.integrity|LB|if event.availability:|LB|    self.availability = event.availability|LB|if event.privacy:|LB|    self.privacy = event.privacy|LB|"></event-handler>
				<nested-object name="task" business-key="arn">
					<field name="name" type="String"></field>
					<field name="description" type="String"></field>
					<field name="assignee" type="String"></field>
					<field name="dueDate" type="String"></field>
					<field name="completeDate" type="String"></field>
					<field name="notes" type="String"></field>
					<field name="arn" type="String"></field>
				</nested-object>
			</aggregate>
			<aggregate name="ProcessingActivity" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="owner" type="String"></field>
				<field name="requiresDpia" type="Boolean"></field>
				<field name="weight" type="Int"></field>
				<command name="UpdateTask">
					<trigger source="UpdateCompanyProcessingActivityTaskRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assignee" value="assignee"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="notes" value="notes"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="FRpKW9" exception="ProcessingActivity not found"></processor>
					<processor condition="flow.arn in flow.entity.task" type="validator" exception="Task does not exist in processing activity" id="ASxjT9"></processor>
					<processor condition="flow.entity.task[flow.arn]['completeDate'] == &quot;&quot;" type="validator" exception="Task already completed" id="EJbohK"></processor>
					<processor condition="flow.entity.task[flow.arn]['completeDate'] == &quot;&quot;" type="emit-event" id="PlCV4E" ref="ProcessingActivityTaskUpdated">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assignee" value="#flow.assignee"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="notes" value="#flow.notes"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="UpdateTask" trigger-event="UpdateCompanyProcessingActivityTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="name" type="String" value="Hello World!"></input>
						<input name="description" type="String" value=""></input>
						<input name="assignee" type="String" value=""></input>
						<input name="dueDate" type="String" value=""></input>
						<input name="notes" type="String" value=""></input>
						<state>{
  "arn": "anove:company:test:processingactivity:myac",
  "task": {
    "anove:company:test:processingactivity:myac:task": {
      "arn": "anove:company:test:processingactivity:myac:task",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  },
  "version": 1
}</state>
						<expected domain-event="ProcessingActivityTaskUpdated" id="t2Uvb9">
							<field name="name" type="String" value="Hello World!"></field>
							<field name="description" type="String" value=""></field>
							<field name="assignee" type="String" value=""></field>
							<field name="dueDate" type="String" value=""></field>
							<field name="notes" type="String" value=""></field>
							<field name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></field>
						</expected>
						<expected-state pk="anove:company:test:processingactivity:myac">{
  "arn": "anove:company:test:processingactivity:myac",
  "task": {
    "anove:company:test:processingactivity:myac:task": {
      "arn": "anove:company:test:processingactivity:myac:task",
      "name": "Hello World!",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="UnknownActivity" trigger-event="UpdateCompanyProcessingActivityTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{}</state>
					</test-case>
					<test-case name="UnknownTask" trigger-event="UpdateCompanyProcessingActivityTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{
  "version": 1
}</state>
					</test-case>
					<test-case name="TaskAlreadyCompleted" trigger-event="UpdateCompanyProcessingActivityTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{
  "version": 1,
  "task": {
    "anove:company:test:processingactivity:myac:task": {
      "arn": "anove:company:test:processingactivity:myac:task",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "2024-08-01",
      "notes": "text"
    }
  }
}</state>
					</test-case>
				</command>
				<command name="CompleteTask">
					<trigger source="CompleteCompanyProcessingActivityTaskRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="username" value="username"></mapping>
					</trigger>
					<processor type="validator" id="krhc9a" condition="flow.arn in flow.entity.task" exception="Task with arn {flow.arn} not found in asset"></processor>
					<processor condition='flow.entity.task[flow.arn]["completeDate"] == ""' type="validator" id="lT1jW2" exception="Task already completed"></processor>
					<processor type="validator" condition='flow.entity.task[flow.arn]["assignee"].endswith(flow.username)' id="aCCQEu" exception="User {flow.username} is not the owner of this task"></processor>
					<processor type="code" code='from datetime import date|LB|flow.completeDate = date.today().strftime("%Y-%m-%d")' id="vyIgIF"></processor>
					<processor type="emit-event" id="dwXjrb" ref="ProcessingActivityTaskCompleted">
						<mapping target="completeDate" value="#flow.completeDate"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="CompleteTask" trigger-event="CompleteCompanyProcessingActivityTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{
  "task": {
    "anove:company:test:processingactivity:myac:task": {
      "arn": "anove:company:test:processingactivity:myac:task",
      "name": "text",
      "description": "text",
      "assignee": "dummy:j.doe",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  },
  "arn": "anove:company:test:processingactivity:myac"
}</state>
						<expected domain-event="ProcessingActivityTaskCompleted" id="MXM6yK">
							<field name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></field>
						</expected>
						<expected-state pk="anove:company:test:processingactivity:myac">{
  "arn": "anove:company:test:processingactivity:myac"
}</expected-state>
					</test-case>
					<test-case name="TaskAlreadyCompleted" trigger-event="CompleteCompanyProcessingActivityTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{
  "task": {
    "anove:company:test:processingactivity:myac:task": {
      "arn": "anove:company:test:processingactivity:myac:task",
      "name": "text",
      "description": "text",
      "assignee": "dummy:j.doe",
      "dueDate": "text",
      "completeDate": "2024-08-01",
      "notes": "text"
    }
  }
}</state>
					</test-case>
					<test-case name="NotOwner" trigger-event="CompleteCompanyProcessingActivityTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="username" type="String" value="john"></input>
						<state>{
  "task": {
    "anove:company:test:processingactivity:myac:task": {
      "arn": "anove:company:test:processingactivity:myac:task",
      "name": "text",
      "description": "text",
      "assignee": "dummy:j.doe",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</state>
					</test-case>
					<test-case name="TaskNotFound" trigger-event="CompleteCompanyProcessingActivityTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{}</state>
					</test-case>
				</command>
				<command name="Delete">
					<trigger source="DeleteCompanyProcessingActivityRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="ProcessingActivityDeleted" id="S68Flq">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="Delete" trigger-event="DeleteCompanyProcessingActivityRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="ProcessingActivityDeleted" id="bk7Gha">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "isDeleted": "soft"
}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateCompanyProcessingActivityRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="owner" value="owner"></mapping>
						<mapping target="requiresDpia" value="requiresDpia"></mapping>
						<mapping target="weight" value="weight"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" exception="ProcessingActivity does not exist" id="8Bi6A0"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="ProcessingActivityUpdated" id="Yb2V6L">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
						<mapping target="requiresDpia" value="#flow.requiresDpia"></mapping>
						<mapping target="weight" value="#flow.weight"></mapping>
					</processor>
					<test-case name="Update" trigger-event="UpdateCompanyProcessingActivityRequested" expected-processing-status="success">
						<input name="arn" type="String" value="text"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="owner" type="String" value="text"></input>
						<input name="requiresDpia" type="Boolean" value="false"></input>
						<input name="weight" type="Int" value="0"></input>
						<expected domain-event="ProcessingActivityUpdated" id="sy9Jtj">
							<field name="arn" type="String" value="text"></field>
							<field name="name" type="String" value="text"></field>
							<field name="description" type="String" value="text"></field>
							<field name="owner" type="String" value="text"></field>
							<field name="requiresDpia" type="Boolean" value="false"></field>
							<field name="weight" type="Int" value="0"></field>
						</expected>
						<state>{
  "version": 1
}</state>
						<expected-state pk="businessKey">{
  "arn": "businessKey"
}</expected-state>
					</test-case>
				</command>
				<command name="CreateTask">
					<trigger source="CreateCompanyProcessingActivityTaskRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assignee" value="assignee"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="notes" value="notes"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="EN6F6D" exception="ProcessingActivity does not exist"></processor>
					<processor condition="not flow.arn in flow.entity.task" type="validator" exception="Task already exists" id="kbptHA"></processor>
					<processor type="emit-event" ref="ProcessingActivityTaskCreated" id="cToRZE">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assignee" value="#flow.assignee"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="notes" value="#flow.notes"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="CreateTask" trigger-event="CreateCompanyProcessingActivityTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="name" type="String" value="Hello World"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="j.doe"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<expected domain-event="ProcessingActivityTaskCreated" id="BigaOV">
							<field name="name" type="String" value="Hello World"></field>
							<field name="description" type="String" value="text"></field>
							<field name="assignee" type="String" value="j.doe"></field>
							<field name="dueDate" type="String" value="text"></field>
							<field name="notes" type="String" value="text"></field>
							<field name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></field>
						</expected>
						<state>{
  "arn": "anove:company:test:processingactivity:myac",
  "version": 1
}</state>
						<expected-state pk="anove:company:test:processingactivity:myac">{
  "arn": "anove:company:test:processingactivity:myac",
  "task": {
    "anove:company:test:processingactivity:myac:task": {
      "arn": "anove:company:test:processingactivity:myac:task",
      "name": "Hello World",
      "description": "text",
      "assignee": "j.doe",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="UnknownActivity" trigger-event="CreateCompanyProcessingActivityTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{}</state>
					</test-case>
					<test-case name="TaskAlreadyExist" trigger-event="CreateCompanyProcessingActivityTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:test:processingactivity:myac:task"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{
  "version": 1,
  "task": {
    "anove:company:test:processingactivity:myac:task": {
      "arn": "anove:company:test:processingactivity:myac:task",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "text",
      "notes": "text"
    }
  }
}</state>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="CreateCompanyProcessingActivityRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="owner" value="owner"></mapping>
						<mapping target="requiresDpia" value="requiresDpia"></mapping>
						<mapping target="weight" value="weight"></mapping>
					</trigger>
					<processor type="emit-event" id="BOHCl9" ref="ProcessingActivityCreated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
						<mapping target="requiresDpia" value="#flow.requiresDpia"></mapping>
						<mapping target="weight" value="#flow.weight"></mapping>
					</processor>
					<test-case name="CreateActivity" trigger-event="CreateCompanyProcessingActivityRequested" expected-processing-status="success">
						<input name="arn" type="String" value="text"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="owner" type="String" value="text"></input>
						<input name="requiresDpia" type="Boolean" value="false"></input>
						<input name="weight" type="Int" value="0"></input>
						<state>{}</state>
						<expected domain-event="ProcessingActivityCreated" id="2Me6g5">
							<field name="arn" type="String" value="text"></field>
							<field name="name" type="String" value="text"></field>
							<field name="description" type="String" value="text"></field>
							<field name="owner" type="String" value="text"></field>
							<field name="requiresDpia" type="Boolean" value="false"></field>
							<field name="weight" type="Int" value="0"></field>
						</expected>
						<expected-state pk="businessKey">{
  "arn": "businessKey"
}</expected-state>
					</test-case>
				</command>
				<event-handler on="ProcessingActivityTaskCreated" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|target["name"] = event.name|LB|target["description"] = event.description|LB|target["assignee"] = event.assignee|LB|target["dueDate"] = event.dueDate|LB|target["completeDate"] = ""|LB|target["notes"] = event.notes|LB|target["arn"] = event.arn|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="ProcessingActivityTaskCompleted" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|target["completeDate"] = event.completeDate|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="ProcessingActivityUpdated">
					<mapping target="arn" value="arn" operand="set"></mapping>
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="description" value="description" operand="set"></mapping>
					<mapping target="owner" value="owner" operand="set"></mapping>
					<mapping target="requiresDpia" value="requiresDpia" operand="set"></mapping>
					<mapping target="weight" value="weight" operand="set"></mapping>
				</event-handler>
				<event-handler on="ProcessingActivityDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="ProcessingActivityCreated">
					<mapping target="arn" value="arn" operand="set"></mapping>
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="description" value="description" operand="set"></mapping>
					<mapping target="owner" value="owner" operand="set"></mapping>
					<mapping target="requiresDpia" value="requiresDpia" operand="set"></mapping>
					<mapping target="weight" value="weight" operand="set"></mapping>
				</event-handler>
				<event-handler on="ProcessingActivityTaskUpdated" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|if event.name:|LB|    target["name"] = event.name|LB|if event.description:|LB|    target["description"] = event.description|LB|if event.assignee:|LB|    target["assignee"] = event.assignee|LB|if event.dueDate:|LB|    target["dueDate"] = event.dueDate|LB|if event.notes:|LB|    target["notes"] = event.notes|LB|target["arn"] = event.arn|LB|self.task[event["arn"]] = target'></event-handler>
				<nested-object name="task" business-key="arn">
					<field name="name" type="String"></field>
					<field name="description" type="String"></field>
					<field name="assignee" type="String"></field>
					<field name="dueDate" type="String"></field>
					<field name="completeDate" type="String"></field>
					<field name="notes" type="String"></field>
					<field name="arn" type="String"></field>
				</nested-object>
			</aggregate>
			<aggregate name="Company" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="companySize" type="Int"></field>
				<field name="revenue" type="String"></field>
				<field name="industryLink" type="StringList"></field>
				<field name="countryArn" type="String"></field>
				<field name="deletedEmployeeArns" type="StringList"></field>
				<field name="controlFrameworkLinks" type="StringList"></field>
				<field name="logoPath" type="String"></field>
				<command name="UnlinkControlFramework">
					<trigger source="UnlinkControlFrameworkCompanyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="controlFrameworkArn" value="controlFrameworkArn"></mapping>
					</trigger>
					<processor type="emit-event" id="RKifTj" ref="UnlinkedControlFrameworkFromCompany">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="controlFrameworkArn" value="#flow.controlFrameworkArn"></mapping>
					</processor>
					<test-case name="UnlinkControlFramework" trigger-event="UnlinkControlFrameworkCompanyRequested">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="controlFrameworkArn" value="first" type="String"></input>
						<expected domain-event="UnlinkedControlFrameworkFromCompany">
							<field value="company:draftsman" name="arn" type="String"></field>
							<field value="first" name="controlFrameworkArn" type="String"></field>
						</expected>
						<state>{
  "controlFrameworkLinks": [
        "first",
         "second"
   ]
}</state>
						<expected-state pk="company:draftsman">{
  "controlFrameworkLinks": [
         "second"
   ]
}</expected-state>
					</test-case>
				</command>
				<command name="RemoveBusinessUnit">
					<trigger source="RemoveCompanyBusinessUnitRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
					</trigger>
					<processor type="emit-event" id="Vaiosp" ref="BusinessUnitRemoved">
						<mapping target="name" value="#flow.name"></mapping>
					</processor>
					<test-case name="RemoveBusinessUnit" trigger-event="RemoveCompanyBusinessUnitRequested">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="name" value="Product Development" type="String"></input>
						<expected domain-event="BusinessUnitRemoved">
							<field value="Product Development" name="name" type="String"></field>
						</expected>
						<state>{
  "arn": "company:draftsman",
  "businessUnits": {
    "Product Development": {
      "name": "Product Development",
      "description": "Hello World!"
    }
  }
}</state>
						<expected-state pk="company:draftsman">{
  "arn": "company:draftsman",
  "businessUnits": {}
}</expected-state>
					</test-case>
				</command>
				<command name="Delete">
					<trigger source="DeleteCompanyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="CompanyDeleted" id="GKbk56">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteCompany" trigger-event="DeleteCompanyRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="CompanyDeleted" id="CZTNtW">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="AddBusinessUnit">
					<trigger source="AddCompanyBusinessUnitRequested" key-field="arn" idempotency-key="">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
					</trigger>
					<processor type="validator" id="r3TLgH" condition='flow.entity.name != ""' exception="Company does not exist"></processor>
					<processor type="validator" id="BM5RG4" condition="flow.name not in flow.entity.businessUnits" exception="Can not add business unit with name {flow.name} because it is already present"></processor>
					<processor type="code" id="SJBpIu" file="" handler="" code='flow.businessUnits = [{|LB|    "name": flow.name,|LB|    "description": flow.description|LB|}]'></processor>
					<processor type="emit-event" id="zYKprC" ref="BusinessUnitAdded">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="businessUnits" value="#flow.businessUnits"></mapping>
					</processor>
					<test-case name="AddBusinessUnit" trigger-event="AddCompanyBusinessUnitRequested" expected-processing-status="success">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="name" value="Engineering" type="String"></input>
						<input name="description" value="Hello World!" type="String"></input>
						<state>{
  "name": "Draftsman"
}</state>
						<expected domain-event="BusinessUnitAdded" id="gmEFLa">
							<field value="company:draftsman" name="arn" type="String"></field>
						</expected>
						<expected-state pk="company:draftsman">{
  "name": "Draftsman",
  "businessUnits": {
    "Engineering": {
      "name": "Engineering",
      "description": "Hello World!"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="AddDuplicateBusinessUnit" trigger-event="AddCompanyBusinessUnitRequested" expected-processing-status="error">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="name" value="Engineering" type="String"></input>
						<input name="description" value="..." type="String"></input>
						<state>{
  "name": "Draftsman",
  "businessUnits": {
    "Engineering": {
      "name": "Engineering",
      "description": "Hello World!"
    }
  }
}</state>
					</test-case>
					<test-case name="AddBusinessUnitToNonExisstingCompany" trigger-event="AddCompanyBusinessUnitRequested" expected-processing-status="error">
						<input name="arn" value="company:dummy" type="String"></input>
						<input name="name" value="Engineering" type="String"></input>
						<input name="description" value="Hello World!" type="String"></input>
						<state>{}</state>
					</test-case>
				</command>
				<command name="LinkControlFramework">
					<trigger source="LinkControlFrameworkCompanyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="controlFrameworkArn" value="controlFrameworkArn"></mapping>
					</trigger>
					<processor type="validator" id="UhPsMB" condition='flow.entity.name != ""' exception="Company is not initialized"></processor>
					<processor condition="flow.controlFrameworkArn not in flow.entity.controlFrameworkLinks" type="validator" id="9FqtZ6" exception="Framework is already linked"></processor>
					<processor type="emit-event" id="gF6Krh" ref="LinkedControlFrameworkToCompany">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="controlFrameworkArn" value="#flow.controlFrameworkArn"></mapping>
					</processor>
					<test-case name="LinkControlFramework" trigger-event="LinkControlFrameworkCompanyRequested" expected-processing-status="success">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="controlFrameworkArn" value="controlframework:gdpr" type="String"></input>
						<expected domain-event="LinkedControlFrameworkToCompany" id="UTr76J">
							<field value="company:draftsman" name="arn" type="String"></field>
							<field value="controlframework:gdpr" name="controlFrameworkArn" type="String"></field>
						</expected>
						<state>{
  "name": "Draftsman",
      "arn": "company:draftsman"
}</state>
						<expected-state pk="company:draftsman">{"controlFrameworkLinks":["controlframework:gdpr"],"arn":"company:draftsman"}</expected-state>
					</test-case>
					<test-case name="LinkControlFrameworkToNonExistingCompany" trigger-event="LinkControlFrameworkCompanyRequested" expected-processing-status="error">
						<input name="arn" value="company:tracepaper" type="String"></input>
						<input name="controlFrameworkArn" value="controlframework:gdpr" type="String"></input>
						<state>{}</state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateCompanyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="companySize" value="companySize"></mapping>
						<mapping target="revenue" value="revenue"></mapping>
						<mapping target="industryLink" value="industryLink"></mapping>
						<mapping target="countryArn" value="countryArn"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="qKFeiS" exception="Company does not exist"></processor>
					<processor type="emit-event" ref="CompanyUpdated" id="l8ZkPe">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="companySize" value="#flow.companySize"></mapping>
						<mapping target="revenue" value="#flow.revenue"></mapping>
						<mapping target="industryLink" value="#flow.industryLink"></mapping>
						<mapping target="countryArn" value="#flow.countryArn"></mapping>
					</processor>
					<test-case name="UpdateCompany" trigger-event="UpdateCompanyRequested" expected-processing-status="success">
						<input name="arn" type="String" value="company"></input>
						<input name="description" type="String" value="Hello World!"></input>
						<input name="companySize" type="Int" value="10"></input>
						<input name="revenue" type="String" value="1M"></input>
						<input name="industryLink" type="String" value="tech"></input>
						<input name="countryArn" type="String" value="nl"></input>
						<expected domain-event="CompanyUpdated" id="Rb8lET">
							<field name="arn" type="String" value="company"></field>
							<field name="description" type="String" value="Hello World!"></field>
							<field name="companySize" type="Int" value="10"></field>
							<field name="revenue" type="String" value="1M"></field>
							<field name="industryLink" type="String" value="tech"></field>
							<field name="countryArn" type="String" value="nl"></field>
						</expected>
						<state>{
  "arn": "company",
  "version": 1
}</state>
						<expected-state pk="company">{
  "arn": "company",
  "description": "Hello World!",
  "companySize": 10,
  "revenue": "1M",
  "version": 2,
  "countryArn": "nl"
}</expected-state>
					</test-case>
					<test-case name="PartialUpdate" trigger-event="UpdateCompanyRequested" expected-processing-status="success">
						<input name="arn" type="String" value="company"></input>
						<input name="description" type="String" value=""></input>
						<input name="companySize" type="Int" value="20"></input>
						<input name="revenue" type="String" value="2M"></input>
						<input name="industryLink" type="String" value=""></input>
						<input name="countryArn" type="String" value=""></input>
						<state>{
  "version": 1,
  "arn": "company",
  "name": "company",
  "description": "Hello World!",
  "companySize": 10,
  "revenue": "1M",
  "countryArn": "nl"
}</state>
						<expected domain-event="CompanyUpdated" id="iUWHJH">
							<field name="arn" type="String" value="company"></field>
							<field name="description" type="String" value=""></field>
							<field name="companySize" type="Int" value="20"></field>
							<field name="revenue" type="String" value="2M"></field>
							<field name="industryLink" type="String" value=""></field>
							<field name="countryArn" type="String" value=""></field>
						</expected>
						<expected-state pk="company">{
  "arn": "company",
  "name": "company",
  "description": "Hello World!",
  "companySize": 20,
  "revenue": "2M",
  "countryArn": "nl",
  "version": 2
}</expected-state>
					</test-case>
					<test-case name="InvalidUpdate" trigger-event="UpdateCompanyRequested" expected-processing-status="error">
						<input name="arn" type="String" value="company"></input>
						<input name="description" type="String" value="text"></input>
						<input name="companySize" type="Int" value="0"></input>
						<input name="revenue" type="String" value="text"></input>
						<input name="industryLink" type="String" value="text"></input>
						<input name="countryArn" type="String" value="text"></input>
						<state>{}</state>
					</test-case>
				</command>
				<command name="UpdateEmployeeArn">
					<trigger source="UserActivated" key-field="companyArn">
						<mapping target="username" value="username"></mapping>
						<mapping target="email" value="email"></mapping>
						<mapping target="arn" value="companyArn"></mapping>
					</trigger>
					<processor type="code" id="o8gRni" file="" handler="" code='flow.employeeArn = flow.arn + ":employee:" + flow.username|LB|flow.oldArn = flow.arn + ":employee:" + flow.email|LB|if flow.oldArn not in flow.entity.employees:|LB|    raise ValidationConditionNotMet(f"Employee [{flow.username}/{flow.email}] not found in company.")|LB|flow.roles = flow.entity.employees[flow.oldArn]["roles"]|LB|'></processor>
					<processor type="emit-event" id="WrnvxO" ref="EmployeeArnUpdated">
						<mapping target="employeeArn" value="#flow.employeeArn"></mapping>
						<mapping target="oldArn" value="#flow.oldArn"></mapping>
						<mapping target="roles" value="#flow.roles"></mapping>
						<mapping target="username" value="#flow.username"></mapping>
					</processor>
					<test-case name="UpdateEmployeeArn" trigger-event="UserActivated" expected-processing-status="success">
						<input name="username" value="j.doe" type="String"></input>
						<input name="firstName" value="John" type="String"></input>
						<input name="lastName" value="Doe" type="String"></input>
						<input name="active" value="true" type="Boolean"></input>
						<input name="email" value="j.doe@example.com" type="String"></input>
						<input name="companyArn" value="company:draftsman" type="String"></input>
						<state>{
  "arn": "company:draftsman",
  "employees": {
    "company:draftsman:employee:j.doe@example.com": {
      "arn": "company:draftsman:employee:j.doe@example.com",
      "username": "j.doe@example.com",
      "roles": "administrator"
    }
  }
}</state>
						<expected-state pk="company:draftsman">{
  "arn": "company:draftsman",
  "employees": {
    "company:draftsman:employee:j.doe": {
      "arn": "company:draftsman:employee:j.doe",
      "username": "j.doe",
      "roles": "administrator"
    }
  }
}</expected-state>
						<expected domain-event="EmployeeArnUpdated" id="HowbDL">
							<field value="company:draftsman:employee:j.doe" name="employeeArn" type="String"></field>
							<field value="company:draftsman:employee:j.doe@example.com" name="oldArn" type="String"></field>
							<field value="administrator" name="roles" type="String"></field>
							<field value="j.doe" name="username" type="String"></field>
						</expected>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="CreateCompanyRequested" key-field="arn" idempotency-key="arn" idempotency-ttl="2 * 24 * 60 * 60">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="companySize" value="companySize"></mapping>
						<mapping target="revenue" value="revenue"></mapping>
						<mapping target="industry" value="industry"></mapping>
						<mapping target="user" value="user"></mapping>
						<mapping target="country" value="country"></mapping>
					</trigger>
					<processor type="code" file="lib/AccessManagement.py" handler="retrieve_raw_roles" id="S9G78O"></processor>
					<processor type="emit-event" id="AqKpZH" ref="CompanyCreated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="companySize" value="#flow.companySize"></mapping>
						<mapping target="revenue" value="#flow.revenue"></mapping>
						<mapping target="industry" value="#flow.industry"></mapping>
						<mapping target="user" value="#flow.user"></mapping>
						<mapping target="country" value="#flow.country"></mapping>
						<mapping target="roles" value="#flow.roles"></mapping>
					</processor>
					<test-case name="CreateNewCompany" trigger-event="CreateCompanyRequested" expected-processing-status="success">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="name" value="Draftsman" type="String"></input>
						<input name="description" value="--" type="String"></input>
						<input name="companySize" value="2" type="Int"></input>
						<input name="revenue" value="0" type="String"></input>
						<input name="industry" value="--" type="String"></input>
						<input name="user" value="j.doe" type="String"></input>
						<input name="country" value="region:EMEA:country:NL" type="String"></input>
						<expected domain-event="CompanyCreated" id="48W298">
							<field value="company:draftsman" name="arn" type="String"></field>
							<field value="Draftsman" name="name" type="String"></field>
							<field value="--" name="description" type="String"></field>
							<field value="2" name="companySize" type="Int"></field>
							<field value="0" name="revenue" type="String"></field>
							<field value="region:EMEA:country:NL" name="country" type="String"></field>
						</expected>
						<expected-state pk="company:draftsman">{"arn":"company:draftsman","name":"Draftsman","description":"--","companySize":2,"revenue":"0","industryLink":["--"],"countryArn":"region:EMEA:country:NL","employees":{"company:draftsman:employee:j.doe":{"arn":"company:draftsman:employee:j.doe","username":"j.doe","roles":"company-administrator;company-viewer;asset-administrator;control-administrator;integration-administrator;objective-administrator;processingactivity-administrator;risk-administrator;assessment-administrator;thirdparty-administrator"}}}</expected-state>
						<state>{}</state>
					</test-case>
					<test-case name="CreateDuplicateCompany" trigger-event="CreateCompanyRequested" expected-processing-status="error">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="name" value="Draftsman" type="String"></input>
						<input name="description" value="--" type="String"></input>
						<input name="companySize" value="2" type="Int"></input>
						<input name="revenue" value="0" type="String"></input>
						<input name="industry" value="--" type="String"></input>
						<input name="user" value="j.doe" type="String"></input>
						<input name="country" value="region:EMEA:country:NL" type="String"></input>
						<state>{
  "arn": "company:draftsman",
  "version": 1
}</state>
					</test-case>
				</command>
				<command name="UpdateBusinessUnit">
					<trigger source="UpdateCompanyBusinessUnitRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
					</trigger>
					<processor type="validator" id="ES1sG9" condition="flow.name in flow.entity.businessUnits" exception="Can not update businessunit, because it does not exist"></processor>
					<processor type="code" id="nMDsHG" file="" handler="" code='flow.businessUnits = [{|LB|    "name": flow.name,|LB|    "description": flow.description|LB|}]'></processor>
					<processor type="emit-event" id="CH0OnK" ref="BusinessUnitUpdated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="businessUnits" value="#flow.businessUnits"></mapping>
					</processor>
					<test-case name="AddNewBusinessUnit" trigger-event="UpdateCompanyBusinessUnitRequested" expected-processing-status="error">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="name" value="Product Development" type="String"></input>
						<input name="description" value="Hello World!" type="String"></input>
					</test-case>
					<test-case name="UpdateBusinessUnit" trigger-event="UpdateCompanyBusinessUnitRequested">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="name" value="Product Development" type="String"></input>
						<input name="description" value="..." type="String"></input>
						<expected domain-event="BusinessUnitUpdated">
							<field value="company:draftsman" name="arn" type="String"></field>
						</expected>
						<state>{
  "arn": "company:draftsman",
  "businessUnits": {
    "Product Development": {
      "name": "Product Development",
      "description": "Hello World!"
    }
  }
}</state>
						<expected-state pk="company:draftsman">{
  "arn": "company:draftsman",
  "businessUnits": {
    "Product Development": {
      "name": "Product Development",
      "description": "..."
    }
  }
}</expected-state>
					</test-case>
				</command>
				<command name="UpdateRoles">
					<trigger source="UpdateRolesCompanyEmployeeRequested" key-field="#global.truncateArn(arn, '3')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="newRoles" value="roles"></mapping>
					</trigger>
					<processor type="set-variable" id="HmACgJ" name="username" expression='flow.arn.split(":")[-1]'></processor>
					<processor type="code" file="lib/AccessManagement.py" handler="retrieve_raw_roles" id="yB6oo4"></processor>
					<processor type="validator" id="lTpZ9j" condition='set(flow.newRoles.split(";")).issubset(set(flow.roles))' exception="Invalid role assignment"></processor>
					<processor type="emit-event" id="DlMTCb" ref="RolesUpdated">
						<mapping target="employeeArn" value="#flow.arn"></mapping>
						<mapping target="roles" value="#flow.newRoles"></mapping>
						<mapping target="username" value="#flow.username"></mapping>
					</processor>
					<test-case name="NewUser" trigger-event="UpdateRolesCompanyEmployeeRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:employee:j.doe"></input>
						<input name="roles" type="String" value="company-viewer"></input>
						<state>{
  "arn": "anove:company:draftsman"
}</state>
						<expected domain-event="RolesUpdated" id="pj4qhW">
							<field name="employeeArn" type="String" value="anove:company:draftsman:employee:j.doe"></field>
							<field name="roles" type="String" value="company-viewer"></field>
							<field name="username" type="String" value="j.doe"></field>
						</expected>
						<expected-state pk="anove:company:draftsman">{
  "arn": "anove:company:draftsman",
  "employees": {
    "anove:company:draftsman:employee:j.doe": {
      "arn": "anove:company:draftsman:employee:j.doe",
      "username": "j.doe",
      "roles": "company-viewer"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="UpdateRoles" trigger-event="UpdateRolesCompanyEmployeeRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:employee:j.doe"></input>
						<input name="roles" type="String" value="company-viewer;company-administrator"></input>
						<expected domain-event="RolesUpdated" id="BVYmev">
							<field name="employeeArn" type="String" value="anove:company:draftsman:employee:j.doe"></field>
							<field name="roles" type="String" value="company-viewer;company-administrator"></field>
							<field name="username" type="String" value="j.doe"></field>
						</expected>
						<state>{
  "arn": "anove:company:draftsman",
  "employees": {
    "anove:company:draftsman:employee:j.doe": {
      "arn": "anove:company:draftsman:employee:j.doe",
      "username": "j.doe",
      "roles": "company-viewer"
    }
  }
}</state>
						<expected-state pk="anove:company:draftsman">{
  "arn": "anove:company:draftsman",
  "employees": {
    "anove:company:draftsman:employee:j.doe": {
      "arn": "anove:company:draftsman:employee:j.doe",
      "username": "j.doe",
      "roles": "company-viewer;company-administrator"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="InvalidRole" trigger-event="UpdateRolesCompanyEmployeeRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:draftsman:employee:j.doe"></input>
						<input name="roles" type="String" value="administrator"></input>
						<state>{}</state>
					</test-case>
				</command>
				<command name="LinkLogo">
					<trigger source="LinkLogoCompanyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="path" value="path"></mapping>
					</trigger>
					<processor type="validator" id="NjcSCR" condition="flow.entity.version != 0" exception="May not be initial request"></processor>
					<processor type="emit-event" ref="CompanyLogoLinked" id="wOTSFu">
						<mapping target="logoPath" value="#flow.path"></mapping>
					</processor>
					<test-case name="LinkLogo" trigger-event="LinkLogoCompanyRequested" expected-processing-status="success">
						<input name="arn" type="String" value="tenant:company"></input>
						<input name="path" type="String" value="myLogo.png"></input>
						<state>{
  "version": 1,
  "arn": "tenant:company"
}</state>
						<expected domain-event="CompanyLogoLinked" id="JB68zk">
							<field name="logoPath" type="String" value="myLogo.png"></field>
						</expected>
						<expected-state pk="tenant:company">{"arn":"tenant:company","logoPath":"myLogo.png"}</expected-state>
					</test-case>
				</command>
				<event-handler on="BusinessUnitRemoved" code="if event.name in self.businessUnits:|LB|    del self.businessUnits[event.name]"></event-handler>
				<event-handler on="RolesUpdated" code='self.employees[event.employeeArn] = {|LB|    "arn": event.employeeArn,|LB|    "username": event.employeeArn.split(":")[-1],|LB|    "roles": event.roles|LB|}'></event-handler>
				<event-handler on="CompanyLogoLinked">
					<mapping target="logoPath" value="logoPath" operand="set"></mapping>
				</event-handler>
				<event-handler on="EmployeeArnUpdated" code='self.employees[event.employeeArn] = {|LB|    "arn": event.employeeArn,|LB|    "username": event.username,|LB|    "roles": event.roles|LB|}|LB|if event.oldArn in self.employees:|LB|    del self.employees[event.oldArn]|LB|    |LB|self.deletedEmployeeArns.append(event.oldArn)'></event-handler>
				<event-handler on="BusinessUnitAdded">
					<nested-mapping source="businessUnits" target="businessUnits" business-key="name">
						<mapping target="name" operand="set" value="name"></mapping>
						<mapping target="description" operand="set" value="description"></mapping>
					</nested-mapping>
				</event-handler>
				<event-handler on="BusinessUnitUpdated">
					<nested-mapping source="businessUnits" target="businessUnits" business-key="name">
						<mapping target="name" operand="set" value="name"></mapping>
						<mapping target="description" operand="set" value="description"></mapping>
					</nested-mapping>
				</event-handler>
				<event-handler on="CompanyCreated" code="self.arn = event.arn|LB|self.name = event.name|LB|self.description = event.description|LB|self.companySize = event.companySize|LB|self.revenue = event.revenue|LB|self.industryLink = event.industry.split(';')|LB|self.countryArn = event.country|LB|employeeArn = event.arn + &quot;:employee:&quot; + event.user|LB|self.employees[employeeArn] = {|LB|    &quot;arn&quot;: employeeArn,|LB|    &quot;username&quot;: event.user,|LB|    &quot;roles&quot;: &quot;;&quot;.join(event.roles)|LB|}"></event-handler>
				<event-handler on="CompanyDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="LinkedControlFrameworkToCompany" code="if not hasattr(self, 'controlFrameworkLinks'):|LB|    self.controlFrameworkLinks = []|LB|self.controlFrameworkLinks.append(event.controlFrameworkArn)|LB|self.controlFrameworkLinks = list(set(self.controlFrameworkLinks))"></event-handler>
				<event-handler on="UnlinkedControlFrameworkFromCompany" code="self.controlFrameworkLinks.remove(event.controlFrameworkArn)"></event-handler>
				<event-handler on="CompanyUpdated" code='if event.description:|LB|    self.description = event.description|LB|if event.companySize:|LB|    self.companySize = event.companySize|LB|if event.revenue:|LB|    self.revenue = event.revenue|LB|if event.industryLink:|LB|    self.industryLink = event.industryLink.split(";")|LB|if event.countryArn:|LB|    self.countryArn = event.countryArn'></event-handler>
				<nested-object name="businessUnits" business-key="name">
					<field name="name" type="String"></field>
					<field name="description" type="String"></field>
				</nested-object>
				<nested-object name="employees" business-key="arn">
					<field name="arn" type="String"></field>
					<field name="username" type="String"></field>
					<field name="roles" type="String"></field>
				</nested-object>
			</aggregate>
			<aggregate name="Risk" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="grossLikelihood" type="Int"></field>
				<field name="grossImpact" type="Int"></field>
				<field name="apetiteLikelihood" type="Int"></field>
				<field name="apetiteImpact" type="Int"></field>
				<field name="reviewPeriodicity" type="String"></field>
				<field name="lastReviewDate" type="String"></field>
				<field name="nextReviewDate" type="String"></field>
				<field name="hasPendingSelfAssessment" type="Boolean"></field>
				<field name="owner" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteCompanyRiskRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" id="7uu4KP" ref="RiskDeleted">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteRisk" trigger-event="DeleteCompanyRiskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="RiskDeleted" id="PJvIU5">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="Update" create-command="false">
					<trigger source="UpdateCompanyRiskRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="grossLikelihood" value="grossLikelihood"></mapping>
						<mapping target="grossImpact" value="grossImpact"></mapping>
						<mapping target="apetiteLikelihood" value="apetiteLikelihood"></mapping>
						<mapping target="apetiteImpact" value="apetiteImpact"></mapping>
						<mapping target="reviewPeriodicity" value="reviewPeriodicity"></mapping>
						<mapping target="nextReviewDate" value="nextReviewDate"></mapping>
						<mapping target="controlLinks" value="controlLinks"></mapping>
						<mapping target="treatmentPlan" value="treatmentPlan"></mapping>
						<mapping target="owner" value="owner"></mapping>
					</trigger>
					<processor type="validator" id="xwMnZZ" condition="flow.entity.version != 0" exception="May not be initial request"></processor>
					<processor type="code" id="ULzJMA" file="lib/RiskUtils.py" handler="generate_change_log"></processor>
					<processor type="emit-event" ref="RiskUpdated" id="5739LK">
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="grossLikelihood" value="#flow.grossLikelihood"></mapping>
						<mapping target="grossImpact" value="#flow.grossImpact"></mapping>
						<mapping target="apetiteLikelihood" value="#flow.apetiteLikelihood"></mapping>
						<mapping target="apetiteImpact" value="#flow.apetiteImpact"></mapping>
						<mapping target="reviewPeriodicity" value="#flow.reviewPeriodicity"></mapping>
						<mapping target="nextReviewDate" value="#flow.nextReviewDate"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
						<mapping target="changeLog" value="#flow.changeLog"></mapping>
						<mapping target="controlLinks" value="#flow.controlLinks"></mapping>
						<mapping target="treatmentPlan" value="#flow.treatmentPlan"></mapping>
					</processor>
					<test-case name="RiskUpdate" trigger-event="UpdateCompanyRiskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:risk:myrisk"></input>
						<input name="description" type="String" value="Hello World!"></input>
						<input name="grossLikelihood" type="Int" value="3"></input>
						<input name="grossImpact" type="Int" value="3"></input>
						<input name="apetiteLikelihood" type="Int" value="2"></input>
						<input name="apetiteImpact" type="Int" value="2"></input>
						<input name="reviewPeriodicity" type="String" value="1Y"></input>
						<input name="nextReviewDate" type="String" value="01-08-2024"></input>
						<input name="owner" type="String" value="anove:company:draftsman:employee:j.doe"></input>
						<input name="controlLinks" type="NestedObject">[
  {
    "arn": "anove:company:draftsman:control:mycontrol",
    "impactOnRisk": "100"
  }
]</input>
						<input name="treatmentPlan" type="NestedObject">[
  {
    "type": "mitigate",
    "description": "hello world!"
  }
]</input>
						<state>{
  "version": 1
}</state>
						<expected domain-event="RiskUpdated" id="5nIWpq">
							<field name="description" type="String" value="Hello World!"></field>
							<field name="grossLikelihood" type="Int" value="3"></field>
							<field name="grossImpact" type="Int" value="3"></field>
							<field name="apetiteLikelihood" type="Int" value="2"></field>
							<field name="apetiteImpact" type="Int" value="2"></field>
							<field name="reviewPeriodicity" type="String" value="1Y"></field>
							<field name="nextReviewDate" type="String" value="01-08-2024"></field>
							<field name="owner" type="String" value="anove:company:draftsman:employee:j.doe"></field>
						</expected>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="CreateCompanyRiskRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="grossLikelihood" value="grossLikelihood"></mapping>
						<mapping target="grossImpact" value="grossImpact"></mapping>
						<mapping target="apetiteLikelihood" value="apetiteLikelihood"></mapping>
						<mapping target="apetiteImpact" value="apetiteImpact"></mapping>
						<mapping target="reviewPeriodicity" value="reviewPeriodicity"></mapping>
						<mapping target="nextReviewDate" value="nextReviewDate"></mapping>
						<mapping target="controlLinks" value="controlLinks"></mapping>
						<mapping target="treatmentPlan" value="treatmentPlan"></mapping>
						<mapping target="owner" value="owner"></mapping>
					</trigger>
					<processor type="code" id="7lt4Ys" file="lib/RiskUtils.py" handler="generate_change_log"></processor>
					<processor type="emit-event" ref="RiskCreated" id="KgKWZN">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="grossLikelihood" value="#flow.grossLikelihood"></mapping>
						<mapping target="grossImpact" value="#flow.grossImpact"></mapping>
						<mapping target="apetiteLikelihood" value="#flow.apetiteLikelihood"></mapping>
						<mapping target="apetiteImpact" value="#flow.apetiteImpact"></mapping>
						<mapping target="reviewPeriodicity" value="#flow.reviewPeriodicity"></mapping>
						<mapping target="nextReviewDate" value="#flow.nextReviewDate"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
						<mapping target="changeLog" value="#flow.changeLog"></mapping>
						<mapping target="controlLinks" value="#flow.controlLinks"></mapping>
						<mapping target="treatmentPlan" value="#flow.treatmentPlan"></mapping>
					</processor>
					<test-case name="CreateRisk" trigger-event="CreateCompanyRiskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:risk:myrisk"></input>
						<input name="name" type="String" value="myrisk"></input>
						<input name="description" type="String" value="Hello World!"></input>
						<input name="grossLikelihood" type="Int" value="3"></input>
						<input name="grossImpact" type="Int" value="3"></input>
						<input name="apetiteLikelihood" type="Int" value="2"></input>
						<input name="apetiteImpact" type="Int" value="2"></input>
						<input name="reviewPeriodicity" type="String" value="1Y"></input>
						<input name="nextReviewDate" type="String" value="01-08-2024"></input>
						<input name="owner" type="String" value="company:draftsman:employee:j.doe"></input>
						<input name="controlLinks" type="NestedObject">[
  {
    "arn": "anove:company:draftsman:control:mycontrol",
    "impactOnRisk": 100
  }
]</input>
						<input name="treatmentPlan" type="NestedObject">[
  {
    "type": "mitigate",
    "description": "hello world!"
  }
]</input>
						<state>{}</state>
						<expected domain-event="RiskCreated" id="EpURqj">
							<field name="arn" type="String" value="anove:company:draftsman:risk:myrisk"></field>
							<field name="name" type="String" value="myrisk"></field>
							<field name="description" type="String" value="Hello World!"></field>
							<field name="grossLikelihood" type="Int" value="3"></field>
							<field name="grossImpact" type="Int" value="3"></field>
							<field name="apetiteLikelihood" type="Int" value="2"></field>
							<field name="apetiteImpact" type="Int" value="2"></field>
							<field name="reviewPeriodicity" type="String" value="1Y"></field>
							<field name="nextReviewDate" type="String" value="01-08-2024"></field>
							<field name="owner" type="String" value="company:draftsman:employee:j.doe"></field>
						</expected>
						<expected-state pk="anove:company:draftsman:risk:myrisk">{
  "arn": "anove:company:draftsman:risk:myrisk",
  "controlLinks": {
    "anove:company:draftsman:control:mycontrol": {
      "arn": "anove:company:draftsman:control:mycontrol",
      "impactOnRisk": 100
    }
  },
  "treatmentPlan": {
    "mitigate": {
      "type": "mitigate",
      "description": "hello world!"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="CreateInitialRisk" trigger-event="CreateCompanyRiskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:draftsman:risk:myrisk"></input>
						<input name="name" type="String" value="myrisk"></input>
						<input name="description" type="String" value="Hello World!"></input>
						<input name="grossLikelihood" type="Int" value="3"></input>
						<input name="grossImpact" type="Int" value="3"></input>
						<input name="apetiteLikelihood" type="Int" value="2"></input>
						<input name="apetiteImpact" type="Int" value="2"></input>
						<input name="reviewPeriodicity" type="String" value="1Y"></input>
						<input name="nextReviewDate" type="String" value="01-08-2024"></input>
						<input name="owner" type="String" value="company:draftsman:employee:j.doe"></input>
						<input name="controlLinks" type="NestedObject"></input>
						<input name="treatmentPlan" type="NestedObject"></input>
						<state>{}</state>
						<expected domain-event="RiskCreated" id="ZzeivK">
							<field name="arn" type="String" value="anove:company:draftsman:risk:myrisk"></field>
							<field name="name" type="String" value="myrisk"></field>
							<field name="description" type="String" value="Hello World!"></field>
							<field name="grossLikelihood" type="Int" value="3"></field>
							<field name="grossImpact" type="Int" value="3"></field>
							<field name="apetiteLikelihood" type="Int" value="2"></field>
							<field name="apetiteImpact" type="Int" value="2"></field>
							<field name="reviewPeriodicity" type="String" value="1Y"></field>
							<field name="nextReviewDate" type="String" value="01-08-2024"></field>
							<field name="owner" type="String" value="company:draftsman:employee:j.doe"></field>
						</expected>
						<expected-state pk="businessKey">{
  "arn": "businessKey"
}</expected-state>
					</test-case>
				</command>
				<command name="CreateAction">
					<trigger source="CreateCompanyRiskActionRequested" key-field="arn">
						<mapping target="id" value="id"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assignee" value="assignee"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<trigger source="StartAssessmentCompanyRiskRequested" key-field="arn">
						<mapping target="id" value="id"></mapping>
						<mapping target="name" value="#'Periodic assessment'"></mapping>
						<mapping target="description" value="#''"></mapping>
						<mapping target="assignee" value="#''"></mapping>
						<mapping target="dueDate" value="#''"></mapping>
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="validator" id="psTuG6" condition="flow.entity.version != 0" exception="May not be the initial request"></processor>
					<processor type="validator" id="JwUgP2" condition="flow.id not in flow.entity.actions" exception="Action with id {flow.id} already exists"></processor>
					<processor type="code" id="y3VoEy" file="" handler="" code='flow.actions = [{|LB|    "id": flow.id,|LB|    "name": flow.name,|LB|    "description": flow.description,|LB|    "assignee": flow.assignee,|LB|    "dueDate": flow.dueDate,|LB|    "arn": flow.arn + ":" + flow.id,|LB|    "category": "self" if flow.name == "Periodic assessment" else "other"|LB|}]|LB||LB|flow.hasPendingSelfAssessment = flow.entity.hasPendingSelfAssessment or flow.name == "Periodic assessment"'></processor>
					<processor type="emit-event" id="fSmNfP" ref="RiskActionCreated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="hasPendingSelfAssessment" value="#flow.hasPendingSelfAssessment"></mapping>
						<mapping target="actions" value="#flow.actions"></mapping>
					</processor>
					<test-case name="CreateRiskAction" trigger-event="CreateCompanyRiskActionRequested" expected-processing-status="success">
						<input name="arn" value="anove:company:draftsman:risk:myrisk" type="String"></input>
						<input name="id" value="e8db3932-b7c7-46c1-b530-3de58339db6f" type="String"></input>
						<input name="name" value="Do Something" type="String"></input>
						<input name="description" value="Hello World!" type="String"></input>
						<input name="assignee" value="arn:j.doe" type="String"></input>
						<input name="dueDate" value="2024-08-01" type="String"></input>
						<expected domain-event="RiskActionCreated" id="l547le">
							<field value="anove:company:draftsman:risk:myrisk" name="arn" type="String"></field>
						</expected>
						<state>{"version":1,"arn":"anove:company:draftsman:risk:myrisk"}</state>
						<expected-state pk="anove:company:draftsman:risk:myrisk">{
  "actions": {
    "e8db3932-b7c7-46c1-b530-3de58339db6f": {
      "id": "e8db3932-b7c7-46c1-b530-3de58339db6f",
      "name": "Do Something",
      "description": "Hello World!",
      "assignee": "arn:j.doe",
      "dueDate": "2024-08-01",
      "arn": "anove:company:draftsman:risk:myrisk:e8db3932-b7c7-46c1-b530-3de58339db6f",
      "category": "other"
    }
  },
  "arn": "anove:company:draftsman:risk:myrisk"
}</expected-state>
					</test-case>
				</command>
				<command name="CompleteAction">
					<trigger source="CompleteCompanyRiskActionRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="code" id="R2jzSa" file="lib/AssessmentUtils.py" handler="prepare_risk_action_completion"></processor>
					<processor type="validator" id="CfYp4z" condition='"completeDate" not in flow.action or flow.action["completeDate"] == ""' exception="Action already completed"></processor>
					<processor type="set-variable" id="v9agTv" name="arn" expression="flow.identity"></processor>
					<processor type="emit-event" id="3Jsm2i" ref="RiskActionCompleted">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="hasPendingSelfAssessment" value="#flow.hasPendingSelfAssessment"></mapping>
						<mapping target="lastReviewDate" value="#flow.lastReviewDate"></mapping>
						<mapping target="nextReviewDate" value="#flow.nextReviewDate"></mapping>
						<mapping target="actions" value="#flow.actions"></mapping>
					</processor>
					<test-case name="CompleteAction" trigger-event="CompleteCompanyRiskActionRequested">
						<input name="arn" value="anove:company:draftsman:risk:myrisk:task" type="String"></input>
						<state>{
  "arn": "anove:company:draftsman:risk:myrisk",
  "reviewPeriodicity": "5D",
  "lastReviewDate": "2023-01-01",
  "nextReviewDate": "2024-05-01",
  "hasPendingSelfAssessment": true,
  "actions": {
    "task": {
      "id": "task",
      "completeDate": "",
      "category": "self"
    }
  }
}</state>
						<expected domain-event="RiskActionCompleted">
							<field value="anove:company:draftsman:risk:myrisk" name="arn" type="String"></field>
							<field value="false" name="hasPendingSelfAssessment" type="Boolean"></field>
							<field value="2024-05-06" name="nextReviewDate" type="String"></field>
						</expected>
					</test-case>
				</command>
				<command name="UpdateAction">
					<trigger source="UpdateCompanyRiskActionRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="actions" value="actions"></mapping>
					</trigger>
					<processor type="validator" id="B0t2wF" condition="flow.entity.version != 0" exception="May not be the initial request"></processor>
					<processor type="validator" id="Dzk6ZZ" condition="len(flow.actions) == 1" exception="Must update exactly 1 action"></processor>
					<processor type="set-variable" id="sMk7ss" name="id" expression='flow.actions[0]["id"]'></processor>
					<processor type="validator" id="j8NH5f" condition="flow.id in flow.entity.actions" exception="Action with id: {flow.id} does not exist"></processor>
					<processor type="validator" id="ujAcLT" condition='"completedDate" not in flow.entity.actions[flow.id] or flow.entity.actions[flow.id]["completedDate"] == ""' exception="Action is already completed, can not update anymore."></processor>
					<processor type="set-variable" id="XdHxkE" name="actions" expression='[flow.entity.actions[flow.id] | {k:v for k,v in flow.actions[0].items() if v != ""}]'></processor>
					<processor type="emit-event" id="uLzP4E" ref="RiskActionUpdated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="actions" value="#flow.actions"></mapping>
					</processor>
					<test-case name="UpdateAction" trigger-event="UpdateCompanyRiskActionRequested">
						<input name="arn" value="myrisk" type="String"></input>
						<input name="actions" type="NestedObject">[
  {
    "description": "post",
    "dueDate": "2024-08-01",
    "notes": "Hello World!",
    "id":"test123"
  }
]</input>
						<state>{
  "arn": "myrisk",
  "version": 2,
  "actions": {
    "test123": {
      "id": "test123",
      "name": "pre",
      "description": "pre",
      "assignee": "j.doe"
    }
  }
}</state>
						<expected domain-event="RiskActionUpdated">
							<field value="myrisk" name="arn" type="String"></field>
						</expected>
						<expected-state pk="myrisk">{
  "arn": "myrisk",
  "version": 3,
  "actions": {
    "test123": {
      "id": "test123",
      "name": "pre",
      "description": "post",
      "assignee": "j.doe",
      "dueDate":"2024-08-01",
      "notes":"Hello World!"
    }
  }
}</expected-state>
					</test-case>
				</command>
				<event-handler on="RiskActionUpdated">
					<nested-mapping source="actions" target="actions" business-key="id">
						<mapping target="name" operand="set" value="name"></mapping>
						<mapping target="description" operand="set" value="description"></mapping>
						<mapping target="assignee" operand="set" value="assignee"></mapping>
						<mapping target="dueDate" operand="set" value="dueDate"></mapping>
						<mapping target="notes" operand="set" value="notes"></mapping>
					</nested-mapping>
				</event-handler>
				<event-handler on="RiskActionCreated">
					<nested-mapping source="actions" target="actions" business-key="id">
						<mapping target="id" operand="set" value="id"></mapping>
						<mapping target="name" operand="set" value="name"></mapping>
						<mapping target="description" operand="set" value="description"></mapping>
						<mapping target="assignee" operand="set" value="assignee"></mapping>
						<mapping target="dueDate" operand="set" value="dueDate"></mapping>
						<mapping target="arn" operand="set" value="arn"></mapping>
						<mapping target="category" operand="set" value="category"></mapping>
					</nested-mapping>
					<mapping target="hasPendingSelfAssessment" operand="set" value="hasPendingSelfAssessment"></mapping>
				</event-handler>
				<event-handler on="RiskUpdated">
					<mapping target="description" operand="set" value="description"></mapping>
					<mapping target="grossLikelihood" operand="set" value="grossLikelihood"></mapping>
					<mapping target="grossImpact" operand="set" value="grossImpact"></mapping>
					<mapping target="apetiteLikelihood" operand="set" value="apetiteLikelihood"></mapping>
					<mapping target="apetiteImpact" operand="set" value="apetiteImpact"></mapping>
					<mapping target="reviewPeriodicity" operand="set" value="reviewPeriodicity"></mapping>
					<mapping target="nextReviewDate" operand="set" value="nextReviewDate"></mapping>
					<nested-mapping source="changeLog" target="changeLog" business-key="timestamp">
						<mapping target="timestamp" operand="set" value="timestamp"></mapping>
						<mapping target="description" operand="set" value="description"></mapping>
						<mapping target="user" operand="set" value="user"></mapping>
					</nested-mapping>
					<nested-mapping source="controlLinks" target="controlLinks" business-key="arn" strategy="replace">
						<mapping target="arn" operand="set" value="arn"></mapping>
						<mapping target="impactOnRisk" operand="set" value="impactOnRisk"></mapping>
					</nested-mapping>
					<nested-mapping source="treatmentPlan" target="treatmentPlan" business-key="type">
						<mapping target="type" operand="set" value="type"></mapping>
						<mapping target="description" operand="set" value="description"></mapping>
					</nested-mapping>
				</event-handler>
				<event-handler on="RiskActionCompleted">
					<mapping target="hasPendingSelfAssessment" operand="set" value="hasPendingSelfAssessment"></mapping>
					<mapping target="lastReviewDate" operand="set" value="lastReviewDate"></mapping>
					<mapping target="nextReviewDate" operand="set" value="nextReviewDate"></mapping>
					<nested-mapping source="actions" target="actions" business-key="id">
						<mapping target="completeDate" operand="set" value="completeDate"></mapping>
					</nested-mapping>
				</event-handler>
				<event-handler on="RiskDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="RiskCreated">
					<mapping target="arn" operand="set" value="arn"></mapping>
					<mapping target="name" operand="set" value="name"></mapping>
					<mapping target="description" operand="set" value="description"></mapping>
					<mapping target="grossLikelihood" operand="set" value="grossLikelihood"></mapping>
					<mapping target="grossImpact" operand="set" value="grossImpact"></mapping>
					<mapping target="apetiteLikelihood" operand="set" value="apetiteLikelihood"></mapping>
					<mapping target="apetiteImpact" operand="set" value="apetiteImpact"></mapping>
					<mapping target="reviewPeriodicity" operand="set" value="reviewPeriodicity"></mapping>
					<mapping target="nextReviewDate" operand="set" value="nextReviewDate"></mapping>
					<nested-mapping source="changeLog" target="changeLog" business-key="timestamp">
						<mapping target="timestamp" operand="set" value="timestamp"></mapping>
						<mapping target="description" operand="set" value="description"></mapping>
						<mapping target="user" operand="set" value="user"></mapping>
					</nested-mapping>
					<nested-mapping source="controlLinks" target="controlLinks" business-key="arn">
						<mapping target="arn" operand="set" value="arn"></mapping>
						<mapping target="impactOnRisk" operand="set" value="impactOnRisk"></mapping>
					</nested-mapping>
					<nested-mapping source="treatmentPlan" target="treatmentPlan" business-key="type">
						<mapping target="type" operand="set" value="type"></mapping>
						<mapping target="description" operand="set" value="description"></mapping>
					</nested-mapping>
				</event-handler>
				<nested-object name="changeLog" business-key="timestamp">
					<field name="timestamp" type="String"></field>
					<field name="description" type="String"></field>
					<field name="user" type="String"></field>
				</nested-object>
				<nested-object name="actions" business-key="id">
					<field name="id" type="String"></field>
					<field name="name" type="String"></field>
					<field name="description" type="String"></field>
					<field name="assignee" type="String"></field>
					<field name="dueDate" type="String"></field>
					<field name="completeDate" type="String"></field>
					<field name="notes" type="String"></field>
					<field name="arn" type="String"></field>
					<field name="category" type="String"></field>
				</nested-object>
				<nested-object name="controlLinks" business-key="newField">
					<field name="arn" type="String"></field>
					<field name="impactOnRisk" type="Int"></field>
				</nested-object>
				<nested-object name="treatmentPlan" business-key="type">
					<field name="type" type="String"></field>
					<field name="description" type="String"></field>
				</nested-object>
			</aggregate>
		</subdomain>
		<subdomain name="ThirdPartyManagement">
			<aggregate name="ThirdParty" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="role" type="String"></field>
				<field name="address" type="String"></field>
				<field name="companyRegistrationNumber" type="String"></field>
				<field name="country" type="String"></field>
				<field name="knownCertification" type="String"></field>
				<field name="isCritical" type="Boolean"></field>
				<field name="isDirectThirdParty" type="Boolean"></field>
				<field name="subprocessors" type="StringList"></field>
				<field name="owner" type="String"></field>
				<command name="UpdateTask">
					<trigger source="UpdateCompanyThirdPartyTaskRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assignee" value="assignee"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="notes" value="notes"></mapping>
					</trigger>
					<processor type="validator" condition="flow.arn in flow.entity.task" id="9taKoa" exception="Task does not exist"></processor>
					<processor condition='flow.entity.task[flow.arn]["completeDate"] == ""' type="validator" id="YfcabM" exception="Task already completed"></processor>
					<processor condition='flow.entity.task[flow.arn]["completeDate"] == ""' type="emit-event" ref="ThirdPartyTaskUpdated" id="DPlbCM">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assignee" value="#flow.assignee"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="notes" value="#flow.notes"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="UpdateTask" trigger-event="UpdateCompanyThirdPartyTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></input>
						<input name="name" type="String" value="Hello World!"></input>
						<input name="description" type="String" value=""></input>
						<input name="assignee" type="String" value=""></input>
						<input name="dueDate" type="String" value=""></input>
						<input name="notes" type="String" value=""></input>
						<state>{
  "arn": "anove:company:qg:thirdparty:aws",
  "task": {
    "anove:company:qg:thirdparty:aws:mytask": {
      "arn": "anove:company:qg:thirdparty:aws:mytask",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</state>
						<expected domain-event="ThirdPartyTaskUpdated" id="mCX91M">
							<field name="name" type="String" value="Hello World!"></field>
							<field name="description" type="String" value=""></field>
							<field name="assignee" type="String" value=""></field>
							<field name="dueDate" type="String" value=""></field>
							<field name="notes" type="String" value=""></field>
							<field name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></field>
						</expected>
						<expected-state pk="anove:company:qg:thirdparty:aws">{
  "arn": "anove:company:qg:thirdparty:aws",
  "task": {
    "anove:company:qg:thirdparty:aws:mytask": {
      "arn": "anove:company:qg:thirdparty:aws:mytask",
      "name": "Hello World!",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="NotFound" trigger-event="UpdateCompanyThirdPartyTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{
  "arn": "anove:company:qg:thirdparty:aws"
}</state>
					</test-case>
					<test-case name="AlreadyCompleted" trigger-event="UpdateCompanyThirdPartyTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{
  "task": {
    "anove:company:qg:thirdparty:aws:mytask": {
      "arn": "anove:company:qg:thirdparty:aws:mytask",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "text",
      "notes": "text"
    }
  }
}</state>
					</test-case>
				</command>
				<command name="CompleteTask">
					<trigger source="CompleteCompanyThirdPartyTaskRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="username" value="username"></mapping>
					</trigger>
					<processor type="validator" condition="flow.arn in flow.entity.task" id="XOCLbc" exception="Task with arn {flow.arn} not found in thirdparty"></processor>
					<processor condition='flow.entity.task[flow.arn]["completeDate"] == ""' type="validator" id="lT1jW2" exception="Task already completed"></processor>
					<processor type="validator" condition='flow.entity.task[flow.arn]["assignee"].endswith(flow.username)' id="aCCQEu" exception="User {flow.username} is not the owner of this task"></processor>
					<processor type="code" code='from datetime import date|LB|flow.completeDate = date.today().strftime("%Y-%m-%d")' id="vyIgIF"></processor>
					<processor type="emit-event" ref="ThirdPartyTaskCompleted" id="WtZCcs">
						<mapping target="completeDate" value="#flow.completeDate"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="CompleteTask" trigger-event="CompleteCompanyThirdPartyTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{
  "task": {
    "anove:company:qg:thirdparty:aws:mytask": {
      "arn": "anove:company:qg:thirdparty:aws:mytask",
      "name": "text",
      "description": "text",
      "assignee": "anove:company:qg:employee:j.doe",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</state>
						<expected domain-event="ThirdPartyTaskCompleted" id="EZZtAc">
							<field name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></field>
						</expected>
						<expected-state pk="businessKey">{
  "arn": "businessKey"
}</expected-state>
					</test-case>
					<test-case name="TaskDoesNotExist" trigger-event="CompleteCompanyThirdPartyTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{}</state>
					</test-case>
					<test-case name="TaskAlreadyCompleted" trigger-event="CompleteCompanyThirdPartyTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></input>
						<input name="username" type="String" value="j.doe"></input>
						<state>{
  "task": {
    "anove:company:qg:thirdparty:aws:mytask": {
      "arn": "anove:company:qg:thirdparty:aws:mytask",
      "name": "text",
      "description": "text",
      "assignee": "anove:company:qg:employee:j.doe",
      "dueDate": "text",
      "completeDate": "text",
      "notes": "text"
    }
  }
}</state>
					</test-case>
					<test-case name="WrongUser" trigger-event="CompleteCompanyThirdPartyTaskRequested" expected-processing-status="error">
						<input name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></input>
						<input name="username" type="String" value="testuser"></input>
						<state>{
  "task": {
    "anove:company:qg:thirdparty:aws:mytask": {
      "arn": "anove:company:qg:thirdparty:aws:mytask",
      "name": "text",
      "description": "text",
      "assignee": "anove:company:qg:employee:j.doe",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</state>
					</test-case>
				</command>
				<command name="Delete">
					<trigger source="DeleteCompanyThirdPartyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="ThirdPartyDeleted" id="TfR15I">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteThirdparty" trigger-event="DeleteCompanyThirdPartyRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="ThirdPartyDeleted" id="Fh9lHn">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="LinkSubprocessor">
					<trigger source="LinkSubprocessorCompanyThirdPartyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="subprocessorArn" value="subprocessorArn"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" exception="Thirdparty does not exist" id="mV0BAB"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="SubprocessorLinkedToThirdParty" id="kntAmv">
						<mapping target="subprocessorArn" value="#flow.subprocessorArn"></mapping>
					</processor>
					<test-case name="LinkSubprocessor" trigger-event="LinkSubprocessorCompanyThirdPartyRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="subprocessorArn" type="String" value="target"></input>
						<expected domain-event="SubprocessorLinkedToThirdParty" id="9Tz17U">
							<field name="subprocessorArn" type="String" value="target"></field>
						</expected>
						<state>{
  "version": 1,
  "arn": "dummy",
  "subprocessors": [
    "first"
  ]
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "subprocessors": [
    "first",
    "target"
  ]
}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateCompanyThirdPartyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="role" value="role"></mapping>
						<mapping target="address" value="address"></mapping>
						<mapping target="companyRegistrationNumber" value="companyRegistrationNumber"></mapping>
						<mapping target="country" value="country"></mapping>
						<mapping target="knownCertification" value="knownCertification"></mapping>
						<mapping target="isCritical" value="isCritical"></mapping>
						<mapping target="isDirectThirdParty" value="isDirectThirdParty"></mapping>
						<mapping target="owner" value="owner"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="gEayid" exception="Thirdparty does not exist"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="ThirdPartyUpdated" id="afesd7">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="role" value="#flow.role"></mapping>
						<mapping target="address" value="#flow.address"></mapping>
						<mapping target="companyRegistrationNumber" value="#flow.companyRegistrationNumber"></mapping>
						<mapping target="country" value="#flow.country"></mapping>
						<mapping target="knownCertification" value="#flow.knownCertification"></mapping>
						<mapping target="isCritical" value="#flow.isCritical"></mapping>
						<mapping target="isDirectThirdParty" value="#flow.isDirectThirdParty"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
					</processor>
					<test-case name="UpdateThirdparty" trigger-event="UpdateCompanyThirdPartyRequested" expected-processing-status="success">
						<input name="arn" type="String" value="text"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="role" type="String" value="text"></input>
						<input name="address" type="String" value="text"></input>
						<input name="companyRegistrationNumber" type="String" value="text"></input>
						<input name="country" type="String" value="text"></input>
						<input name="knownCertification" type="String" value="text"></input>
						<input name="isCritical" type="Boolean" value="false"></input>
						<input name="isDirectThirdParty" type="Boolean" value="false"></input>
						<input name="owner" type="String" value="text"></input>
						<expected domain-event="ThirdPartyUpdated" id="mqV2fl">
							<field name="name" type="String" value="text"></field>
							<field name="description" type="String" value="text"></field>
							<field name="role" type="String" value="text"></field>
							<field name="address" type="String" value="text"></field>
							<field name="companyRegistrationNumber" type="String" value="text"></field>
							<field name="country" type="String" value="text"></field>
							<field name="knownCertification" type="String" value="text"></field>
							<field name="isCritical" type="Boolean" value="false"></field>
							<field name="isDirectThirdParty" type="Boolean" value="false"></field>
							<field name="owner" type="String" value="text"></field>
						</expected>
						<state>{
  "version": 1
}</state>
						<expected-state pk="businessKey">{
  "arn": "businessKey"
}</expected-state>
					</test-case>
				</command>
				<command name="UnlinkSubprocessor">
					<trigger source="UnlinkSubprocessorCompanyThirdPartyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="subprocessorArn" value="subprocessorArn"></mapping>
					</trigger>
					<processor condition="flow.subprocessorArn in flow.entity.subprocessors" type="validator" id="jmucoG" exception="Subprocesor is not linked"></processor>
					<processor condition="" type="emit-event" id="mPrgIZ" ref="SubprocessorUnlinkedFromThirdParty">
						<mapping target="subprocessorArn" value="#flow.subprocessorArn"></mapping>
					</processor>
					<test-case name="UnlinkSubprocessor" trigger-event="UnlinkSubprocessorCompanyThirdPartyRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="subprocessorArn" type="String" value="target"></input>
						<expected domain-event="SubprocessorUnlinkedFromThirdParty" id="tK6ClA">
							<field name="subprocessorArn" type="String" value="target"></field>
						</expected>
						<state>{
  "subprocessors": [
    "first",
    "target"
  ],
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "subprocessors": [
    "first"
  ]
}</expected-state>
					</test-case>
				</command>
				<command name="CreateTask">
					<trigger source="CreateCompanyThirdPartyTaskRequested" key-field="#global.truncateArn(arn,'5')">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assignee" value="assignee"></mapping>
						<mapping target="dueDate" value="dueDate"></mapping>
						<mapping target="notes" value="notes"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" exception="ThirdParty does not exist" id="lrvvad"></processor>
					<processor type="validator" condition="not flow.arn in flow.entity.task" id="H9BwUR" exception="Task with arn {flow.arn} already exists"></processor>
					<processor condition="not flow.arn in flow.entity.task" type="emit-event" id="bIuC1a" ref="ThirdPartyTaskCreated">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assignee" value="#flow.assignee"></mapping>
						<mapping target="dueDate" value="#flow.dueDate"></mapping>
						<mapping target="notes" value="#flow.notes"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="CreateTask" trigger-event="CreateCompanyThirdPartyTaskRequested" expected-processing-status="success">
						<input name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="assignee" type="String" value="text"></input>
						<input name="dueDate" type="String" value="text"></input>
						<input name="notes" type="String" value="text"></input>
						<state>{
  "version": 1,
  "arn": "anove:company:qg:thirdparty:aws"
}</state>
						<expected domain-event="ThirdPartyTaskCreated" id="SJSH8G">
							<field name="name" type="String" value="text"></field>
							<field name="description" type="String" value="text"></field>
							<field name="assignee" type="String" value="text"></field>
							<field name="dueDate" type="String" value="text"></field>
							<field name="notes" type="String" value="text"></field>
							<field name="arn" type="String" value="anove:company:qg:thirdparty:aws:mytask"></field>
						</expected>
						<expected-state pk="anove:company:qg:thirdparty:aws">{
  "arn": "anove:company:qg:thirdparty:aws",
  "task": {
    "anove:company:qg:thirdparty:aws:mytask": {
      "arn": "anove:company:qg:thirdparty:aws:mytask",
      "name": "text",
      "description": "text",
      "assignee": "text",
      "dueDate": "text",
      "completeDate": "",
      "notes": "text"
    }
  }
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="CreateCompanyThirdPartyRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="role" value="role"></mapping>
						<mapping target="address" value="address"></mapping>
						<mapping target="companyRegistrationNumber" value="companyRegistrationNumber"></mapping>
						<mapping target="country" value="country"></mapping>
						<mapping target="knownCertification" value="knownCertification"></mapping>
						<mapping target="isCritical" value="isCritical"></mapping>
						<mapping target="isDirectThirdParty" value="isDirectThirdParty"></mapping>
						<mapping target="owner" value="owner"></mapping>
					</trigger>
					<processor type="emit-event" ref="ThirdPartyCreated" id="VJMfvE">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="role" value="#flow.role"></mapping>
						<mapping target="address" value="#flow.address"></mapping>
						<mapping target="companyRegistrationNumber" value="#flow.companyRegistrationNumber"></mapping>
						<mapping target="country" value="#flow.country"></mapping>
						<mapping target="knownCertification" value="#flow.knownCertification"></mapping>
						<mapping target="isCritical" value="#flow.isCritical"></mapping>
						<mapping target="isDirectThirdParty" value="#flow.isDirectThirdParty"></mapping>
						<mapping target="owner" value="#flow.owner"></mapping>
					</processor>
					<test-case name="CreateThirdParty" trigger-event="CreateCompanyThirdPartyRequested" expected-processing-status="success">
						<input name="arn" type="String" value="text"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="role" type="String" value="text"></input>
						<input name="address" type="String" value="text"></input>
						<input name="companyRegistrationNumber" type="String" value="text"></input>
						<input name="country" type="String" value="text"></input>
						<input name="knownCertification" type="String" value="text"></input>
						<input name="isCritical" type="Boolean" value="false"></input>
						<input name="isDirectThirdParty" type="Boolean" value="false"></input>
						<input name="owner" type="String" value="text"></input>
						<expected domain-event="ThirdPartyCreated" id="yDBunX">
							<field name="arn" type="String" value="text"></field>
							<field name="name" type="String" value="text"></field>
							<field name="description" type="String" value="text"></field>
							<field name="role" type="String" value="text"></field>
							<field name="address" type="String" value="text"></field>
							<field name="companyRegistrationNumber" type="String" value="text"></field>
							<field name="country" type="String" value="text"></field>
							<field name="knownCertification" type="String" value="text"></field>
							<field name="isCritical" type="Boolean" value="false"></field>
							<field name="isDirectThirdParty" type="Boolean" value="false"></field>
							<field name="owner" type="String" value="text"></field>
						</expected>
						<state>{}</state>
						<expected-state pk="businessKey">{
  "arn": "businessKey"
}</expected-state>
					</test-case>
				</command>
				<event-handler on="ThirdPartyTaskCreated" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|target["name"] = event.name|LB|target["description"] = event.description|LB|target["assignee"] = event.assignee|LB|target["dueDate"] = event.dueDate|LB|target["completeDate"] = ""|LB|target["notes"] = event.notes|LB|target["arn"] = event.arn|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="ThirdPartyCreated">
					<mapping target="arn" value="arn" operand="set"></mapping>
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="description" value="description" operand="set"></mapping>
					<mapping target="role" value="role" operand="set"></mapping>
					<mapping target="address" value="address" operand="set"></mapping>
					<mapping target="companyRegistrationNumber" value="companyRegistrationNumber" operand="set"></mapping>
					<mapping target="country" value="country" operand="set"></mapping>
					<mapping target="knownCertification" value="knownCertification" operand="set"></mapping>
					<mapping target="isCritical" value="isCritical" operand="set"></mapping>
					<mapping target="isDirectThirdParty" value="isDirectThirdParty" operand="set"></mapping>
					<mapping target="owner" value="owner" operand="set"></mapping>
				</event-handler>
				<event-handler on="ThirdPartyTaskCompleted" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|target["completeDate"] = event.completeDate|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="SubprocessorLinkedToThirdParty" code="self.subprocessors.append(event.subprocessorArn)"></event-handler>
				<event-handler on="ThirdPartyTaskUpdated" code='target = retrieve_nested_target(event["arn"], self.task, {})|LB|if event.name:|LB|    target["name"] = event.name|LB|if event.description:|LB|    target["description"] = event.description|LB|if event.assignee:|LB|    target["assignee"] = event.assignee|LB|if event.dueDate:|LB|    target["dueDate"] = event.dueDate|LB|if event.notes:|LB|    target["notes"] = event.notes|LB|self.task[event["arn"]] = target'></event-handler>
				<event-handler on="ThirdPartyDeleted" code='self.isDeleted = "soft"'></event-handler>
				<event-handler on="SubprocessorUnlinkedFromThirdParty" code="self.subprocessors.remove(event.subprocessorArn)"></event-handler>
				<event-handler on="ThirdPartyUpdated">
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="description" value="description" operand="set"></mapping>
					<mapping target="role" value="role" operand="set"></mapping>
					<mapping target="address" value="address" operand="set"></mapping>
					<mapping target="companyRegistrationNumber" value="companyRegistrationNumber" operand="set"></mapping>
					<mapping target="country" value="country" operand="set"></mapping>
					<mapping target="knownCertification" value="knownCertification" operand="set"></mapping>
					<mapping target="isCritical" value="isCritical" operand="set"></mapping>
					<mapping target="isDirectThirdParty" value="isDirectThirdParty" operand="set"></mapping>
					<mapping target="owner" value="owner" operand="set"></mapping>
				</event-handler>
				<nested-object name="task" business-key="arn">
					<field name="name" type="String"></field>
					<field name="description" type="String"></field>
					<field name="assignee" type="String"></field>
					<field name="dueDate" type="String"></field>
					<field name="completeDate" type="String"></field>
					<field name="notes" type="String"></field>
					<field name="arn" type="String"></field>
				</nested-object>
			</aggregate>
			<aggregate name="Assessment" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="formBricksId" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteCompanyThirdPartyAssessmentRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="AssessmentDeleted" id="ziRadK">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteAssessment" trigger-event="DeleteCompanyThirdPartyAssessmentRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="AssessmentDeleted" id="9uVVrR">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="Update" reactivate-command="optional" create-command="false">
					<trigger source="UpdateCompanyThirdPartyAssessmentRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="formBricksId" value="formBricksId"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="w3p9Ks" exception="Assessment does not exist"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="AssessmentQuestionaireUpdated" id="MFdpSd">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="formBricksId" value="#flow.formBricksId"></mapping>
					</processor>
					<test-case name="UpdateAssessment" trigger-event="UpdateCompanyThirdPartyAssessmentRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="Hello World!"></input>
						<input name="formBricksId" type="String" value="newId"></input>
						<expected domain-event="AssessmentQuestionaireUpdated" id="aA4GbI">
							<field name="name" type="String" value="Hello World!"></field>
							<field name="formBricksId" type="String" value="newId"></field>
						</expected>
						<state>{
  "arn": "dummy",
  "name": "test",
  "formBricksId": "id",
  "version": 1
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "name": "Hello World!",
  "formBricksId": "newId"
}</expected-state>
					</test-case>
					<test-case name="ReactivateAssessment" trigger-event="UpdateCompanyThirdPartyAssessmentRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="text"></input>
						<input name="formBricksId" type="String" value="text"></input>
						<state>{
  "version": 1,
  "arn": "dummy",
  "isDeleted": "soft"
}</state>
						<expected domain-event="AssessmentQuestionaireUpdated" id="7zJaSP">
							<field name="name" type="String" value="text"></field>
							<field name="formBricksId" type="String" value="text"></field>
						</expected>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "isDeleted": ""
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true" reactivate-command="false">
					<trigger source="CreateCompanyThirdPartyAssessmentRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="formBricksId" value="formBricksId"></mapping>
					</trigger>
					<processor type="emit-event" ref="AssessmentCreated" id="Ae0RaB">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="formBricksId" value="#flow.formBricksId"></mapping>
					</processor>
					<test-case name="CreateAssessment" trigger-event="CreateCompanyThirdPartyAssessmentRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="test"></input>
						<input name="formBricksId" type="String" value="id"></input>
						<expected domain-event="AssessmentCreated" id="rHWMTU">
							<field name="arn" type="String" value="dummy"></field>
							<field name="name" type="String" value="test"></field>
							<field name="formBricksId" type="String" value="id"></field>
						</expected>
						<state>{}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "name": "test",
  "formBricksId": "id"
}</expected-state>
					</test-case>
				</command>
				<event-handler on="AssessmentCreated">
					<mapping target="arn" value="arn" operand="set"></mapping>
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="formBricksId" value="formBricksId" operand="set"></mapping>
				</event-handler>
				<event-handler on="AssessmentQuestionaireUpdated" code='self.isDeleted = ""|LB|self.name = event.name|LB|self.formBricksId = event.formBricksId|LB|'></event-handler>
				<event-handler on="AssessmentDeleted" code='self.isDeleted = "soft"'></event-handler>
			</aggregate>
		</subdomain>
		<subdomain name="Admin">
			<aggregate name="ControlTemplate" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="assessmentPeriodicity" type="String"></field>
				<field name="requirementArns" type="StringList"></field>
				<field name="arn" type="String"></field>
				<field name="templateVersion" type="String"></field>
				<field name="reference" type="String"></field>
				<field name="previousVersion" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteControlTemplateRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="ControlTemplateDeleted" id="KEXeVQ">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteTemplate" trigger-event="DeleteRequirementRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="ControlTemplateDeleted" id="xf0YNh">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "isDeleted": "soft"
}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateControlTemplateRequested" key-field="arn">
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assessmentPeriodicity" value="assessmentPeriodicity"></mapping>
						<mapping target="requirementLinks" value="requirementLinks"></mapping>
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="T6hsuW" exception="Template does not exist"></processor>
					<processor name="templateVersion" type="code" id="7RBR5d" file="lib/TemplateUtils.py" handler="determine_template_reference"></processor>
					<processor type="emit-event" ref="ControlTemplateUpdated" id="M4hzQH">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assessmentPeriodicity" value="#flow.assessmentPeriodicity"></mapping>
						<mapping target="requirementArns" value="#flow.requirementLinks"></mapping>
						<mapping target="templateVersion" value="#flow.templateVersion"></mapping>
						<mapping target="reference" value="#flow.reference"></mapping>
					</processor>
					<test-case name="UpdateTemplate" trigger-event="UpdateControlTemplateRequested" expected-processing-status="success">
						<input name="name" type="String" value=""></input>
						<input name="description" type="String" value="Hello World!"></input>
						<input name="assessmentPeriodicity" type="String" value=""></input>
						<input name="requirementLinks" type="String" value=""></input>
						<input name="arn" type="String" value="controltemplate:myTemplate"></input>
						<expected domain-event="ControlTemplateUpdated" id="vXrMeD">
							<field name="name" type="String" value=""></field>
							<field name="description" type="String" value="Hello World!"></field>
							<field name="assessmentPeriodicity" type="String" value=""></field>
							<field name="requirementArns" type="String" value=""></field>
							<field name="templateVersion" type="String" value="2-PREVIEW"></field>
							<field name="reference" type="String" value="controltemplate:myTemplate:2-PREVIEW"></field>
						</expected>
						<state>{
  "version": 1,
  "templateVersion": "1",
  "arn": "controltemplate:myTemplate"
}</state>
						<expected-state pk="controltemplate:myTemplate">{
  "arn": "controltemplate:myTemplate",
  "description": "Hello World!",
  "reference": "controltemplate:myTemplate:2-PREVIEW",
  "templateVersion": "2-PREVIEW",
  "version": 2
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="CreateControlTemplateRequested" key-field="arn">
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="assessmentPeriodicity" value="assessmentPeriodicity"></mapping>
						<mapping target="requirementLinks" value="requirementLinks"></mapping>
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="set-variable" name="templateVersion" id="cxEEJM" expression='"1-PREVIEW"'></processor>
					<processor name="templateVersion" type="emit-event" ref="ControlTemplateCreated" id="H5Rewk">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="assessmentPeriodicity" value="#flow.assessmentPeriodicity"></mapping>
						<mapping target="requirementArns" value="#flow.requirementLinks"></mapping>
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="templateVersion" value="#flow.templateVersion"></mapping>
					</processor>
					<test-case name="CreateControlTemplate" trigger-event="CreateAdminControlTemplateRequested" expected-processing-status="success">
						<input name="name" type="String" value="myTemplate"></input>
						<input name="description" type="String" value="Hello World!"></input>
						<input name="assessmentPeriodicity" type="String" value="1Y"></input>
						<input name="requirementLinks" type="String" value="my:link"></input>
						<input name="arn" type="String" value="controltemplate:myTemplate"></input>
						<expected domain-event="ControlTemplateCreated" id="W6DjwQ">
							<field name="name" type="String" value="myTemplate"></field>
							<field name="description" type="String" value="Hello World!"></field>
							<field name="assessmentPeriodicity" type="String" value="1Y"></field>
							<field name="requirementArns" type="String" value="my:link"></field>
							<field name="arn" type="String" value="controltemplate:myTemplate"></field>
							<field name="templateVersion" type="String" value="1-PREVIEW"></field>
						</expected>
						<state>{}</state>
						<expected-state pk="controltemplate:myTemplate">{
  "arn": "controltemplate:myTemplate",
  "version": 1,
  "name": "myTemplate",
  "description": "Hello World!",
  "assessmentPeriodicity": "1Y",
  "templateVersion": "1-PREVIEW"
}</expected-state>
					</test-case>
				</command>
				<command name="Release">
					<trigger source="ReleaseControlTemplateRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="validator" condition='flow.entity.templateVersion.endswith("-PREVIEW")' id="QLn0wx" exception="There are no changes to be released"></processor>
					<processor condition='flow.entity.templateVersion.endswith("-PREVIEW")' type="code" id="2NnGtv" file="lib/TemplateUtils.py" handler="release_template"></processor>
					<processor type="emit-event" id="SFc7MT" ref="ControlTemplateReleased">
						<mapping target="templateVersion" value="#flow.templateVersion"></mapping>
						<mapping target="reference" value="#flow.reference"></mapping>
						<mapping target="previousVersion" value="#flow.previousVersion"></mapping>
					</processor>
					<test-case name="ReleaseTemplate" trigger-event="ReleaseControlTemplateRequested" expected-processing-status="success">
						<input name="arn" type="String" value="controltemplate:myTemplate"></input>
						<expected domain-event="ControlTemplateReleased" id="Eh3jDn">
							<field name="templateVersion" type="String" value="1"></field>
							<field name="reference" type="String" value="controltemplate:myTemplate:1"></field>
							<field name="previousVersion" type="String" value="controltemplate:myTemplate:1-PREVIEW"></field>
						</expected>
						<state>{
  "arn": "controltemplate:myTemplate",
  "templateVersion": "1-PREVIEW",
  "reference": "controltemplate:myTemplate:1-PREVIEW"
}</state>
						<expected-state pk="controltemplate:myTemplate">{
  "arn": "controltemplate:myTemplate",
  "templateVersion": "1",
  "reference": "controltemplate:myTemplate:1",
  "previousVersion": "controltemplate:myTemplate:1-PREVIEW"
}</expected-state>
					</test-case>
					<test-case name="NotReleasable" trigger-event="ReleaseControlTemplateRequested" expected-processing-status="error">
						<input name="arn" type="String" value="controltemplate:myTemplate"></input>
						<state>{
  "arn": "controltemplate:myTemplate",
  "templateVersion": "1"
}</state>
					</test-case>
				</command>
				<event-handler on="ControlTemplateUpdated" code='|LB|if event.name:|LB|    self.name = event.name|LB|if event.description:|LB|    self.description = event.description|LB|if event.assessmentPeriodicity:|LB|    self.assessmentPeriodicity = event.assessmentPeriodicity|LB|if event.requirementArns: |LB|    self.requirementArns = event.requirementArns.split(";")|LB|self.templateVersion = event.templateVersion|LB|self.reference = event.reference|LB|'></event-handler>
				<event-handler on="ControlTemplateDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="ControlTemplateReleased">
					<mapping target="templateVersion" value="templateVersion" operand="set"></mapping>
					<mapping target="reference" value="reference" operand="set"></mapping>
					<mapping target="previousVersion" value="previousVersion" operand="set"></mapping>
				</event-handler>
				<event-handler on="ControlTemplateCreated" code='#self.isDeleted = "soft/hard"|LB|self.name = event.name|LB|self.description = event.description|LB|self.assessmentPeriodicity = event.assessmentPeriodicity|LB|self.requirementArns = event.requirementArns.split(";")|LB|self.arn = event.arn|LB|self.templateVersion = event.templateVersion|LB|self.reference = event.arn + ":" + event.templateVersion'></event-handler>
			</aggregate>
			<aggregate name="User" business-key="username" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="username" type="String"></field>
				<field name="firstName" type="String"></field>
				<field name="lastName" type="String"></field>
				<field name="active" type="Boolean"></field>
				<field name="email" type="String"></field>
				<command name="CreateFirstCompanyUser">
					<trigger source="CompanyCreated" key-field="user">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="user" value="user"></mapping>
					</trigger>
					<processor type="emit-event" id="YLK80V" ref="CompanyAdministratorCreated">
						<mapping target="username" value="#flow.user"></mapping>
						<mapping target="companyArn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="CreateNewUser" trigger-event="CompanyCreated">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="name" value="dummy" type="String"></input>
						<input name="description" value="dummy" type="String"></input>
						<input name="companySize" value="2" type="Int"></input>
						<input name="revenue" value="dummy" type="String"></input>
						<input name="industry" value="dummy" type="String"></input>
						<input name="user" value="j.doe" type="String"></input>
						<expected domain-event="CompanyAdministratorCreated">
							<field value="j.doe" name="username" type="String"></field>
							<field value="company:draftsman" name="companyArn" type="String"></field>
						</expected>
						<expected-state pk="j.doe">{
  "username": "j.doe",
  "companies": {
    "company:draftsman": {
      "arn": "company:draftsman",
      "employeeArn": "company:draftsman:employee:j.doe"
    }
  }
}</expected-state>
					</test-case>
					<test-case name="AddCompanyToUser" trigger-event="CompanyCreated">
						<input name="arn" value="company:draftsman" type="String"></input>
						<input name="name" value="dummy" type="String"></input>
						<input name="description" value="dummy" type="String"></input>
						<input name="companySize" value="2" type="Int"></input>
						<input name="revenue" value="dummy" type="String"></input>
						<input name="industry" value="dummy" type="String"></input>
						<input name="user" value="j.doe" type="String"></input>
						<expected domain-event="CompanyAdministratorCreated">
							<field value="j.doe" name="username" type="String"></field>
							<field value="company:draftsman" name="companyArn" type="String"></field>
						</expected>
						<expected-state pk="j.doe">{
  "username": "j.doe",
  "companies": {
    "company:draftsman": {
      "arn": "company:draftsman",
      "employeeArn": "company:draftsman:employee:j.doe"
    },
      "company:anove": {
      "arn": "company:anove"
    }
  }
}</expected-state>
						<state>{
  "username": "j.doe",
  "companies": {
    "company:anove": {
      "arn": "company:anove"
    }
  }
}</state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateUserRequested" key-field="username">
						<mapping target="firstName" value="firstName"></mapping>
						<mapping target="lastName" value="lastName"></mapping>
						<mapping target="email" value="email"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.active" exception="User is not activated yet" id="faeXW6"></processor>
					<processor condition="flow.entity.active" type="emit-event" ref="UserUpdated" id="uOcPab">
						<mapping target="firstName" value="#flow.firstName"></mapping>
						<mapping target="lastName" value="#flow.lastName"></mapping>
						<mapping target="email" value="#flow.email"></mapping>
					</processor>
					<test-case name="UpdateUser" trigger-event="UpdateUserRequested" expected-processing-status="success">
						<input name="username" type="String" value="j.doe"></input>
						<input name="firstName" type="String" value="John"></input>
						<input name="lastName" type="String" value="Doe"></input>
						<input name="email" type="String" value="j.doe@example.com"></input>
						<expected domain-event="UserUpdated" id="UsUxVu">
							<field name="firstName" type="String" value="John"></field>
							<field name="lastName" type="String" value="Doe"></field>
							<field name="email" type="String" value="j.doe@example.com"></field>
						</expected>
						<state>{
  "username": "j.doe",
  "active": true
}</state>
						<expected-state pk="j.doe">{
  "username": "j.doe",
  "firstName": "John",
  "lastName": "Doe",
  "email": "j.doe@example.com"
}</expected-state>
					</test-case>
					<test-case name="UpdateNonActivatedUser" trigger-event="UpdateUserRequested" expected-processing-status="error">
						<input name="username" type="String" value="unknown"></input>
						<input name="firstName" type="String" value="John"></input>
						<input name="lastName" type="String" value="Doe"></input>
						<input name="email" type="String" value="j.doe@example.com"></input>
						<state>{}</state>
					</test-case>
				</command>
				<command name="Activate">
					<trigger source="ActivateUserRequested" key-field="email">
						<mapping target="username" value="username"></mapping>
						<mapping target="firstName" value="firstName"></mapping>
						<mapping target="lastName" value="lastName"></mapping>
						<mapping target="email" value="email"></mapping>
					</trigger>
					<processor type="set-variable" id="ZVMw4u" name="active" expression="True"></processor>
					<processor type="code" id="PjQOzT" file="" handler="" code='companies = list(flow.entity.companies.keys())|LB|flow.companyArn = companies[0] if len(companies) != 0 else ""'></processor>
					<processor type="update-key" id="XbL8BP" key="#flow.username"></processor>
					<processor type="emit-event" id="4W0IuN" ref="UserActivated">
						<mapping target="username" value="#flow.username"></mapping>
						<mapping target="firstName" value="#flow.firstName"></mapping>
						<mapping target="lastName" value="#flow.lastName"></mapping>
						<mapping target="active" value="#flow.active"></mapping>
						<mapping target="email" value="#flow.email"></mapping>
						<mapping target="companyArn" value="#flow.companyArn"></mapping>
					</processor>
					<test-case name="ActivateUser" trigger-event="ActivateUserRequested" expected-processing-status="success">
						<input name="username" value="j.doe" type="String"></input>
						<input name="firstName" value="John" type="String"></input>
						<input name="lastName" value="Doe" type="String"></input>
						<input name="email" value="j.doe@example.com" type="String"></input>
						<state>{
  "username": "j.doe@example.com",
  "firstName": "",
  "lastName": "",
  "active": false,
  "companies": {
    "company:draftsman": {
      "arn": "company:draftsman",
      "employeeArn": "company:draftsman:employee:j.doe@example.com"
    }
  }
}</state>
						<expected domain-event="UserActivated" id="I6IHu7">
							<field value="j.doe" name="username" type="String"></field>
							<field value="John" name="firstName" type="String"></field>
							<field value="Doe" name="lastName" type="String"></field>
							<field value="true" name="active" type="Boolean"></field>
							<field value="j.doe@example.com" name="email" type="String"></field>
							<field value="company:draftsman" name="companyArn" type="String"></field>
						</expected>
						<expected-state pk="j.doe">{
  "username": "j.doe",
  "firstName": "John",
  "lastName": "Doe",
  "active": true,
  "companies": {
    "company:draftsman": {
      "arn": "company:draftsman",
      "employeeArn": "company:draftsman:employee:j.doe"
    }
  }
}</expected-state>
					</test-case>
				</command>
				<command name="LinkCompanyToUser">
					<trigger source="RolesUpdated" key-field="username">
						<mapping target="employeeArn" value="employeeArn"></mapping>
						<mapping target="roles" value="roles"></mapping>
						<mapping target="username" value="username"></mapping>
					</trigger>
					<processor type="set-variable" id="HRnMzH" name="active" expression="flow.entity.active"></processor>
					<processor type="code" id="I2C5M7" file="" handler="" code='flow.companies = []|LB|for arn,company in flow.entity.companies.items():|LB|    flow.companies.append(company)|LB||LB|flow.arn = ":".join(flow.employeeArn.split(":")[:3])|LB|if not flow.arn in flow.entity.companies.keys(): |LB|    flow.companies.append({|LB|        "arn": flow.arn,|LB|        "employeeArn": flow.employeeArn|LB|    })'></processor>
					<processor type="emit-event" id="M3Zqjo" ref="UserAddedToCompany">
						<mapping target="username" value="#flow.username"></mapping>
						<mapping target="active" value="#flow.active"></mapping>
						<mapping target="companies" value="#flow.companies"></mapping>
					</processor>
					<test-case name="LinkCompanyToUser" trigger-event="RolesUpdated" expected-processing-status="success">
						<input name="employeeArn" value="anove:company:tracepaper:employee:j.doe" type="String"></input>
						<input name="roles" value="administrator" type="String"></input>
						<input name="username" value="j.doe" type="String"></input>
						<expected domain-event="UserAddedToCompany" id="mfM609">
							<field value="j.doe" name="username" type="String"></field>
							<field value="true" name="active" type="Boolean"></field>
						</expected>
						<state>{
  "username": "j.doe",
  "active": true,
  "companies": {
    "anove:company:draftsman": {
      "arn": "anove:company:draftsman",
      "employeeArn": "anove:company:draftsman:employee:j.doe"
    }
  }
}</state>
						<expected-state pk="j.doe">{
  "username": "j.doe",
  "active": true,
  "companies": {
    "anove:company:draftsman": {
      "arn": "anove:company:draftsman",
      "employeeArn": "anove:company:draftsman:employee:j.doe"
    },
    "anove:company:tracepaper": {
      "arn": "anove:company:tracepaper",
      "employeeArn": "anove:company:tracepaper:employee:j.doe"
    }
  }
}</expected-state>
					</test-case>
				</command>
				<event-handler on="CompanyAdministratorCreated" code='self.username = event.username|LB|self.active = True|LB|self.companies[event.companyArn] = {|LB|    "arn": event.companyArn,|LB|    "employeeArn": event.companyArn + ":employee:" + event.username|LB|}|LB|'></event-handler>
				<event-handler on="UserUpdated">
					<mapping target="firstName" value="firstName" operand="set"></mapping>
					<mapping target="lastName" value="lastName" operand="set"></mapping>
					<mapping target="email" value="email" operand="set"></mapping>
				</event-handler>
				<event-handler on="UserActivated" code='self.username = event.username|LB|self.firstName = event.firstName|LB|self.lastName = event.lastName|LB|self.active = event.active|LB|self.email = event.email|LB|self.companies = {key:{|LB|    "arn": key,|LB|    "employeeArn": value["employeeArn"].replace(event.email,event.username)|LB|} for key,value in self.companies.items()}|LB|'></event-handler>
				<event-handler on="UserAddedToCompany">
					<mapping target="username" operand="set" value="username"></mapping>
					<mapping target="active" operand="set" value="active"></mapping>
					<nested-mapping source="companies" target="companies" business-key="arn">
						<mapping target="arn" operand="set" value="arn"></mapping>
						<mapping target="employeeArn" operand="set" value="employeeArn"></mapping>
					</nested-mapping>
				</event-handler>
				<nested-object name="companies" business-key="arn">
					<field name="arn" type="String"></field>
					<field name="employeeArn" type="String"></field>
				</nested-object>
			</aggregate>
			<aggregate name="RiskTemplate" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="grossLikelihood" type="Int"></field>
				<field name="grossImpact" type="Int"></field>
				<field name="reviewPeriodicity" type="String"></field>
				<field name="templateVersion" type="String"></field>
				<field name="reference" type="String"></field>
				<field name="previousVersion" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteRiskTemplateRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="RiskTemplateDeleted" id="h1GhSz">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="Delete" trigger-event="DeleteRiskTemplateRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="RiskTemplateDeleted" id="YCjWhB">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateRiskTemplateRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="grossLikelihood" value="grossLikelihood"></mapping>
						<mapping target="grossImpact" value="grossImpact"></mapping>
						<mapping target="reviewPeriodicity" value="reviewPeriodicity"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="NWi4FY" exception="Template does not exist"></processor>
					<processor type="code" file="lib/TemplateUtils.py" handler="determine_template_reference" id="hhtgYG"></processor>
					<processor type="emit-event" id="a0oqLC" ref="RiskTemplateUpdated">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="grossLikelihood" value="#flow.grossLikelihood"></mapping>
						<mapping target="grossImpact" value="#flow.grossImpact"></mapping>
						<mapping target="reviewPeriodicity" value="#flow.reviewPeriodicity"></mapping>
						<mapping target="templateVersion" value="#flow.templateVersion"></mapping>
						<mapping target="reference" value="#flow.reference"></mapping>
					</processor>
					<test-case name="UpdateRiskTemplate" trigger-event="UpdateRiskTemplateRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="Hello"></input>
						<input name="description" type="String" value=""></input>
						<input name="grossLikelihood" type="Int" value="0"></input>
						<input name="grossImpact" type="Int" value="0"></input>
						<input name="reviewPeriodicity" type="String" value=""></input>
						<expected domain-event="RiskTemplateUpdated" id="bw4sJj">
							<field name="name" type="String" value="Hello"></field>
							<field name="description" type="String" value=""></field>
							<field name="grossLikelihood" type="Int" value="0"></field>
							<field name="grossImpact" type="Int" value="0"></field>
							<field name="reviewPeriodicity" type="String" value=""></field>
							<field name="templateVersion" type="String" value="2-PREVIEW"></field>
							<field name="reference" type="String" value="dummy:2-PREVIEW"></field>
						</expected>
						<state>{
  "arn": "dummy",
  "templateVersion": "1",
  "version": 1,
  "grossLikelihood": 2,
  "grossImpact": 2
}</state>
						<expected-state pk="dummy">{"arn":"dummy","name":"Hello","grossLikelihood":2,"grossImpact":2,"reference":"dummy:2-PREVIEW"}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="CreateRiskTemplateRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="grossLikelihood" value="grossLikelihood"></mapping>
						<mapping target="grossImpact" value="grossImpact"></mapping>
						<mapping target="reviewPeriodicity" value="reviewPeriodicity"></mapping>
					</trigger>
					<processor type="set-variable" name="templateVersion" id="onR4Aj" expression='"1-PREVIEW"'></processor>
					<processor type="emit-event" id="ZKYs6Q" ref="RiskTemplateCreated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="grossLikelihood" value="#flow.grossLikelihood"></mapping>
						<mapping target="grossImpact" value="#flow.grossImpact"></mapping>
						<mapping target="reviewPeriodicity" value="#flow.reviewPeriodicity"></mapping>
						<mapping target="templateVersion" value="#flow.templateVersion"></mapping>
					</processor>
					<test-case name="CreateRiskTemplate" trigger-event="CreateRiskTemplateRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="Test 123"></input>
						<input name="description" type="String" value="Hello"></input>
						<input name="grossLikelihood" type="Int" value="1"></input>
						<input name="grossImpact" type="Int" value="1"></input>
						<input name="reviewPeriodicity" type="String" value="3M"></input>
						<expected domain-event="RiskTemplateCreated" id="rOxuBw">
							<field name="arn" type="String" value="dummy"></field>
							<field name="name" type="String" value="Test 123"></field>
							<field name="description" type="String" value="Hello"></field>
							<field name="grossLikelihood" type="Int" value="1"></field>
							<field name="grossImpact" type="Int" value="1"></field>
							<field name="reviewPeriodicity" type="String" value="3M"></field>
							<field name="templateVersion" type="String" value="1-PREVIEW"></field>
						</expected>
						<state>{}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "reference": "dummy:1-PREVIEW"
}</expected-state>
					</test-case>
				</command>
				<command name="Release">
					<trigger source="ReleaseRiskTemplateRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="validator" condition='flow.entity.templateVersion.endswith("-PREVIEW")' exception="There are no changes to be released" id="kfQ7aU"></processor>
					<processor condition='flow.entity.templateVersion.endswith("-PREVIEW")' type="code" file="lib/TemplateUtils.py" handler="release_template" id="IYDERG"></processor>
					<processor type="emit-event" ref="RiskTemplateReleased" id="ITy3TD">
						<mapping target="templateVersion" value="#flow.templateVersion"></mapping>
						<mapping target="reference" value="#flow.reference"></mapping>
						<mapping target="previousVersion" value="#flow.previousVersion"></mapping>
					</processor>
					<test-case name="ReleaseTemplate" trigger-event="ReleaseRiskTemplateRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<state>{
  "arn": "dummy",
  "templateVersion": "3-PREVIEW",
  "reference": "dummy:3-PREVIEW"
}</state>
						<expected domain-event="RiskTemplateReleased" id="MxLyiQ">
							<field name="templateVersion" type="String" value="3"></field>
							<field name="reference" type="String" value="dummy:3"></field>
							<field name="previousVersion" type="String" value="dummy:3-PREVIEW"></field>
						</expected>
						<expected-state pk="businessKey">{
  "arn": "businessKey"
}</expected-state>
					</test-case>
					<test-case name="NoChanges" trigger-event="ReleaseRiskTemplateRequested" expected-processing-status="error">
						<input name="arn" type="String" value="dummy"></input>
						<state>{
  "arn": "dummy",
  "templateVersion": "4"
}</state>
					</test-case>
				</command>
				<event-handler on="RiskTemplateDeleted" code='self.isDeleted = "soft"'></event-handler>
				<event-handler on="RiskTemplateUpdated" code="if event.name:|LB|    self.name = event.name|LB|if event.description:|LB|    self.description = event.description|LB|if event.grossLikelihood:|LB|    self.grossLikelihood = event.grossLikelihood|LB|if event.grossImpact:|LB|    self.grossImpact = event.grossImpact|LB|if event.reviewPeriodicity:|LB|    self.reviewPeriodicity = event.reviewPeriodicity|LB|self.templateVersion = event.templateVersion|LB|self.reference = event.reference|LB|"></event-handler>
				<event-handler on="RiskTemplateCreated" code='self.arn = event.arn|LB|self.name = event.name|LB|self.description = event.description|LB|self.grossLikelihood = event.grossLikelihood|LB|self.grossImpact = event.grossImpact|LB|self.reviewPeriodicity = event.reviewPeriodicity|LB|self.templateVersion = event.templateVersion|LB|self.reference = event.arn + ":" + event.templateVersion |LB|'></event-handler>
				<event-handler on="RiskTemplateReleased">
					<mapping target="templateVersion" value="templateVersion" operand="set"></mapping>
					<mapping target="reference" value="reference" operand="set"></mapping>
					<mapping target="previousVersion" value="previousVersion" operand="set"></mapping>
				</event-handler>
			</aggregate>
			<aggregate name="ThirdPartyTemplate" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="address" type="String"></field>
				<field name="companyRegistrationNumber" type="String"></field>
				<field name="country" type="String"></field>
				<field name="knownCertification" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteThirdPartyTemplateRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="ThirdPartyTemplateDeleted" id="0V8KHr">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="Delete" trigger-event="DeleteThirdPartyTemplateRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="ThirdPartyTemplateDeleted" id="IbBSCk">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateThirdPartyTemplateRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="address" value="address"></mapping>
						<mapping target="companyRegistrationNumber" value="companyRegistrationNumber"></mapping>
						<mapping target="country" value="country"></mapping>
						<mapping target="knownCertification" value="knownCertification"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="pXpnSI" exception="Template does not exist"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="ThirdPartyTemplateUpdated" id="x53pql">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="address" value="#flow.address"></mapping>
						<mapping target="companyRegistrationNumber" value="#flow.companyRegistrationNumber"></mapping>
						<mapping target="country" value="#flow.country"></mapping>
						<mapping target="knownCertification" value="#flow.knownCertification"></mapping>
					</processor>
					<test-case name="Update" trigger-event="UpdateThirdPartyTemplateRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="-"></input>
						<input name="description" type="String" value="-"></input>
						<input name="address" type="String" value="-"></input>
						<input name="companyRegistrationNumber" type="String" value="-"></input>
						<input name="country" type="String" value="-"></input>
						<input name="knownCertification" type="String" value="-"></input>
						<expected domain-event="ThirdPartyTemplateUpdated" id="CRpl0z">
							<field name="name" type="String" value="-"></field>
							<field name="description" type="String" value="-"></field>
							<field name="address" type="String" value="-"></field>
							<field name="companyRegistrationNumber" type="String" value="-"></field>
							<field name="country" type="String" value="-"></field>
							<field name="knownCertification" type="String" value="-"></field>
						</expected>
						<state>{
  "arn": "dummy",
  "name": "text",
  "description": "text",
  "address": "text",
  "companyRegistrationNumber": "text",
  "country": "text",
  "knownCertification": "text",
  "version": 1
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "name": "-",
  "description": "-",
  "address": "-",
  "companyRegistrationNumber": "-",
  "country": "-",
  "knownCertification": "-"
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true" reactivate-command="false">
					<trigger source="CreateThirdPartyTemplateRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="address" value="address"></mapping>
						<mapping target="companyRegistrationNumber" value="companyRegistrationNumber"></mapping>
						<mapping target="country" value="country"></mapping>
						<mapping target="knownCertification" value="knownCertification"></mapping>
					</trigger>
					<processor type="emit-event" ref="ThirdPartyTemplateCreated" id="nstu2l">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="address" value="#flow.address"></mapping>
						<mapping target="companyRegistrationNumber" value="#flow.companyRegistrationNumber"></mapping>
						<mapping target="country" value="#flow.country"></mapping>
						<mapping target="knownCertification" value="#flow.knownCertification"></mapping>
					</processor>
					<test-case name="Create" trigger-event="CreateThirdPartyTemplateRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="address" type="String" value="text"></input>
						<input name="companyRegistrationNumber" type="String" value="text"></input>
						<input name="country" type="String" value="text"></input>
						<input name="knownCertification" type="String" value="text"></input>
						<expected domain-event="ThirdPartyTemplateCreated" id="TLwl9X">
							<field name="arn" type="String" value="dummy"></field>
							<field name="name" type="String" value="text"></field>
							<field name="description" type="String" value="text"></field>
							<field name="address" type="String" value="text"></field>
							<field name="companyRegistrationNumber" type="String" value="text"></field>
							<field name="country" type="String" value="text"></field>
							<field name="knownCertification" type="String" value="text"></field>
						</expected>
						<state>{}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "name": "text",
  "description": "text",
  "address": "text",
  "companyRegistrationNumber": "text",
  "country": "text",
  "knownCertification": "text",
  "version": 1
}</expected-state>
					</test-case>
				</command>
				<event-handler on="ThirdPartyTemplateCreated">
					<mapping target="arn" value="arn" operand="set"></mapping>
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="description" value="description" operand="set"></mapping>
					<mapping target="address" value="address" operand="set"></mapping>
					<mapping target="companyRegistrationNumber" value="companyRegistrationNumber" operand="set"></mapping>
					<mapping target="country" value="country" operand="set"></mapping>
					<mapping target="knownCertification" value="knownCertification" operand="set"></mapping>
				</event-handler>
				<event-handler on="ThirdPartyTemplateDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="ThirdPartyTemplateUpdated">
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="description" value="description" operand="set"></mapping>
					<mapping target="address" value="address" operand="set"></mapping>
					<mapping target="companyRegistrationNumber" value="companyRegistrationNumber" operand="set"></mapping>
					<mapping target="country" value="country" operand="set"></mapping>
					<mapping target="knownCertification" value="knownCertification" operand="set"></mapping>
				</event-handler>
			</aggregate>
			<aggregate name="ControlFramework" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="description" type="String"></field>
				<field name="name" type="String"></field>
				<field name="category" type="String"></field>
				<field name="edition" type="String"></field>
				<field name="unit" type="String"></field>
				<field name="acronym" type="String"></field>
				<field name="active" type="Boolean"></field>
				<command name="Delete">
					<trigger source="DeleteControlFrameworkRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" exception="Controlframework does not exist" id="gmAUBW"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="ControlFrameworkDeleted" id="0sL80u">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteControlFramework" trigger-event="DeleteControlFrameworkRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummyarn"></input>
						<expected domain-event="ControlFrameworkDeleted" id="1LFaqi">
							<field name="arn" type="String" value="dummyarn"></field>
						</expected>
						<state>{
  "arn": "dummyarn",
  "version": 1
}</state>
						<expected-state pk="dummyarn">{
  "arn": "dummyarn",
  "isDeleted": "soft"
}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateControlFrameworkRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="category" value="category"></mapping>
						<mapping target="edition" value="edition"></mapping>
						<mapping target="unit" value="unit"></mapping>
						<mapping target="acronym" value="acronym"></mapping>
						<mapping target="active" value="active"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" exception="ControlFramework does not exist" id="JiVIKU"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" id="aDCxTM" ref="ControlFrameworkUpdated">
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="category" value="#flow.category"></mapping>
						<mapping target="edition" value="#flow.edition"></mapping>
						<mapping target="unit" value="#flow.unit"></mapping>
						<mapping target="acronym" value="#flow.acronym"></mapping>
						<mapping target="active" value="#flow.active"></mapping>
					</processor>
					<test-case name="UpdateControlFramework" trigger-event="UpdateControlFrameworkRequested" expected-processing-status="success">
						<input name="arn" type="String" value="myarn"></input>
						<input name="description" type="String" value=""></input>
						<input name="name" type="String" value="Hello"></input>
						<input name="category" type="String" value=""></input>
						<input name="edition" type="String" value=""></input>
						<input name="unit" type="String" value=""></input>
						<input name="acronym" type="String" value=""></input>
						<input name="active" type="Boolean" value="true"></input>
						<expected domain-event="ControlFrameworkUpdated" id="rwnPPw">
							<field name="description" type="String" value=""></field>
							<field name="name" type="String" value="Hello"></field>
							<field name="category" type="String" value=""></field>
							<field name="edition" type="String" value=""></field>
							<field name="unit" type="String" value=""></field>
							<field name="acronym" type="String" value=""></field>
							<field name="active" type="Boolean" value="true"></field>
						</expected>
						<state>{
  "version": 1,
  "arn": "myarn"
}</state>
						<expected-state pk="myarn">{
  "arn": "myarn",
  "name": "Hello"
}</expected-state>
					</test-case>
					<test-case name="TryToUpdateNonExisting" trigger-event="UpdateControlFrameworkRequested" expected-processing-status="error">
						<input name="arn" type="String" value="text"></input>
						<input name="description" type="String" value="text"></input>
						<input name="name" type="String" value="text"></input>
						<input name="category" type="String" value="text"></input>
						<input name="edition" type="String" value="text"></input>
						<input name="unit" type="String" value="text"></input>
						<input name="acronym" type="String" value="text"></input>
						<input name="active" type="Boolean" value="false"></input>
						<state>{}</state>
					</test-case>
				</command>
				<command name="Create" create-command="true" reactivate-command="false">
					<trigger source="AddControlFrameworkRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="category" value="category"></mapping>
						<mapping target="edition" value="edition"></mapping>
						<mapping target="unit" value="unit"></mapping>
						<mapping target="acronym" value="acronym"></mapping>
						<mapping target="active" value="active"></mapping>
					</trigger>
					<processor type="emit-event" id="SMJwSw" ref="ControlFrameworkCreated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="category" value="#flow.category"></mapping>
						<mapping target="edition" value="#flow.edition"></mapping>
						<mapping target="unit" value="#flow.unit"></mapping>
						<mapping target="acronym" value="#flow.acronym"></mapping>
						<mapping target="active" value="#flow.active"></mapping>
					</processor>
					<processor type="validator" id="RUrSia" condition='flow.name != ""' exception="Name may not be empty"></processor>
					<test-case name="AddControlFramework" trigger-event="AddControlFrameworkRequested" expected-processing-status="success">
						<input name="arn" value="controlframework:mycontrol" type="String"></input>
						<input name="description" value="n.v.t." type="String"></input>
						<input name="name" value="my control" type="String"></input>
						<input name="category" value="framework" type="String"></input>
						<input name="edition" value="1.0" type="String"></input>
						<input name="unit" value="n.v.t." type="String"></input>
						<input name="acronym" value="NVT" type="String"></input>
						<input name="active" value="True" type="Boolean"></input>
						<expected domain-event="ControlFrameworkCreated" id="sWv0o6">
							<field value="controlframework:mycontrol" name="arn" type="String"></field>
						</expected>
						<expected-state pk="controlframework:mycontrol">{
  "arn": "controlframework:mycontrol",
  "description": "n.v.t.",
  "name": "my control",
  "category": "framework",
  "edition": "1.0",
  "unit": "n.v.t.",
  "acronym": "NVT",
  "active": true
}</expected-state>
						<state>{}</state>
					</test-case>
					<test-case name="AddDuplicateControlFramework" trigger-event="AddControlFrameworkRequested" expected-processing-status="error">
						<state>{
  "arn": "controlframework:mycontrol",
  "version": 1
}</state>
						<input name="arn" value="controlframework:mycontrol" type="String"></input>
						<input name="description" value="n.v.t." type="String"></input>
						<input name="name" value="my control" type="String"></input>
						<input name="category" value="framework" type="String"></input>
						<input name="edition" value="1.0" type="String"></input>
						<input name="unit" value="n.v.t." type="String"></input>
						<input name="acronym" value="NVT" type="String"></input>
						<input name="active" value="True" type="Boolean"></input>
						<input name="requirements" type="NestedObject">[
  {
    "name": "myreq",
    "description": "Hello World"
  }
]</input>
					</test-case>
				</command>
				<event-handler on="ControlFrameworkCreated">
					<mapping target="arn" value="arn" operand="set"></mapping>
					<mapping target="description" value="description" operand="set"></mapping>
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="category" value="category" operand="set"></mapping>
					<mapping target="edition" value="edition" operand="set"></mapping>
					<mapping target="unit" value="unit" operand="set"></mapping>
					<mapping target="acronym" value="acronym" operand="set"></mapping>
					<mapping target="active" value="active" operand="set"></mapping>
				</event-handler>
				<event-handler on="ControlFrameworkUpdated" code="|LB|if event.description:|LB|    self.description = event.description|LB|if event.name:|LB|    self.name = event.name|LB|if event.category:|LB|    self.category = event.category|LB|if event.edition:|LB|    self.edition = event.edition|LB|if event.unit:|LB|    self.unit = event.unit|LB|if event.acronym:|LB|    self.acronym = event.acronym|LB|self.active = event.active|LB|"></event-handler>
				<event-handler on="ControlFrameworkDeleted" code='self.isDeleted = "soft"'></event-handler>
			</aggregate>
			<aggregate name="Tenant" business-key="reference" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="name" type="String"></field>
				<field name="css" type="String"></field>
				<field name="reference" type="String"></field>
				<field name="logoPath" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteTenantRequested" key-field="key">
						<mapping target="reference" value="key"></mapping>
					</trigger>
					<processor type="emit-event" ref="TenantDeleted" id="CVS2G0">
						<mapping target="key" value="#flow.reference"></mapping>
					</processor>
					<test-case name="DeleteTenant" trigger-event="DeleteTenantRequested" expected-processing-status="success">
						<input name="key" type="String" value="anove"></input>
						<expected domain-event="TenantDeleted" id="vbUCvi">
							<field name="key" type="String" value="anove"></field>
						</expected>
						<state>{
  "reference": "anove"
}</state>
						<expected-state pk="anove">{
  "isDeleted": "soft",
  "reference": "anove"
}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateTenantRequested" key-field="key">
						<mapping target="name" value="name"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="F82UOt" exception="Tenant does not exist"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="TenantUpdated" id="1JXjpM">
						<mapping target="name" value="#flow.name"></mapping>
					</processor>
					<test-case name="UpdateTenant" trigger-event="UpdateTenantRequested" expected-processing-status="success">
						<input name="key" type="String" value="anove"></input>
						<input name="name" type="String" value="Anove"></input>
						<expected domain-event="TenantUpdated" id="GJlwnJ">
							<field name="name" type="String" value="Anove"></field>
						</expected>
						<state>{
  "name": "anove",
  "version": 1,
  "reference": "anove"
}</state>
						<expected-state pk="anove">{
  "name": "Anove",
  "reference": "anove"
}</expected-state>
					</test-case>
				</command>
				<command name="LinkStyleSheet">
					<trigger source="LinkStyleSheetTenantRequested" key-field="reference">
						<mapping target="path" value="path"></mapping>
					</trigger>
					<processor type="validator" id="NjcSCR" condition="flow.entity.version != 0" exception="May not be initial request"></processor>
					<processor type="emit-event" id="hIfDo8" ref="StyleSheetLinked">
						<mapping target="css" value="#flow.path"></mapping>
					</processor>
					<test-case name="LinkStyleSheet" trigger-event="LinkStyleSheetTenantRequested" expected-processing-status="success">
						<input name="reference" type="String" value="anove"></input>
						<input name="path" type="String" value="dummy/anove/custom.css"></input>
						<expected domain-event="StyleSheetLinked" id="n74FuY">
							<field name="css" type="String" value="dummy/anove/custom.css"></field>
						</expected>
						<state>{
  "version": 1,
  "reference": "anove"
}</state>
						<expected-state pk="anove">{
  "reference": "anove",
  "css": "dummy/anove/custom.css"
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="false">
					<trigger source="CreateTenantRequested" key-field="key">
						<mapping target="name" value="name"></mapping>
						<mapping target="reference" value="key"></mapping>
					</trigger>
					<processor type="emit-event" ref="TenantCreated" id="WjhRyQ">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="key" value="#flow.reference"></mapping>
					</processor>
					<test-case name="CreateTenant" trigger-event="CreateTenantRequested" expected-processing-status="success">
						<input name="key" type="String" value="anove"></input>
						<input name="name" type="String" value="Anove"></input>
						<state>{}</state>
						<expected domain-event="TenantCreated" id="zlJHje">
							<field name="name" type="String" value="Anove"></field>
							<field name="key" type="String" value="anove"></field>
						</expected>
						<expected-state pk="anove">{
  "name": "Anove",
  "reference": "anove"
}</expected-state>
					</test-case>
				</command>
				<command name="LinkLogo">
					<trigger source="LinkLogoTenantRequested" key-field="reference">
						<mapping target="path" value="path"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="6GATXk" exception="Tenant does not exist"></processor>
					<processor type="emit-event" id="8KfGDR" ref="TenantLogoLinked">
						<mapping target="logoPath" value="#flow.path"></mapping>
					</processor>
					<test-case name="LinkLogo" trigger-event="LinkLogoTenantRequested" expected-processing-status="success">
						<input name="reference" type="String" value="anove"></input>
						<input name="path" type="String" value="myLogo.png"></input>
						<expected domain-event="TenantLogoLinked" id="mtz4kn">
							<field name="logoPath" type="String" value="myLogo.png"></field>
						</expected>
						<state>{
  "reference": "anove",
  "version": 1
}</state>
						<expected-state pk="anove">{
  "reference": "anove",
  "logoPath": "myLogo.png"
}</expected-state>
					</test-case>
				</command>
				<event-handler on="TenantCreated">
					<mapping target="name" operand="set" value="name"></mapping>
					<mapping operand="set" target="reference" value="key"></mapping>
				</event-handler>
				<event-handler on="StyleSheetLinked">
					<mapping target="css" operand="set" value="css"></mapping>
				</event-handler>
				<event-handler on="TenantLogoLinked">
					<mapping target="logoPath" value="logoPath" operand="set"></mapping>
				</event-handler>
				<event-handler on="TenantUpdated">
					<mapping target="name" value="name" operand="set"></mapping>
				</event-handler>
				<event-handler on="TenantDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
			</aggregate>
			<aggregate name="Integrations" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="logoPath" type="String"></field>
				<field name="description" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteIntegrationsRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" id="ISVEKQ" ref="IntegrationDeleted">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="Delete" trigger-event="DeleteIntegrationsRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="IntegrationDeleted" id="pVsYje">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "isDeleted": "soft"
}</expected-state>
					</test-case>
				</command>
				<command name="Update" reactivate-command="optional" create-command="false">
					<trigger source="UpdateIntegrationsRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" exception="Integration does not exist" id="7qBxAW"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="IntegrationUpdated" id="mO07hg">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
					</processor>
					<test-case name="UpdateIntegration" trigger-event="UpdateIntegrationsRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="Jira"></input>
						<input name="description" type="String" value="ipsum..."></input>
						<expected domain-event="IntegrationUpdated" id="QBf8rF">
							<field name="name" type="String" value="Jira"></field>
							<field name="description" type="String" value="ipsum..."></field>
						</expected>
						<state>{
  "arn": "dummy",
  "name": "text",
  "logoPath": "text",
  "description": "text",
  "version": 1
}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "name": "Jira",
  "logoPath": "text",
  "description": "ipsum...",
  "version": 2
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true" reactivate-command="false">
					<trigger source="CreateIntegrationsRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
					</trigger>
					<processor type="emit-event" ref="IntegrationCreated" id="WttFNV">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
					</processor>
					<test-case name="CreateIntegration" trigger-event="CreateIntegrationsRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="name"></input>
						<input name="description" type="String" value="hello"></input>
						<expected domain-event="IntegrationCreated" id="p82IBb">
							<field name="arn" type="String" value="dummy"></field>
							<field name="name" type="String" value="name"></field>
							<field name="description" type="String" value="hello"></field>
						</expected>
						<state>{}</state>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "name": "name",
  "description": "hello"
}</expected-state>
					</test-case>
				</command>
				<command name="LinkLogo">
					<trigger source="LinkLogoIntegrationsRequested" key-field="reference">
						<mapping target="reference" value="reference"></mapping>
						<mapping target="path" value="path"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="hzXHfw" exception="Integration does not exist"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="LogoLinkedToIntegration" id="jjIXoB">
						<mapping target="logoPath" value="#flow.path"></mapping>
					</processor>
					<test-case name="LinkLogo" trigger-event="LinkLogoIntegrationsRequested" expected-processing-status="success">
						<input name="reference" type="String" value="dummy"></input>
						<input name="path" type="String" value="/mylogo.png"></input>
						<state>{
  "arn": "dummy",
  "version": 1
}</state>
						<expected domain-event="LogoLinkedToIntegration" id="EtFNHO">
							<field name="logoPath" type="String" value="/mylogo.png"></field>
						</expected>
						<expected-state pk="dummy">{"arn":"dummy","logoPath":"/mylogo.png"}</expected-state>
					</test-case>
				</command>
				<event-handler on="IntegrationDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="IntegrationUpdated">
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="description" value="description" operand="set"></mapping>
				</event-handler>
				<event-handler on="IntegrationCreated">
					<mapping target="arn" value="arn" operand="set"></mapping>
					<mapping target="name" value="name" operand="set"></mapping>
					<mapping target="description" value="description" operand="set"></mapping>
				</event-handler>
				<event-handler on="LogoLinkedToIntegration">
					<mapping target="logoPath" value="logoPath" operand="set"></mapping>
				</event-handler>
			</aggregate>
			<aggregate name="Requirement" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<field name="mandatory" type="Boolean"></field>
				<field name="summary" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteRequirementRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" ref="RequirementDeleted" id="Osh0p4">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteRequirement" trigger-event="DeleteRequirementRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="RequirementDeleted" id="PzHrps">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateRequirementRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="mandatory" value="mandatory"></mapping>
						<mapping target="summary" value="summary"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="ke2MSS" exception="Requirement does not exist"></processor>
					<processor type="emit-event" ref="RequirementUpdated" id="1iOypp">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="mandatory" value="#flow.mandatory"></mapping>
						<mapping target="summary" value="#flow.summary"></mapping>
					</processor>
					<test-case name="UpdateRequirement" trigger-event="UpdateRequirementRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="Hello World!"></input>
						<input name="description" type="String" value=""></input>
						<input name="mandatory" type="Boolean" value="false"></input>
						<input name="summary" type="String" value=""></input>
						<state>{
  "version": 1,
  "arn": "dummy",
  "name": "Hello"
}</state>
						<expected domain-event="RequirementUpdated" id="NEYBqk">
							<field name="name" type="String" value="Hello World!"></field>
							<field name="description" type="String" value=""></field>
							<field name="mandatory" type="Boolean" value="false"></field>
							<field name="summary" type="String" value=""></field>
						</expected>
						<expected-state pk="dummy">{
  "arn": "dummy",
  "name": "Hello World!"
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="AddRequirementRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
						<mapping target="mandatory" value="mandatory"></mapping>
						<mapping target="summary" value="summary"></mapping>
					</trigger>
					<processor type="emit-event" id="2ebA8Y" ref="RequirementCreated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
						<mapping target="mandatory" value="#flow.mandatory"></mapping>
						<mapping target="summary" value="#flow.summary"></mapping>
					</processor>
					<test-case name="AddNewRequirement" trigger-event="AddRequirementRequested" expected-processing-status="success">
						<input name="arn" value="controlframework:gdpr:req1" type="String"></input>
						<input name="name" value="req 1" type="String"></input>
						<input name="description" value="Hello World!" type="String"></input>
						<input name="mandatory" value="true" type="Boolean"></input>
						<input name="summary" value="hw" type="String"></input>
						<expected domain-event="RequirementCreated" id="GAKVcf">
							<field value="controlframework:gdpr:req1" name="arn" type="String"></field>
							<field value="req 1" name="name" type="String"></field>
							<field value="Hello World!" name="description" type="String"></field>
							<field value="true" name="mandatory" type="Boolean"></field>
							<field value="hw" name="summary" type="String"></field>
						</expected>
						<expected-state pk="controlframework:gdpr:req1">{
  "arn": "controlframework:gdpr:req1",
  "name": "req 1",
  "description": "Hello World!",
  "mandatory": true,
  "summary": "hw"
}</expected-state>
						<state>{}</state>
					</test-case>
					<test-case name="AddDuplicateRequirement" trigger-event="AddRequirementRequested" expected-processing-status="error">
						<input name="arn" value="controlframework:gdpr:req1" type="String"></input>
						<input name="name" value="req 1" type="String"></input>
						<input name="description" value="Hello World!" type="String"></input>
						<input name="mandatory" value="true" type="Boolean"></input>
						<input name="summary" value="hw" type="String"></input>
						<state>{
  "arn": "controlframework:gdpr:req1",
  "version": 1
}</state>
					</test-case>
				</command>
				<event-handler on="RequirementDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="RequirementUpdated" code="if event.name:|LB|    self.name = event.name|LB|if event.description:|LB|    self.description = event.description|LB|self.mandatory = event.mandatory|LB|if event.summary:|LB|    self.summary = event.summary|LB|"></event-handler>
				<event-handler on="RequirementCreated">
					<mapping target="arn" operand="set" value="arn"></mapping>
					<mapping target="name" operand="set" value="name"></mapping>
					<mapping target="description" operand="set" value="description"></mapping>
					<mapping target="mandatory" operand="set" value="mandatory"></mapping>
					<mapping target="summary" operand="set" value="summary"></mapping>
				</event-handler>
			</aggregate>
			<aggregate name="Industry" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="description" type="String"></field>
				<command name="Delete">
					<trigger source="DeleteIndustryRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" id="26eAWe" ref="IndustryDeleted">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteIndustry" trigger-event="DeleteIndustryRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="IndustryDeleted" id="WjVcHk">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<command name="Update">
					<trigger source="UpdateIndustryRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
					</trigger>
					<processor type="validator" condition="flow.entity.version != 0" id="A4H3LD" exception="Industry does not exist"></processor>
					<processor condition="flow.entity.version != 0" type="emit-event" ref="IndustryUpdated" id="mHFQVf">
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
					</processor>
					<test-case name="UpdateIndustry" trigger-event="UpdateIndustryRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<input name="name" type="String" value="test"></input>
						<input name="description" type="String" value="sum"></input>
						<expected domain-event="IndustryUpdated" id="rOHLEQ">
							<field name="name" type="String" value="test"></field>
							<field name="description" type="String" value="sum"></field>
						</expected>
						<state>{
  "arn": "dummy",
  "version": 1
}</state>
						<expected-state pk="dummy">{
  "name": "test",
  "description": "sum",
  "arn": "dummy"
}</expected-state>
					</test-case>
				</command>
				<command name="Create" create-command="true">
					<trigger source="AddIndustryRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="description" value="description"></mapping>
					</trigger>
					<processor type="emit-event" id="U8J057" ref="IndustryCreated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="description" value="#flow.description"></mapping>
					</processor>
					<processor type="validator" id="r8n5VM" condition='flow.name != ""' exception="Name may not be empty"></processor>
					<processor type="validator" id="1HirZZ" condition='flow.description != ""' exception="Description may not be empty"></processor>
					<test-case name="AddNewIndustry" trigger-event="AddIndustryRequested" expected-processing-status="success">
						<input name="arn" value="industry:automotive" type="String"></input>
						<input name="name" value="Automotive" type="String"></input>
						<input name="description" value="The automotive industry" type="String"></input>
						<expected domain-event="IndustryCreated" id="J44PKx">
							<field value="industry:automotive" name="arn" type="String"></field>
							<field value="Automotive" name="name" type="String"></field>
							<field value="The automotive industry" name="description" type="String"></field>
						</expected>
						<expected-state pk="industry:automotive">{
  "arn": "industry:automotive",
  "name": "Automotive",
  "description": "The automotive industry"
}</expected-state>
						<state>{}</state>
					</test-case>
					<test-case name="AddDuplicateIndustry" trigger-event="AddIndustryRequested" expected-processing-status="error">
						<input name="arn" value="industry:automotive" type="String"></input>
						<input name="name" value="Hello World!" type="String"></input>
						<input name="description" value="None" type="String"></input>
						<state>{
  "arn": "industry:automotive",
  "name": "Automotive",
  "description": "The automotive industry",
  "version": 1
}</state>
					</test-case>
				</command>
				<event-handler on="IndustryDeleted" code='self.isDeleted = "soft"|LB|'></event-handler>
				<event-handler on="IndustryCreated">
					<mapping target="arn" operand="set" value="arn"></mapping>
					<mapping target="name" operand="set" value="name"></mapping>
					<mapping target="description" operand="set" value="description"></mapping>
				</event-handler>
				<event-handler on="IndustryUpdated" code="|LB|if event.name:|LB|    self.name = event.name|LB|if event.description:|LB|    self.description = event.description|LB|"></event-handler>
			</aggregate>
			<aggregate name="Region" business-key="arn" event-ttl="-1" snapshot-interval="100" backup-interval-days="0" backup-ttl-days="0">
				<field name="arn" type="String"></field>
				<field name="name" type="String"></field>
				<field name="code" type="String"></field>
				<command name="CreateOrUpdate">
					<trigger source="UpdateRegionRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
						<mapping target="code" value="code"></mapping>
						<mapping target="name" value="name"></mapping>
						<mapping target="countries" value="countries"></mapping>
					</trigger>
					<processor type="emit-event" id="HAaaVq" ref="RegionUpdated">
						<mapping target="arn" value="#flow.arn"></mapping>
						<mapping target="name" value="#flow.name"></mapping>
						<mapping target="code" value="#flow.code"></mapping>
						<mapping target="countries" value="#flow.countries"></mapping>
					</processor>
					<test-case name="CreateNewRegion" trigger-event="UpdateRegionRequested" expected-processing-status="success">
						<input name="arn" value="region:NA" type="String"></input>
						<input name="code" value="NA" type="String"></input>
						<input name="name" value="North America" type="String"></input>
						<input name="countries" type="NestedObject">[
  {
    "code": "US",
    "name": "United States of America"
  },
  {
    "code": "CA",
    "name": "Canada"
  }
]</input>
						<expected domain-event="RegionUpdated" id="zhWuZ9">
							<field value="region:NA" name="arn" type="String"></field>
							<field value="North America" name="name" type="String"></field>
							<field value="NA" name="code" type="String"></field>
						</expected>
						<expected-state pk="region:NA">{
  "arn": "region:NA",
  "name": "North America",
  "code": "NA",
  "countries": {
    "US": {
        "code": "US",
        "name": "United States of America"
      },
     "CA": {
        "code": "CA",
        "name": "Canada"
      }
  }
}</expected-state>
						<state>{}</state>
					</test-case>
					<test-case name="UpdateRegion" trigger-event="UpdateRegionRequested" expected-processing-status="success">
						<input name="arn" value="region:NA" type="String"></input>
						<input name="code" value="NA" type="String"></input>
						<input name="name" value="North America" type="String"></input>
						<input name="countries" type="NestedObject">[
  {
    "code": "US",
    "name": "United States of America"
  },
  {
    "code": "CA",
    "name": "Canada"
  }
]</input>
						<state>{
  "arn": "region:NA",
  "name": "North America",
  "code": "NA",
  "countries": {
    "US": {
      "code": "US",
      "name": "Un Sta of Ame"
    }
  }
}</state>
						<expected domain-event="RegionUpdated" id="3G5PBf">
							<field value="region:NA" name="arn" type="String"></field>
							<field value="North America" name="name" type="String"></field>
							<field value="NA" name="code" type="String"></field>
						</expected>
						<expected-state pk="region:NA">{
  "arn": "region:NA",
  "name": "North America",
  "code": "NA",
  "countries": {
    "US": {
        "code": "US",
        "name": "United States of America"
      },
     "CA": {
        "code": "CA",
        "name": "Canada"
      }
  }
}</expected-state>
					</test-case>
				</command>
				<command name="Delete">
					<trigger source="DeleteRegionRequested" key-field="arn">
						<mapping target="arn" value="arn"></mapping>
					</trigger>
					<processor type="emit-event" id="ucegOQ" ref="RegionDeleted">
						<mapping target="arn" value="#flow.arn"></mapping>
					</processor>
					<test-case name="DeleteRegion" trigger-event="DeleteRegionRequested" expected-processing-status="success">
						<input name="arn" type="String" value="dummy"></input>
						<expected domain-event="RegionDeleted" id="6NaYm9">
							<field name="arn" type="String" value="dummy"></field>
						</expected>
						<state>{
  "arn": "dummy"
}</state>
						<expected-state pk="dummy">{"arn":"dummy","isDeleted":"soft"}</expected-state>
					</test-case>
				</command>
				<event-handler on="RegionUpdated">
					<mapping target="arn" operand="set" value="arn"></mapping>
					<mapping target="name" operand="set" value="name"></mapping>
					<mapping target="code" operand="set" value="code"></mapping>
					<nested-mapping source="countries" target="countries" business-key="code" strategy="extend">
						<mapping target="code" operand="set" value="code"></mapping>
						<mapping target="name" operand="set" value="name"></mapping>
					</nested-mapping>
				</event-handler>
				<event-handler on="RegionDeleted" code='self.isDeleted = "soft"'></event-handler>
				<nested-object name="countries" business-key="code">
					<field name="code" type="String"></field>
					<field name="name" type="String"></field>
				</nested-object>
			</aggregate>
		</subdomain>
	</domain>
	<views>
		<view name="ControlTemplate" data-retention-days="-1" exclude-notification="false">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="requirementArns" type="StringList"></field>
			<field name="arn" type="String"></field>
			<field name="templateVersion" type="String"></field>
			<field name="linkedRequirements" type="OneToMany" ref="Requirement" authorization="authenticated" foreign-key="requirementArns"></field>
			<field name="reference" type="String" pk="true"></field>
			<snapshot-handler id="IkHDvC" processor="item" sub-domain="Admin" aggregate="ControlTemplate" key-mapping="reference">
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping target="assessmentPeriodicity" value="assessmentPeriodicity" operand="set"></mapping>
				<mapping target="requirementArns" value="requirementArns" operand="set"></mapping>
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="templateVersion" value="templateVersion" operand="set"></mapping>
				<mapping operand="set" target="reference" value="reference"></mapping>
				<delete id="uO40BX" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<snapshot-handler id="dVygCe" processor="item" sub-domain="Admin" aggregate="ControlTemplate" key-mapping="previousVersion">
				<delete id="mzj6Dt" condition="#snapshot.isDeleted != ''"></delete>
				<delete id="nLEZiL" condition="#snapshot.previousVersion != snapshot.reference"></delete>
				<mapping operand="set" target="name" value="name"></mapping>
			</snapshot-handler>
			<query graphql-namespace="ControlTemplate" field-name="get" type="get" authorization="authenticated" use-canonical-search="false"></query>
			<query graphql-namespace="ControlTemplate" field-name="filter" type="filter" authorization="authenticated" use-canonical-search="false"></query>
			<custom-handler id="0pHwlx" sub-domain="Admin" aggregate="ControlTemplate">#Your custom logic, you have access to:
#  The 'event' object
#  The 'snapshot' object
#  And the EntityManager
if snapshot.isDeleted != '':
    for i in range(1,int(snapshot.templateVersion.replace("-PREVIEW",""))):
        entity = EntityManager.get(type="ControlTemplate", key=snapshot.arn + ":" + str(i))
        entity.mark_for_deletion = True</custom-handler>
		</view>
		<view name="Control" data-retention-days="-1" exclude-notification="false">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="controlTemplateArn" type="String"></field>
			<field name="assessmentPeriodicity" type="String"></field>
			<field name="lastAssessmentDate" type="String"></field>
			<field name="applicability" type="Boolean"></field>
			<field name="desiredMaturityLevel" type="Int"></field>
			<field name="businessUnit" type="String"></field>
			<field name="requirementArns" type="StringList"></field>
			<field name="companyArn" type="String"></field>
			<field name="arn" type="String" pk="true"></field>
			<field name="company" type="ManyToOne" ref="Company" authorization="authenticated" foreign-key="companyArn"></field>
			<field name="owner" type="ManyToOne" ref="Employee" authorization="authenticated" foreign-key="controlOwner"></field>
			<field name="requirements" type="ManyToMany" ref="Requirement" authorization="authenticated" foreign-key="requirementArns"></field>
			<field name="nextAssessmentDate" type="String"></field>
			<field name="controlOwner" type="String"></field>
			<field name="assesments" type="OneToMany" ref="ControlAssessment" authorization="authenticated" foreign-key="#canonical"></field>
			<field name="hasPendingSelfAssessment" type="Boolean"></field>
			<snapshot-handler id="DtgdXj" sub-domain="Customer" aggregate="Control" key-mapping="arn" processor="item">
				<mapping target="name" operand="set" value="name"></mapping>
				<mapping target="description" operand="set" value="description"></mapping>
				<mapping target="controlTemplateArn" operand="set" value="controlTemplateArn"></mapping>
				<mapping target="assessmentPeriodicity" operand="set" value="assessmentPeriodicity"></mapping>
				<mapping target="lastAssessmentDate" operand="set" value="lastAssessmentDate"></mapping>
				<mapping target="applicability" operand="set" value="applicability"></mapping>
				<mapping target="desiredMaturityLevel" operand="set" value="desiredMaturityLevel"></mapping>
				<mapping target="businessUnit" operand="set" value="businessUnit"></mapping>
				<mapping target="requirementArns" operand="set" value="requirementArns"></mapping>
				<mapping target="companyArn" operand="set" value="companyArn"></mapping>
				<mapping target="arn" operand="set" value="arn"></mapping>
				<mapping target="nextAssessmentDate" operand="set" value="nextAssessmentDate"></mapping>
				<mapping target="controlOwner" operand="set" value="controlOwner"></mapping>
				<mapping target="hasPendingSelfAssessment" operand="set" value="hasPendingSelfAssessment"></mapping>
				<delete condition="#snapshot.isDeleted != ''" id="Dx89I3"></delete>
			</snapshot-handler>
			<query graphql-namespace="Control" field-name="get" type="get" authorization="role" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="Control" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="ThirdParty" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="role" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="country" type="String"></field>
			<field name="knownCertification" type="String"></field>
			<field name="isCritical" type="Boolean"></field>
			<field name="isDirectThirdParty" type="Boolean"></field>
			<field name="owner" type="String"></field>
			<field name="subprocessors" type="OneToOne" ref="SubprocessorLink" authorization="authenticated" foreign-key="arn"></field>
			<field name="assessments" type="OneToMany" ref="Questionaire" authorization="authenticated" foreign-key="#canonical"></field>
			<snapshot-handler id="XOQmcv" processor="item" sub-domain="ThirdPartyManagement" aggregate="ThirdParty" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping target="role" value="role" operand="set"></mapping>
				<mapping target="address" value="address" operand="set"></mapping>
				<mapping target="companyRegistrationNumber" value="companyRegistrationNumber" operand="set"></mapping>
				<mapping target="country" value="country" operand="set"></mapping>
				<mapping target="knownCertification" value="knownCertification" operand="set"></mapping>
				<mapping target="isCritical" value="isCritical" operand="set"></mapping>
				<mapping target="isDirectThirdParty" value="isDirectThirdParty" operand="set"></mapping>
				<mapping target="owner" value="owner" operand="set"></mapping>
				<delete id="mLCii1" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="ThirdParty" field-name="get" type="get" authorization="role" use-canonical-search="false" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="ThirdParty" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="ThirdPartyTask" data-retention-days="-1" exclude-notification="false">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="completeDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String" pk="true"></field>
			<snapshot-handler id="nLq22g" processor="dictionary" sub-domain="ThirdPartyManagement" aggregate="ThirdParty" dictionary="task" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping operand="set" target="assignee" value="assignee"></mapping>
				<mapping operand="set" target="dueDate" value="dueDate"></mapping>
				<mapping operand="set" target="completeDate" value="completeDate"></mapping>
				<mapping operand="set" target="notes" value="notes"></mapping>
				<delete id="vqYpiW" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="ThirdParty" field-name="getTasks" type="query" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="SubprocessorLink" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="links" type="StringList"></field>
			<field name="thirdparties" type="ManyToMany" ref="ThirdParty" authorization="authenticated" foreign-key="links"></field>
			<snapshot-handler id="Z8MqBc" processor="item" sub-domain="ThirdPartyManagement" aggregate="ThirdParty" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping operand="set" target="links" value="subprocessors"></mapping>
				<delete id="prEzQ7" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
		</view>
		<view name="Country" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="code" type="String"></field>
			<field name="regionArn" type="String"></field>
			<field name="region" type="ManyToOne" ref="Region" authorization="authenticated" foreign-key="regionArn"></field>
			<custom-handler id="RWpc1Y" sub-domain="Admin" aggregate="Region">for country in snapshot.countries.values():
    arn = snapshot.arn + ":country:" + country.code
    entity = EntityManager.get(type="Country", key=arn)
    entity.arn = arn
    entity.name = country.name
    entity.code = country.code
    entity.regionArn = snapshot.arn
    if snapshot.isDeleted != '':
        entity.mark_for_deletion = True</custom-handler>
			<query graphql-namespace="Country" field-name="get" type="get" authorization="authenticated"></query>
			<query graphql-namespace="Country" field-name="filter" type="filter" authorization="authenticated" use-canonical-search="true"></query>
		</view>
		<view name="User" data-retention-days="-1" exclude-notification="false">
			<field name="username" type="String" pk="true"></field>
			<field name="links" type="ObjectList" ref="UserCompanyLink" authorization="authenticated" foreign-key="username"></field>
			<field name="firstName" type="String"></field>
			<field name="lastName" type="String"></field>
			<field name="active" type="Boolean"></field>
			<field name="email" type="String"></field>
			<field name="searchIndex" type="String"></field>
			<field name="createdAt" type="Int"></field>
			<field name="updatedAt" type="Int"></field>
			<snapshot-handler id="svYd9b" sub-domain="Admin" aggregate="User" key-mapping="username" processor="item">
				<mapping target="username" operand="set" value="username"></mapping>
				<mapping target="firstName" operand="set" value="firstName"></mapping>
				<mapping target="lastName" operand="set" value="lastName"></mapping>
				<mapping target="links" operand="convert_items" value="companies" template='{"arn": value["arn"],"employeeArn": value["employeeArn"]}'></mapping>
				<mapping target="active" operand="set" value="active"></mapping>
				<mapping target="email" operand="set" value="email"></mapping>
				<mapping operand="set" target="createdAt" value="created_at"></mapping>
				<mapping operand="set" target="updatedAt" value="updated_at"></mapping>
				<delete condition="#snapshot.isDeleted != '' or snapshot.active == False" id="McDuAw"></delete>
			</snapshot-handler>
			<query graphql-namespace="User" field-name="get" type="get" authorization="user" username-field="key"></query>
			<custom-handler id="TRGjhv" sub-domain="Admin" aggregate="User">entity = EntityManager.get(type="User", key=snapshot.username)
index = f"{snapshot.username} {snapshot.firstName} {snapshot.lastName} {snapshot.email}"
entity.searchIndex = index.lower()
if snapshot.isDeleted != '' or snapshot.active == False:
    entity.mark_for_deletion = True</custom-handler>
		</view>
		<view name="UserCompanyLink" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String"></field>
			<field name="company" type="ManyToOne" ref="Company" authorization="role" foreign-key="arn" role="#global.isCompanyViewer(arn)"></field>
			<field name="employeeArn" type="String"></field>
			<field name="employee" type="OneToOne" ref="Employee" authorization="role" foreign-key="employeeArn" role="#global.isCompanyViewer(employeeArn)"></field>
		</view>
		<view name="Profile" data-retention-days="-1" exclude-notification="false">
			<field name="username" type="String" pk="true"></field>
			<field name="firstName" type="String"></field>
			<field name="lastName" type="String"></field>
			<snapshot-handler id="71tqcg" sub-domain="Admin" aggregate="User" key-mapping="username" processor="item">
				<mapping target="username" operand="set" value="username"></mapping>
				<mapping target="firstName" operand="set" value="firstName"></mapping>
				<mapping target="lastName" operand="set" value="lastName"></mapping>
				<delete condition="#snapshot.isDeleted != '' or snapshot.active == False" id="q76aYg"></delete>
			</snapshot-handler>
			<query graphql-namespace="Profile" field-name="get" type="get" authorization="authenticated"></query>
			<query graphql-namespace="Profile" field-name="filter" type="filter" authorization="authenticated" use-canonical-search="false"></query>
		</view>
		<view name="RiskTemplate" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="grossLikelihood" type="Int"></field>
			<field name="grossImpact" type="Int"></field>
			<field name="reviewPeriodicity" type="String"></field>
			<field name="templateVersion" type="String"></field>
			<field name="reference" type="String" pk="true"></field>
			<field name="previousVersion" type="String"></field>
			<snapshot-handler id="HgnMBm" processor="item" sub-domain="Admin" aggregate="RiskTemplate" key-mapping="reference">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping target="grossLikelihood" value="grossLikelihood" operand="set"></mapping>
				<mapping target="grossImpact" value="grossImpact" operand="set"></mapping>
				<mapping target="reviewPeriodicity" value="reviewPeriodicity" operand="set"></mapping>
				<mapping target="templateVersion" value="templateVersion" operand="set"></mapping>
				<mapping target="reference" value="reference" operand="set"></mapping>
				<mapping target="previousVersion" value="previousVersion" operand="set"></mapping>
				<delete id="aAUs0H" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<snapshot-handler id="WngJJg" processor="item" sub-domain="Admin" aggregate="RiskTemplate" key-mapping="previousVersion">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<delete id="caoVYc" condition="#snapshot.isDeleted != ''"></delete>
				<delete id="XI13WD" condition="#snapshot.previousVersion != snapshot.reference"></delete>
			</snapshot-handler>
			<custom-handler id="u5xVV3" sub-domain="Admin" aggregate="RiskTemplate">if snapshot.isDeleted != '':
    for i in range(1,int(snapshot.templateVersion.replace("-PREVIEW",""))):
        entity = EntityManager.get(type="ControlTemplate", key=snapshot.arn + ":" + str(i))
        entity.mark_for_deletion = True</custom-handler>
			<query graphql-namespace="RiskTemplate" field-name="get" type="get" authorization="authenticated" use-canonical-search="false"></query>
			<query graphql-namespace="RiskTemplate" field-name="filter" type="filter" authorization="authenticated" use-canonical-search="false"></query>
		</view>
		<view name="ThirdPartyTemplate" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="address" type="String"></field>
			<field name="companyRegistrationNumber" type="String"></field>
			<field name="countryArn" type="String"></field>
			<field name="knownCertification" type="String"></field>
			<field name="country" type="OneToOne" ref="Country" authorization="authenticated" foreign-key="countryArn"></field>
			<snapshot-handler id="P2oBme" processor="item" sub-domain="Admin" aggregate="ThirdPartyTemplate" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping target="address" value="address" operand="set"></mapping>
				<mapping target="companyRegistrationNumber" value="companyRegistrationNumber" operand="set"></mapping>
				<mapping target="knownCertification" value="knownCertification" operand="set"></mapping>
				<mapping operand="set" target="countryArn" value="country"></mapping>
				<delete id="8lJkAF" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="ThirdPartyTemplate" field-name="get" type="get" authorization="authenticated" use-canonical-search="false"></query>
			<query graphql-namespace="ThirdPartyTemplate" field-name="filter" type="filter" authorization="authenticated" use-canonical-search="false"></query>
		</view>
		<view name="Integration" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="logoPath" type="String"></field>
			<field name="description" type="String"></field>
			<snapshot-handler id="M4nClo" processor="item" sub-domain="Admin" aggregate="Integrations" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="logoPath" value="logoPath" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<delete id="NPJmBs" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="Integration" field-name="get" type="get" authorization="authenticated" use-canonical-search="false"></query>
			<query graphql-namespace="Integration" field-name="filter" type="filter" authorization="authenticated" use-canonical-search="false"></query>
		</view>
		<view name="ControlFramework" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="description" type="String"></field>
			<field name="name" type="String"></field>
			<field name="category" type="String"></field>
			<field name="edition" type="String"></field>
			<field name="unit" type="String"></field>
			<field name="acronym" type="String"></field>
			<field name="active" type="Boolean"></field>
			<field name="requirements" type="OneToMany" ref="Requirement" authorization="authenticated" foreign-key="#canonical"></field>
			<snapshot-handler id="1xTQuT" sub-domain="Admin" aggregate="ControlFramework" key-mapping="arn" processor="item">
				<mapping target="arn" operand="set" value="arn"></mapping>
				<mapping target="description" operand="set" value="description"></mapping>
				<mapping target="name" operand="set" value="name"></mapping>
				<mapping target="category" operand="set" value="category"></mapping>
				<mapping target="edition" operand="set" value="edition"></mapping>
				<mapping target="unit" operand="set" value="unit"></mapping>
				<mapping target="acronym" operand="set" value="acronym"></mapping>
				<mapping target="active" operand="set" value="active"></mapping>
				<delete condition="#snapshot.isDeleted != ''" id="AFNsa4"></delete>
			</snapshot-handler>
			<query graphql-namespace="ControlFramework" field-name="get" type="get" authorization="authenticated"></query>
			<query graphql-namespace="ControlFramework" field-name="filter" type="filter" authorization="authenticated"></query>
		</view>
		<view name="ControlAssessment" data-retention-days="-1" exclude-notification="false">
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="completeDate" type="String"></field>
			<field name="category" type="String"></field>
			<field name="arn" type="String" pk="true"></field>
			<field name="assessedMaturityLevel" type="String"></field>
			<field name="assessedMaturityDescription" type="String"></field>
			<field name="linkToEvidence" type="String"></field>
			<field name="assessorLink" type="String" default=""></field>
			<field name="assesor" type="ManyToMany" ref="Employee" authorization="authenticated" foreign-key="assessorLink"></field>
			<snapshot-handler id="e7tBLN" sub-domain="Customer" aggregate="Control" key-mapping="arn" processor="dictionary" dictionary="assessment">
				<mapping target="arn" operand="set" value="arn"></mapping>
				<mapping target="dueDate" operand="set" value="dueDate"></mapping>
				<mapping target="notes" operand="set" value="notes"></mapping>
				<mapping target="completeDate" operand="set" value="completeDate"></mapping>
				<mapping target="category" operand="set" value="category"></mapping>
				<mapping target="assessedMaturityLevel" operand="set" value="assessedMaturityLevel"></mapping>
				<mapping target="assessedMaturityDescription" operand="set" value="assessedMaturityDescription"></mapping>
				<mapping target="linkToEvidence" operand="set" value="linkToEvidence"></mapping>
				<mapping target="assessorLink" operand="set" value="assessorLink"></mapping>
				<delete condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="ControlAssessment" field-name="get" type="get" authorization="role" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="ControlAssessment" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="Objective" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="owner" type="String"></field>
			<field name="startDate" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="definitionOfDone" type="String"></field>
			<field name="completionPercentage" type="Int"></field>
			<field name="tasks" type="OneToMany" ref="ObjectiveTask" authorization="authenticated" foreign-key="#canonical"></field>
			<field name="name" type="String"></field>
			<snapshot-handler id="UhHRig" processor="item" sub-domain="Customer" aggregate="Objective" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="owner" value="owner" operand="set"></mapping>
				<mapping target="startDate" value="startDate" operand="set"></mapping>
				<mapping target="dueDate" value="dueDate" operand="set"></mapping>
				<mapping target="definitionOfDone" value="definitionOfDone" operand="set"></mapping>
				<mapping target="completionPercentage" value="completionPercentage" operand="set"></mapping>
				<mapping operand="set" target="name" value="name"></mapping>
				<delete id="Hz8due" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="Objective" field-name="get" type="get" authorization="role" use-canonical-search="false" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="Objective" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)">
				<filter-clause operand="equals" field-name="owner" id="qFRLPQ"></filter-clause>
				<filter-clause operand="equals" field-name="completionPercentage" id="chdfSO"></filter-clause>
			</query>
		</view>
		<view name="ObjectiveTask" data-retention-days="-1" exclude-notification="false">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="completeDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String" pk="true"></field>
			<field name="createdAt" type="Int"></field>
			<field name="updatedAt" type="Int"></field>
			<field name="completedAt" type="Int"></field>
			<snapshot-handler id="RmM6HV" processor="dictionary" sub-domain="Customer" aggregate="Objective" dictionary="task" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="dueDate" value="dueDate" operand="set"></mapping>
				<mapping operand="set" target="name" value="name"></mapping>
				<mapping operand="set" target="description" value="description"></mapping>
				<mapping operand="set" target="assignee" value="assignee"></mapping>
				<mapping operand="set" target="completeDate" value="completeDate"></mapping>
				<mapping operand="set" target="notes" value="notes"></mapping>
				<mapping operand="set" target="createdAt" value="createdAt"></mapping>
				<mapping operand="set" target="updatedAt" value="updatedAt"></mapping>
				<mapping operand="set" target="completedAt" value="completedAt"></mapping>
				<delete id="wM4n11" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="Objective" field-name="getTasks" type="query" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="AssetTask" data-retention-days="-1" exclude-notification="false">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="completeDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String" pk="true"></field>
			<snapshot-handler id="mfqXSZ" processor="dictionary" sub-domain="Customer" aggregate="Asset" dictionary="task" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping operand="set" target="assignee" value="assignee"></mapping>
				<mapping operand="set" target="dueDate" value="dueDate"></mapping>
				<mapping operand="set" target="completeDate" value="completeDate"></mapping>
				<mapping operand="set" target="notes" value="notes"></mapping>
				<delete id="kxA0ps" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="Asset" field-name="getTasks" type="query" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="Asset" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="owner" type="String"></field>
			<field name="confidentiality" type="String"></field>
			<field name="integrity" type="String"></field>
			<field name="availability" type="String"></field>
			<field name="privacy" type="String"></field>
			<field name="createdAt" type="Int"></field>
			<field name="updatedAt" type="Int"></field>
			<snapshot-handler id="92SsdD" processor="item" sub-domain="Customer" aggregate="Asset" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping target="owner" value="owner" operand="set"></mapping>
				<mapping target="confidentiality" value="confidentiality" operand="set"></mapping>
				<mapping target="integrity" value="integrity" operand="set"></mapping>
				<mapping target="availability" value="availability" operand="set"></mapping>
				<mapping target="privacy" value="privacy" operand="set"></mapping>
				<mapping operand="set" target="createdAt" value="created_at"></mapping>
				<mapping operand="set" target="updatedAt" value="updated_at"></mapping>
				<delete id="bankRW" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="Asset" field-name="get" type="get" authorization="role" use-canonical-search="false" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="Asset" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="Tenant" data-retention-days="-1" exclude-notification="false">
			<field name="name" type="String"></field>
			<field name="css" type="String"></field>
			<field name="reference" type="String" pk="true"></field>
			<field name="logoPath" type="String"></field>
			<snapshot-handler id="4c3beB" sub-domain="Admin" aggregate="Tenant" key-mapping="reference" processor="item">
				<mapping target="name" operand="set" value="name"></mapping>
				<mapping target="css" operand="set" value="css"></mapping>
				<mapping operand="set" target="reference" value="reference"></mapping>
				<mapping operand="set" target="logoPath" value="logoPath"></mapping>
				<delete condition="#snapshot.isDeleted != ''" id="YxYxmV"></delete>
			</snapshot-handler>
			<query graphql-namespace="Tenant" field-name="get" type="get" authorization="authenticated"></query>
			<query graphql-namespace="Tenant" field-name="filter" type="filter" authorization="authenticated"></query>
		</view>
		<view name="Questionaire" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="formBricksId" type="String"></field>
			<snapshot-handler id="JvjbBh" processor="item" sub-domain="ThirdPartyManagement" aggregate="Assessment" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="formBricksId" value="formBricksId" operand="set"></mapping>
				<delete id="xzNL5C" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="Questionaire" field-name="get" type="get" authorization="role" use-canonical-search="false" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="Questionaire" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="ProcessingActivity" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="owner" type="String"></field>
			<field name="requiresDpia" type="Boolean"></field>
			<field name="weight" type="Int"></field>
			<field name="tasks" type="OneToMany" ref="ProcessingActivityTask" authorization="authenticated" foreign-key="#canonical"></field>
			<snapshot-handler id="DSVogu" processor="item" sub-domain="Customer" aggregate="ProcessingActivity" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping target="owner" value="owner" operand="set"></mapping>
				<mapping target="requiresDpia" value="requiresDpia" operand="set"></mapping>
				<mapping target="weight" value="weight" operand="set"></mapping>
				<delete id="Kmp21v" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="ProcessingActivity" field-name="get" type="get" authorization="role" use-canonical-search="false" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="ProcessingActivity" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="ProcessingActivityTask" data-retention-days="-1" exclude-notification="false">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="completeDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="arn" type="String" pk="true"></field>
			<snapshot-handler id="8eC5rN" processor="dictionary" sub-domain="Customer" aggregate="ProcessingActivity" dictionary="task" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping operand="set" target="assignee" value="assignee"></mapping>
				<mapping operand="set" target="dueDate" value="dueDate"></mapping>
				<mapping operand="set" target="completeDate" value="completeDate"></mapping>
				<mapping operand="set" target="notes" value="notes"></mapping>
				<delete id="AAxdxf" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="ProcessingActivity" field-name="getTasks" type="query" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="Requirement" data-retention-days="-1" exclude-notification="false">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="mandatory" type="Boolean"></field>
			<field name="summary" type="String"></field>
			<field name="arn" type="String" pk="true"></field>
			<snapshot-handler id="73vD0z" sub-domain="Admin" aggregate="Requirement" key-mapping="arn" processor="item">
				<mapping target="name" operand="set" value="name"></mapping>
				<mapping target="description" operand="set" value="description"></mapping>
				<mapping target="mandatory" operand="set" value="mandatory"></mapping>
				<mapping target="summary" operand="set" value="summary"></mapping>
				<mapping target="arn" operand="set" value="arn"></mapping>
				<delete condition="#snapshot.isDeleted != ''" id="GNnhcI"></delete>
			</snapshot-handler>
			<query graphql-namespace="Requirement" field-name="get" type="get" authorization="authenticated"></query>
			<query graphql-namespace="Requirement" field-name="filter" type="filter" authorization="authenticated" use-canonical-search="true"></query>
		</view>
		<view name="Company" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="companySize" type="Int"></field>
			<field name="revenue" type="String"></field>
			<field name="industryLink" type="StringList"></field>
			<field name="employees" type="OneToMany" ref="Employee" authorization="authenticated" foreign-key="#canonical"></field>
			<field name="industry" type="ManyToMany" ref="Industry" authorization="authenticated" foreign-key="industryLink"></field>
			<field name="businessUnits" type="ObjectList" ref="BusinessUnit" authorization="authenticated" foreign-key="arn"></field>
			<field name="countryArn" type="String"></field>
			<field name="country" type="ManyToOne" ref="Country" authorization="authenticated" foreign-key="countryArn"></field>
			<field name="controlFrameworkLink" type="StringList"></field>
			<field name="controlframework" type="ManyToMany" ref="ControlFramework" authorization="authenticated" foreign-key="controlFrameworkLink"></field>
			<field name="controls" type="OneToMany" ref="Control" authorization="authenticated" foreign-key="#canonical"></field>
			<field name="risks" type="OneToMany" ref="Risk" authorization="authenticated" foreign-key="#canonical"></field>
			<field name="logoPath" type="String"></field>
			<field name="assets" type="OneToMany" ref="Asset" authorization="authenticated" foreign-key="#canonical"></field>
			<field name="processingActivities" type="OneToMany" ref="ProcessingActivity" authorization="authenticated" foreign-key="#canonical"></field>
			<field name="thirdParties" type="OneToMany" ref="ThirdParty" authorization="authenticated" foreign-key="#canonical"></field>
			<field name="integrations" type="OneToMany" ref="IntegrationImplementation" authorization="authenticated" foreign-key="#canonical"></field>
			<query graphql-namespace="Company" field-name="get" type="get" authorization="role" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="Company" field-name="filter" type="filter" authorization="role" role="administrator" use-canonical-search="true"></query>
			<custom-handler id="LCvx9K" sub-domain="Customer" aggregate="Company">#Your custom logic, you have access to:
#  The 'event' object
#  The 'snapshot' object
#  And the EntityManager
entity = EntityManager.get(type="Company", key=snapshot.arn)
entity.arn = snapshot.arn
entity.name = snapshot.name
entity.description = snapshot.description
entity.companySize = snapshot.companySize
entity.revenue = snapshot.revenue
entity.industryLink = list(set(snapshot.industryLink))
entity.countryArn = snapshot.countryArn
entity.controlFrameworkLink = list(set(snapshot.controlFrameworkLinks))
entity.logoPath = snapshot.logoPath
entity.businessUnits = [{
		"name": value["name"],
		"description": value["description"]
	}
	for value in snapshot.businessUnits.values()]
if snapshot.isDeleted != '':
    entity.mark_for_deletion = True</custom-handler>
		</view>
		<view name="Employee" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="username" type="String"></field>
			<field name="roles" type="String"></field>
			<field name="user" type="ManyToOne" ref="Profile" authorization="authenticated" foreign-key="username"></field>
			<snapshot-handler id="mvobEq" sub-domain="Customer" aggregate="Company" key-mapping="arn" processor="dictionary" dictionary="employees">
				<mapping target="arn" operand="set" value="arn"></mapping>
				<mapping target="username" operand="set" value="username"></mapping>
				<mapping operand="set" target="roles" value="roles"></mapping>
				<delete condition='#snapshot.isDeleted != ""' id="0IgYPJ"></delete>
				<delete id="OrNt1h" condition='#item.roles == "blocked"'></delete>
			</snapshot-handler>
			<custom-handler id="XUqTGK" sub-domain="Customer" aggregate="Company">for depricated in snapshot.deletedEmployeeArns:
    entity = EntityManager.get(type="Employee", key=depricated)
    entity.mark_for_deletion = True</custom-handler>
		</view>
		<view name="BusinessUnit" data-retention-days="-1" exclude-notification="false">
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
		</view>
		<view name="IntegrationImplementation" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="status" type="String"></field>
			<field name="requirements" type="String"></field>
			<field name="reference" type="String"></field>
			<field name="integration" type="OneToOne" ref="Integration" authorization="authenticated" foreign-key="reference"></field>
			<field name="notes" type="ObjectList" ref="ImplementationNote" authorization="authenticated"></field>
			<snapshot-handler id="aMI4Dz" processor="item" sub-domain="Customer" aggregate="IntegrationImplementation" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="status" value="status" operand="set"></mapping>
				<mapping target="requirements" value="requirements" operand="set"></mapping>
				<mapping target="reference" value="reference" operand="set"></mapping>
				<mapping operand="convert_items" target="notes" value="note" template='{ "uuid": value["uuid"] if "uuid" in value else "", "message": value["message"] if "message" in value else "", "user": value["user"] if "user" in value else "", "order": value["order"] if "order" in value else "", }'></mapping>
				<delete id="tCh4B3" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="Company.Integration" field-name="get" type="get" authorization="role" use-canonical-search="false" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="Company.Integration" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="ImplementationNote" data-retention-days="-1" exclude-notification="false">
			<field name="uuid" type="String"></field>
			<field name="message" type="String"></field>
			<field name="user" type="String"></field>
			<field name="order" type="Int"></field>
		</view>
		<view name="Industry" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<snapshot-handler id="RLB0hK" sub-domain="Admin" aggregate="Industry" key-mapping="arn" processor="item">
				<mapping target="arn" operand="set" value="arn"></mapping>
				<mapping target="name" operand="set" value="name"></mapping>
				<mapping target="description" operand="set" value="description"></mapping>
				<delete condition="#snapshot.isDeleted != ''" id="VM09RE"></delete>
			</snapshot-handler>
			<query graphql-namespace="Industry" field-name="get" type="get" authorization="authenticated"></query>
			<query graphql-namespace="Industry" field-name="filter" type="filter" authorization="authenticated"></query>
		</view>
		<view name="Region" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="code" type="String"></field>
			<field name="countries" type="OneToMany" ref="Country" authorization="authenticated" foreign-key="#canonical"></field>
			<snapshot-handler id="niRRoc" sub-domain="Admin" aggregate="Region" key-mapping="arn" processor="item">
				<mapping target="arn" operand="set" value="arn"></mapping>
				<mapping target="name" operand="set" value="name"></mapping>
				<mapping target="code" operand="set" value="code"></mapping>
				<delete condition="#snapshot.isDeleted != ''" id="BiHRJq"></delete>
			</snapshot-handler>
			<query graphql-namespace="Region" field-name="get" type="get" authorization="authenticated"></query>
			<query graphql-namespace="Region" field-name="filter" type="filter" authorization="authenticated" use-canonical-search="false"></query>
		</view>
		<view name="Task" data-retention-days="-1" exclude-notification="false">
			<field name="dueDate" type="String"></field>
			<field name="notes" type="String"></field>
			<field name="completeDate" type="String"></field>
			<field name="arn" type="String" pk="true"></field>
			<field name="owner" type="String" default=""></field>
			<field name="employee" type="ManyToOne" ref="Employee" authorization="authenticated" foreign-key="owner"></field>
			<field name="controlAssesment" type="OneToOne" ref="ControlAssessment" authorization="authenticated" foreign-key="arn"></field>
			<field name="riskAction" type="OneToOne" ref="RiskAction" authorization="authenticated" foreign-key="arn"></field>
			<field name="objectiveTask" type="OneToOne" ref="ObjectiveTask" authorization="authenticated" foreign-key="arn"></field>
			<field name="assetTask" type="OneToOne" ref="AssetTask" authorization="authenticated" foreign-key="arn"></field>
			<field name="processingActivityTask" type="OneToOne" ref="ProcessingActivityTask" authorization="authenticated" foreign-key="arn"></field>
			<field name="thirdPartyTask" type="OneToOne" ref="ThirdPartyTask" authorization="authenticated" foreign-key="arn"></field>
			<snapshot-handler id="EW0V9R" sub-domain="Customer" aggregate="Control" key-mapping="arn" processor="dictionary" dictionary="assessment">
				<mapping target="arn" operand="set" value="arn"></mapping>
				<mapping target="dueDate" operand="set" value="dueDate"></mapping>
				<mapping target="notes" operand="set" value="notes"></mapping>
				<mapping target="completeDate" operand="set" value="completeDate"></mapping>
				<mapping target="owner" operand="set" value="assessorLink"></mapping>
				<delete condition="#'completeDate' in item and item.completeDate != ''" id="XsPPOZ"></delete>
				<delete id="odxWpo" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<snapshot-handler id="t85l8k" sub-domain="Customer" aggregate="Risk" key-mapping="arn" processor="dictionary" dictionary="actions">
				<mapping target="arn" operand="set" value="arn"></mapping>
				<mapping target="dueDate" operand="set" value="dueDate"></mapping>
				<mapping target="notes" operand="set" value="notes"></mapping>
				<mapping target="completeDate" operand="set" value="completeDate"></mapping>
				<mapping target="owner" operand="set" value="assignee"></mapping>
				<delete condition="#'completeDate' in item and item.completeDate != ''" id="8GNMz6"></delete>
				<delete id="NO9YmL" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<snapshot-handler id="0MrAiD" processor="dictionary" sub-domain="Customer" aggregate="Objective" dictionary="task" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="owner" value="assignee" operand="set"></mapping>
				<mapping target="dueDate" value="dueDate" operand="set"></mapping>
				<mapping operand="set" target="completeDate" value="completeDate"></mapping>
				<mapping operand="set" target="notes" value="notes"></mapping>
				<delete id="58FLKq" condition="#'completeDate' in item and item.completeDate != ''"></delete>
				<delete id="fnui1T" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<snapshot-handler id="rTZxvR" processor="dictionary" sub-domain="Customer" aggregate="Asset" dictionary="task" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="owner" value="assignee" operand="set"></mapping>
				<mapping operand="set" target="completeDate" value="completeDate"></mapping>
				<mapping operand="set" target="notes" value="notes"></mapping>
				<mapping operand="set" target="dueDate" value="dueDate"></mapping>
				<delete id="KOn1z5" condition="#'completeDate' in item and item.completeDate != ''"></delete>
				<delete id="Uwyg7a" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<snapshot-handler id="Rl5PAE" processor="dictionary" sub-domain="Customer" aggregate="ProcessingActivity" dictionary="task" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="owner" value="assignee" operand="set"></mapping>
				<mapping operand="set" target="dueDate" value="dueDate"></mapping>
				<mapping operand="set" target="notes" value="notes"></mapping>
				<mapping operand="set" target="completeDate" value="completeDate"></mapping>
				<delete id="vfn7Cb" condition="#snapshot.isDeleted != ''"></delete>
				<delete id="vXemOW" condition="#'completeDate' in item and item.completeDate != ''"></delete>
			</snapshot-handler>
			<snapshot-handler id="Kxpodf" processor="dictionary" sub-domain="ThirdPartyManagement" aggregate="ThirdParty" dictionary="task" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="owner" value="assignee" operand="set"></mapping>
				<mapping operand="set" target="dueDate" value="dueDate"></mapping>
				<mapping operand="set" target="notes" value="notes"></mapping>
				<mapping operand="set" target="completeDate" value="completeDate"></mapping>
				<delete id="HCBHpE" condition="#snapshot.isDeleted != ''"></delete>
				<delete id="Sru7Uy" condition="#'completeDate' in item and item.completeDate != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="Task" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
			<query graphql-namespace="Task" field-name="get" type="get" authorization="role" role="#global.isCompanyViewer(key)"></query>
		</view>
		<view name="RiskTreatmentPlan" data-retention-days="-1" exclude-notification="false">
			<field name="type" type="String"></field>
			<field name="description" type="String"></field>
		</view>
		<view name="Risk" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String" pk="true"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="grossLikelihood" type="Int"></field>
			<field name="grossImpact" type="Int"></field>
			<field name="apetiteLikelihood" type="Int"></field>
			<field name="apetiteImpact" type="Int"></field>
			<field name="reviewPeriodicity" type="String"></field>
			<field name="lastReviewDate" type="String"></field>
			<field name="nextReviewDate" type="String"></field>
			<field name="changeLog" type="ObjectList" ref="ChangeLog" authorization="authenticated" foreign-key="arn"></field>
			<field name="controlLinks" type="ObjectList" ref="RiskControlLink" authorization="authenticated" foreign-key="arn"></field>
			<field name="treatmentPlan" type="ObjectList" ref="RiskTreatmentPlan" authorization="authenticated" foreign-key="arn"></field>
			<field name="actions" type="OneToMany" ref="RiskAction" authorization="authenticated" foreign-key="#canonical"></field>
			<field name="hasPendingSelfAssessment" type="Boolean"></field>
			<field name="owner" type="String"></field>
			<snapshot-handler id="W1dR2k" processor="item" sub-domain="Customer" aggregate="Risk" key-mapping="arn">
				<mapping target="arn" value="arn" operand="set"></mapping>
				<mapping target="name" value="name" operand="set"></mapping>
				<mapping target="description" value="description" operand="set"></mapping>
				<mapping target="grossLikelihood" value="grossLikelihood" operand="set"></mapping>
				<mapping target="grossImpact" value="grossImpact" operand="set"></mapping>
				<mapping target="apetiteLikelihood" value="apetiteLikelihood" operand="set"></mapping>
				<mapping target="apetiteImpact" value="apetiteImpact" operand="set"></mapping>
				<mapping target="reviewPeriodicity" value="reviewPeriodicity" operand="set"></mapping>
				<mapping target="lastReviewDate" value="lastReviewDate" operand="set"></mapping>
				<mapping target="nextReviewDate" value="nextReviewDate" operand="set"></mapping>
				<mapping target="hasPendingSelfAssessment" value="hasPendingSelfAssessment" operand="set"></mapping>
				<mapping target="changeLog" value="changeLog" operand="convert_items" template='{ "timestamp": value["timestamp"] if "timestamp" in value else "", "description": value["description"] if "description" in value else "", "user": value["user"] if "user" in value else "", "userProfile": value[""] if "" in value else "", }'></mapping>
				<mapping target="controlLinks" value="controlLinks" operand="convert_items" template='{ "arn": value["arn"] if "arn" in value else "", "impactOnRisk": value["impactOnRisk"] if "impactOnRisk" in value else "", "control": value[""] if "" in value else "", }'></mapping>
				<mapping target="treatmentPlan" value="treatmentPlan" operand="convert_items" template='{ "type": value["type"] if "type" in value else "", "description": value["description"] if "description" in value else "", }'></mapping>
				<mapping operand="set" target="owner" value="owner"></mapping>
				<delete id="XPh413" condition="#snapshot.isDeleted != ''"></delete>
			</snapshot-handler>
			<query graphql-namespace="Risk" field-name="get" type="get" authorization="role" role="#global.isCompanyViewer(key)"></query>
			<query graphql-namespace="Risk" field-name="filter" type="filter" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
		<view name="ChangeLog" data-retention-days="-1" exclude-notification="false">
			<field name="timestamp" type="String"></field>
			<field name="description" type="String"></field>
			<field name="user" type="String"></field>
			<field name="userProfile" type="ManyToOne" ref="Profile" authorization="authenticated" foreign-key="user"></field>
		</view>
		<view name="RiskControlLink" data-retention-days="-1" exclude-notification="false">
			<field name="arn" type="String"></field>
			<field name="impactOnRisk" type="Int"></field>
			<field name="control" type="OneToMany" ref="Control" authorization="authenticated" foreign-key="arn"></field>
		</view>
		<view name="RiskAction" data-retention-days="-1" exclude-notification="false">
			<field name="id" type="String"></field>
			<field name="name" type="String"></field>
			<field name="description" type="String"></field>
			<field name="assignee" type="String"></field>
			<field name="dueDate" type="String"></field>
			<field name="completeDate" type="String"></field>
			<field name="arn" type="String" pk="true"></field>
			<field name="notes" type="String"></field>
			<snapshot-handler id="bjg9nZ" sub-domain="Customer" aggregate="Risk" key-mapping="arn" processor="dictionary" dictionary="actions">
				<mapping target="name" operand="set" value="name"></mapping>
				<mapping target="description" operand="set" value="description"></mapping>
				<mapping target="arn" operand="set" value="arn"></mapping>
				<mapping target="id" operand="set" value="id"></mapping>
				<mapping target="assignee" operand="set" value="assignee"></mapping>
				<mapping target="dueDate" operand="set" value="dueDate"></mapping>
				<mapping target="completeDate" operand="set" value="completeDate"></mapping>
				<mapping operand="set" target="notes" value="notes"></mapping>
				<delete condition="#snapshot.isDeleted != ''" id="cVkGGO"></delete>
			</snapshot-handler>
			<query graphql-namespace="Risk" field-name="getActions" type="query" authorization="role" use-canonical-search="true" role="#global.isCompanyViewer(key_begins_with)"></query>
		</view>
	</views>
	<projections>
		<projection graphql-namespace="Control" field-name="fetchEligible" authorization="role" return="Control" name="FetchEligibleControl" code='from draftsman.ViewStoreApi import Query|LB|from datetime import date, datetime|LB|from math import ceil|LB|from dateutil.relativedelta import relativedelta|LB||LB||LB|def transform(arguments, username):|LB|    # You have access to the username of the requestor and the arguments.|LB|    print(f"Fetch eligible controls [{arguments}/{username}]")|LB|    relative = float(arguments["relativeTime"])|LB|    result = []|LB|    today = date.today()|LB|    items = Query("Control").get_items(filter_chain_method="or").not_exists("hasPendingSelfAssessment").equals("hasPendingSelfAssessment", False).run()|LB|    |LB|    print(items)|LB|    for item in items:|LB|        try:|LB|            next = datetime.strptime(item["nextAssessmentDate"], "%Y-%m-%d")|LB|            periodicity = item["assessmentPeriodicity"]|LB|    |LB|            if periodicity.endswith("D"):|LB|                days = ceil(int(periodicity.replace("D", "")) / relative)|LB|                delta = relativedelta(days=days)|LB|            elif periodicity.endswith("M"):|LB|                weeks = ceil(int(periodicity.replace("M", "")) * 4 / relative)|LB|                delta = relativedelta(weeks=weeks)|LB|            elif periodicity.endswith("Y"):|LB|                months = ceil(int(periodicity.replace("Y", "")) * 12 / relative)|LB|                delta = relativedelta(months=months)|LB|    |LB|            reminder_date = next - delta|LB|            if reminder_date.date() &lt;= today:|LB|                result.append(item)|LB|        except KeyError:|LB|            result.append(item)|LB||LB|    return result|LB|' return-type="result set" role="administrator">
			<input name="relativeTime" type="String" required="true"></input>
		</projection>
		<projection graphql-namespace="Profile" return-type="result set" field-name="search" authorization="authenticated" return="Profile" name="SearchProfile" code="|LB|from draftsman.ViewStoreApi import Query|LB||LB||LB|def transform(arguments, username):|LB|    |LB|    print(f&quot;Handle graph request [{arguments}/{username}]&quot;)|LB|    search = arguments[&quot;searchString&quot;]|LB|    |LB|    query = Query('User').get_items()|LB|    for word in search.lower().split(&quot; &quot;):|LB|        query = query.contains(&quot;searchIndex&quot;,word)|LB|    results = query.run()|LB||LB|    return [{|LB|        &quot;key&quot;: result[&quot;username&quot;],|LB|        &quot;username&quot;: result[&quot;username&quot;],|LB|        &quot;firstName&quot;: result[&quot;firstName&quot;],|LB|        &quot;lastName&quot;: result[&quot;lastName&quot;]|LB|    } for result in results]">
			<input name="searchString" type="String" required="true"></input>
		</projection>
		<projection graphql-namespace="Risk" field-name="fetchEligible" authorization="role" return="Risk" name="FetchEligibleRisk" code='from draftsman.ViewStoreApi import Query|LB|from datetime import date, datetime|LB|from math import ceil|LB|from dateutil.relativedelta import relativedelta|LB||LB||LB|def transform(arguments, username):|LB|    # You have access to the username of the requestor and the arguments.|LB|    print(f"Fetch eligible risks [{arguments}/{username}]")|LB|    relative = float(arguments["relativeTime"])|LB|    result = []|LB|    today = date.today()|LB|    items = Query("Risk").get_items(filter_chain_method="or").not_exists("hasPendingSelfAssessment").equals("hasPendingSelfAssessment", False).run()|LB|    |LB|    print(items)|LB|    for item in items:|LB|        try:|LB|            next = datetime.strptime(item["nextAssessmentDate"], "%Y-%m-%d")|LB|            periodicity = item["assessmentPeriodicity"]|LB|    |LB|            if periodicity.endswith("D"):|LB|                days = ceil(int(periodicity.replace("D", "")) / relative)|LB|                delta = relativedelta(days=days)|LB|            elif periodicity.endswith("M"):|LB|                weeks = ceil(int(periodicity.replace("M", "")) * 4 / relative)|LB|                delta = relativedelta(weeks=weeks)|LB|            elif periodicity.endswith("Y"):|LB|                months = ceil(int(periodicity.replace("Y", "")) * 12 / relative)|LB|                delta = relativedelta(months=months)|LB|    |LB|            reminder_date = next - delta|LB|            if reminder_date.date() &lt;= today:|LB|                result.append(item)|LB|        except KeyError:|LB|            result.append(item)|LB||LB|    return result|LB|' return-type="result set" role="administrator">
			<input name="relativeTime" type="String" required="true"></input>
		</projection>
	</projections>
	<notifiers>
		<notifier name="SetupEnvironment">
			<trigger source="@afterDeployment">
				<mapping target="dummy" value="#''"></mapping>
			</trigger>
			<activity type="iam-create-systemuser" fail-silent="true" id="vMB9LZ"></activity>
			<activity id="vkYuPh" type="create-iam-group" group-name="#'administrator'" fail-silent="true"></activity>
			<activity id="wjJU3t" group-name="#'administrator'" type="add-user-to-iam-group" username="#'system-user'" fail-silent="true"></activity>
		</notifier>
		<notifier name="SendInvite">
			<trigger source="UserAddedToCompany">
				<mapping target="username" value="username"></mapping>
				<mapping target="active" value="active"></mapping>
			</trigger>
			<activity type="code" id="HZNTTw" code='flow.eligible = flow.active == False and "@" in flow.username|LB|flow.sender = "no-reply@draftsman.io"|LB|flow.receiver = flow.username|LB|flow.subject = "Colleagues are reaching out in Anove"|LB|flow.text = "Create an account at https://anovedemo.github.io"|LB|flow.html = flow.text'></activity>
			<activity type="send-email" id="2wJ6Y9" condition="flow.eligible" sender="no-reply@draftsman.io" receiver="#flow.receiver" subject="#flow.subject" text="#flow.text" html="#flow.html"></activity>
		</notifier>
		<notifier name="RemoveRequirements">
			<trigger source="ControlFrameworkDeleted">
				<mapping target="arn" value="arn"></mapping>
			</trigger>
			<activity id="nN6YNp" type="call-internal-api" name="requirements" query='query MyQuery {|LB|  Requirement {|LB|    filter(limit: 1000, key_begins_with: "{{flow.arn}}") {|LB|      resultset {|LB|        arn|LB|      }|LB|    }|LB|  }|LB|}|LB|'></activity>
			<activity id="TdMlHz" type="code" code='flow.requirements = flow.requirements["data"]["Requirement"]["filter"]["resultset"]'></activity>
			<activity id="wzK8fL" type="loop" array="#flow.requirements">
				<activity id="lIb7lS" type="set-variable" name="requirement" expression='#item["arn"]'></activity>
				<activity id="l6t8zz" name="result" type="call-internal-api" query='mutation MyMutation {|LB|  Requirement {|LB|    delete(input: {arn: "{{flow.requirement}}"}) {|LB|      correlationId|LB|    }|LB|  }|LB|}|LB|'></activity>
			</activity>
		</notifier>
		<notifier name="PrepareCompanyTenant">
			<trigger source="CompanyCreated" idempotency-key="arn user">
				<mapping target="arn" value="arn"></mapping>
				<mapping target="user" value="user"></mapping>
			</trigger>
			<activity type="code" id="4x5IYY" python-file="lib/AccessManagement.py" handler="retrieve_all_roles" condition=""></activity>
			<activity type="set-variable" id="9V4dG1" name="systemUser" expression="#'system-user'"></activity>
			<activity type="loop" id="ytmySk" array="#flow.roles">
				<activity type="set-variable" id="ILrv7Y" name="role" expression="#item"></activity>
				<activity type="add-user-to-iam-group" id="dri70C" group-name="#flow.role" username="#flow.user"></activity>
				<activity type="add-user-to-iam-group" id="jBKEw3" group-name="#flow.role" username="#flow.systemUser"></activity>
			</activity>
		</notifier>
		<notifier name="PrepareSelfAssessments">
			<trigger source="@cron(0 4 * * ? *)">
				<mapping target="dummy" value="#''"></mapping>
			</trigger>
			<activity type="call-internal-api" id="fVAjtj" name="controls" query='query fetchEligible {|LB|  Control {|LB|    fetchEligible(relativeTime: "4") {|LB|      arn|LB|    }|LB|  }|LB|  Risk{|LB|    fetchEligible(relativeTime: "4") {|LB|      arn|LB|    }|LB|  }|LB|}'></activity>
			<activity type="set-variable" id="1tXPhr" name="risks" expression="#flow.controls['data']['Risk']['fetchEligible']"></activity>
			<activity type="set-variable" id="GyOmpH" name="controls" expression="#flow.controls['data']['Control']['fetchEligible']"></activity>
			<activity type="loop" id="1COpan" array="#flow.controls">
				<activity type="set-variable" id="UZ496m" name="arn" expression='#item["arn"]'></activity>
				<activity type="call-internal-api" id="DCAhOj" name="result" query='mutation MyMutation {|LB|  Company {|LB|    Control {|LB|      Assessment {|LB|        start(input: {controlArn: "{{flow.arn}}"}) {|LB|          correlationId|LB|        }|LB|      }|LB|    }|LB|  }|LB|}|LB|'></activity>
			</activity>
			<activity type="loop" id="HrZYiF" array="#flow.risks">
				<activity type="set-variable" id="9kkOIw" name="arn" expression='#item["arn"]'></activity>
				<activity type="call-internal-api" id="fYj4t7" name="result" query='mutation MyMutation {|LB|  Company {|LB|    Risk {|LB|        startAssessment(input: {arn: "{{flow.arn}}"}) {|LB|          correlationId|LB|        }|LB|      }|LB|  }|LB|}|LB|'></activity>
			</activity>
		</notifier>
		<notifier name="FileIntake">
			<trigger source="FileUploaded">
				<mapping target="bucket" value="bucket"></mapping>
				<mapping target="uri" value="uri"></mapping>
				<mapping target="location" value="location"></mapping>
				<mapping target="username" value="username"></mapping>
			</trigger>
			<activity id="1rLFCB" type="code" code="import re|LB||LB|flow.key = flow.uri.split(&quot;/&quot;)[1]|LB||LB|# Case: if it is a tenant css|LB|if re.match(&quot;^[a-z]+$&quot;,flow.key) and flow.uri.endswith(&quot;custom.css&quot;):|LB|    flow.group = &quot;administrator&quot;|LB|    flow.type = &quot;tenant-css&quot;|LB|# Case: if it is a tenant logo|LB|elif re.match(&quot;^[a-z]+$&quot;, flow.key) and flow.uri.endswith(&quot;/logo.png&quot;):|LB|    flow.group = &quot;administrator&quot;|LB|    flow.type = &quot;tenant-logo&quot;|LB|# Case: if it is a integration logo|LB|elif re.match(&quot;^integration:[a-z]+$&quot;, flow.key) and flow.uri.endswith(&quot;/logo.png&quot;):|LB|    flow.group = &quot;administrator&quot;|LB|    flow.type = &quot;integration-logo&quot;|LB|# Case: if it is a company logo|LB|elif re.match(&quot;^[a-z]+:company:[a-z]+$&quot;,flow.key) and flow.uri.endswith(&quot;/logo.png&quot;):|LB|    flow.group = flow.key + &quot;:administrator&quot;|LB|    flow.type = &quot;company-logo&quot;|LB|# Case: unknown file|LB|else:|LB|    raise ValueError('Unanticipated file path')|LB|    |LB|# Check if the user has the correct authorization|LB|if not Cognito.check_if_user_is_in_group(flow.group,flow.username):|LB|    raise ValueError(&quot;User has not the correct authorization &quot; + flow.group +&quot; is needed.&quot;)|LB|    |LB|# Check if the correct bucket was selected|LB|if not &quot;-web-&quot; in flow.bucket:|LB|    raise ValueError(&quot;This function only reacts to public uploads.&quot;)"></activity>
			<activity id="VXkcOJ" type="call-internal-api" name="result" condition='#flow.type == "tenant-css"' query='mutation MyMutation {|LB|  Tenant {|LB|    linkStyleSheet(input: {reference: "{{flow.key}}", path: "{{flow.uri}}"}) {|LB|      correlationId|LB|    }|LB|  }|LB|}|LB|'></activity>
			<activity id="261TdC" type="call-internal-api" name="result" condition='#flow.type == "company-logo"' query='mutation MyMutation {|LB|  Company {|LB|    linkLogo(input: {arn: "{{flow.key}}", path: "{{flow.uri}}"}) {|LB|      correlationId|LB|    }|LB|  }|LB|}|LB|'></activity>
			<activity id="qje8I4" type="call-internal-api" name="result" condition='#flow.type == "tenant-logo"' query='mutation MyMutation {|LB|  Tenant {|LB|    linkLogo(input: {reference: "{{flow.key}}", path: "{{flow.uri}}"}) {|LB|      correlationId|LB|    }|LB|  }|LB|}|LB|'></activity>
			<activity id="5EJyUU" type="call-internal-api" condition='#flow.type == "integration-logo"' name="result" query='mutation MyMutation {|LB|  Integrations {|LB|    linkLogo(input: {reference: "{{flow.key}}", path: "{{flow.uri}}"}) {|LB|      correlationId|LB|    }|LB|  }|LB|}|LB|'></activity>
		</notifier>
		<notifier name="SetupDemo">
			<trigger source="@cron(0 * * * ? *)">
				<mapping target="dummy" value="#'dummy'"></mapping>
			</trigger>
			<activity type="set-variable" id="6fz0Yx" name="role" expression="#'administrator'"></activity>
			<activity type="create-iam-group" id="kj95dD" group-name="#flow.role" fail-silent="true"></activity>
			<activity type="set-variable" id="CqaYqy" name="bo" expression="#'hanssen'" fail-silent="false"></activity>
			<activity type="set-variable" id="We51UX" name="delano" expression="#'delano'"></activity>
			<activity type="add-user-to-iam-group" id="bLO2pB" group-name="#flow.role" username="#flow.bo" fail-silent="true"></activity>
			<activity type="add-user-to-iam-group" id="CvSj37" group-name="#flow.role" username="#flow.delano" fail-silent="true"></activity>
		</notifier>
		<notifier name="InitializeSystemUser">
			<trigger source="@afterDeployment">
				<mapping target="dummy" value="#''"></mapping>
			</trigger>
			<activity type="iam-create-systemuser" fail-silent="true" id="vMB9LZ"></activity>
		</notifier>
		<notifier name="CreateThirdpartyFromTemplate">
			<trigger source="CreateFromTemplateCompanyThirdPartyRequested">
				<mapping target="arn" value="arn"></mapping>
				<mapping target="role" value="role"></mapping>
				<mapping target="isCritical" value="isCritical"></mapping>
				<mapping target="isDirectThirdParty" value="isDirectThirdParty"></mapping>
				<mapping target="owner" value="owner"></mapping>
				<mapping target="templateArn" value="templateArn"></mapping>
			</trigger>
			<activity id="pa6G5b" type="call-internal-api" name="template" query='query MyQuery { |LB|  ThirdPartyTemplate { |LB|    get(key: "{{flow.templateArn}}") { |LB|      address |LB|      companyRegistrationNumber |LB|      countryArn |LB|      description |LB|      knownCertification |LB|      name |LB|    } |LB|  } |LB|}'></activity>
			<activity id="pZl1cV" name="template" type="code" code='flow.template = flow.template["data"]["ThirdPartyTemplate"]["get"]'></activity>
			<activity id="XqnuXQ" type="call-internal-api" query='mutation MyMutation { |LB|  Company { |LB|    ThirdParty { |LB|      create(input: { |LB|         arn: "{{flow.arn}}",  |LB|         name: "{{template.name}}",  |LB|         description: "{{template.description}}",  |LB|         role: "{{flow.role}}",  |LB|         address: "{{template.addres}}",  |LB|         companyRegistrationNumber: "{{template.companyRegistrationNumber}}",  |LB|         country: "{{template.country}}",  |LB|         knownCertification: "{{template.knownCertification}}",  |LB|         isCritical: {{flow.isCritical}},  |LB|          isDirectThirdParty: {{flow.isDirectThirdParty}},  |LB|            owner: "{{flow.owner}}"}) { |LB|        correlationId |LB|      } |LB|    } |LB|  } |LB|} |LB|' name="result"></activity>
		</notifier>
		<notifier name="CleanupTenant">
			<trigger source="TenantDeleted">
				<mapping target="key" value="key"></mapping>
			</trigger>
			<activity id="ptfmT5" type="call-internal-api" query='query MyQuery {|LB|  Company {|LB|    filter(key_begins_with: "{{flow.key}}", limit: 1000) {|LB|      resultset {|LB|        arn|LB|      }|LB|    }|LB|  }|LB|}|LB|' name="targets"></activity>
			<activity id="cJdBq0" type="code" code='flow.targets = flow.targets["data"]["Company"]["filter"]["resultset"]'></activity>
			<activity id="n2nU6x" type="loop" array="#flow.targets">
				<activity id="DqbO1s" type="set-variable" name="target" expression='#item["arn"]'></activity>
				<activity id="dAqffj" name="result" type="call-internal-api" fail-silent="true" query='mutation MyMutation {|LB|  Company {|LB|    delete(input: {arn: "{{flow.target}}"}) {|LB|      correlationId|LB|    }|LB|  }|LB|}'></activity>
				<activity id="2W29aE" type="call-internal-api" fail-silent="true" name="result" query='mutation MyMutation {|LB|  triggerSnapshot(aggregate: "Customer-Company", identifier: "{{flow.target}}")|LB|}|LB|'></activity>
			</activity>
		</notifier>
		<notifier name="CleanupCompany">
			<trigger source="CompanyDeleted">
				<mapping target="arn" value="arn"></mapping>
			</trigger>
			<activity id="BZjwmj" type="call-internal-api" query='query MyQuery {|LB|  Control {|LB|    filter(key_begins_with: "{{flow.arn}}", limit: 1000) {|LB|      resultset {|LB|        arn|LB|      }|LB|    }|LB|  }|LB|  Objective {|LB|    filter(key_begins_with: "{{flow.arn}}", limit: 1000) {|LB|      resultset {|LB|        arn|LB|      }|LB|    }|LB|  }|LB|  Risk {|LB|    filter(key_begins_with: "{{flow.arn}}", limit: 1000) {|LB|      resultset {|LB|        arn|LB|      }|LB|    }|LB|  }|LB|  Asset {|LB|    filter(key_begins_with: "{{flow.arn}}", limit: 1000) {|LB|      resultset {|LB|        arn|LB|      }|LB|    }|LB|  }|LB|  ProcessingActivity {|LB|    filter(key_begins_with: "{{flow.arn}}", limit: 1000) {|LB|      resultset {|LB|        arn|LB|      }|LB|    }|LB|  }|LB|  ThirdParty {|LB|    filter(key_begins_with: "{{flow.arn}}", limit: 1000) {|LB|      resultset {|LB|        arn|LB|      }|LB|    }|LB|  }|LB|  Questionaire {|LB|    filter(key_begins_with: "{{flow.arn}}", limit: 1000) {|LB|      resultset {|LB|        arn|LB|      }|LB|    }|LB|  }|LB|  Company {|LB|    Integration {|LB|      filter(key_begins_with: "{{flow.arn}}", limit: 1000) {|LB|        resultset {|LB|          arn|LB|        }|LB|      }|LB|    }|LB|  }|LB|}|LB|' name="targets"></activity>
			<activity id="ggeHO1" type="code" code='flow.controls = flow.targets["data"]["Control"]["filter"]["resultset"]|LB|flow.objectives = flow.targets["data"]["Objective"]["filter"]["resultset"]|LB|flow.risks = flow.targets["data"]["Risk"]["filter"]["resultset"]|LB|flow.assets = flow.targets["data"]["Asset"]["filter"]["resultset"]|LB|flow.activities = flow.targets["data"]["ProcessingActivity"]["filter"]["resultset"]|LB|flow.thirdparties = flow.targets["data"]["ThirdParty"]["filter"]["resultset"]|LB|flow.assessments = flow.targets["data"]["Questionaire"]["filter"]["resultset"]|LB|flow.integrations = flow.targets["data"]["Company"]["Integration"]["filter"]["resultset"]'></activity>
			<activity id="sNkg3D" name="arn" type="loop" array="#flow.controls">
				<activity id="uEmbqD" type="set-variable" name="target" expression='#item["arn"]'></activity>
				<activity id="tEatHG" type="call-internal-api" query='mutation MyMutation {|LB|  Company {|LB|    Control {|LB|      delete(input: {arn: "{{flow.target}}"}) {|LB|        correlationId|LB|      }|LB|    }|LB|  }|LB|}|LB|' name="result" fail-silent="true"></activity>
			</activity>
			<activity id="ZHQisW" name="target" type="loop" array="#flow.objectives">
				<activity id="MtIviu" type="set-variable" name="target" expression='#item["arn"]'></activity>
				<activity id="dNENbH" type="call-internal-api" query='mutation MyMutation {|LB|  Company {|LB|    Objective {|LB|      delete(input: {arn: "{{flow.target}}"}) {|LB|        correlationId|LB|      }|LB|    }|LB|  }|LB|}|LB|' name="result" fail-silent="true"></activity>
			</activity>
			<activity id="BsoyUj" type="loop" array="#flow.risks">
				<activity id="kTXi1w" name="target" type="set-variable" expression='#item["arn"]'></activity>
				<activity id="bYhvcI" type="call-internal-api" query='mutation MyMutation {|LB|  Company {|LB|    Risk {|LB|      delete(input: {arn: "{{flow.target}}"}) {|LB|        correlationId|LB|      }|LB|    }|LB|  }|LB|}|LB|' name="result" fail-silent="true"></activity>
			</activity>
			<activity id="4u2lz9" type="loop" array="#flow.assets">
				<activity id="DXz7QQ" type="set-variable" name="target" expression='#item["arn"]'></activity>
				<activity id="vy7tik" name="result" type="call-internal-api" fail-silent="true" query='mutation MyMutation {|LB|  Company {|LB|    Asset {|LB|      delete(input: {arn: "{{flow.target}}"}) {|LB|        correlationId|LB|      }|LB|    }|LB|  }|LB|}|LB|'></activity>
			</activity>
			<activity id="JXKwS0" type="loop" array="#flow.activities">
				<activity id="JXTtzp" type="set-variable" name="target" expression='#item["arn"]'></activity>
				<activity id="EcGxRT" name="result" type="call-internal-api" fail-silent="true" query='mutation MyMutation {|LB|  Company {|LB|    ProcessingActivity {|LB|      delete(input: {arn: "{{flow.target}}"}) {|LB|        correlationId|LB|      }|LB|    }|LB|  }|LB|}|LB|'></activity>
			</activity>
			<activity id="rQ2t9f" type="loop" array="#flow.thirdparties">
				<activity id="TjvslX" type="set-variable" name="target" expression='#item["arn"]'></activity>
				<activity id="0tnvYS" name="result" type="call-internal-api" query='mutation MyMutation {|LB|  Company {|LB|    ThirdParty {|LB|      delete(input: {arn: "{{flow.target}}"}) {|LB|        correlationId|LB|      }|LB|    }|LB|  }|LB|}|LB|' fail-silent="true"></activity>
			</activity>
			<activity id="4YUP2d" type="loop" array="#flow.assessments">
				<activity id="sSRBJx" type="set-variable" name="target" expression='#item["arn"]'></activity>
				<activity id="xHcCjO" name="result" type="call-internal-api" fail-silent="true" query='mutation MyMutation {|LB|  Company {|LB|    ThirdParty {|LB|      Assessment {|LB|        delete(input: {arn: "{{flow.target}}"}) {|LB|          correlationId|LB|        }|LB|      }|LB|    }|LB|  }|LB|}|LB|'></activity>
			</activity>
			<activity id="h4nnoW" type="loop" array="#flow.integrations">
				<activity id="vPs5ZZ" type="set-variable" name="target" expression='#item["arn"]'></activity>
				<activity id="m0ucqs" name="result" type="call-internal-api" fail-silent="true" query='mutation MyMutation {|LB|  Company {|LB|    IntegrationImplementation {|LB|      delete(input: {arn: "{{flow.target}}"}) {|LB|        correlationId|LB|      }|LB|    }|LB|  }|LB|}|LB|'></activity>
			</activity>
		</notifier>
		<notifier name="UpdateAccessForEmployee">
			<trigger source="RolesUpdated">
				<mapping target="arn" value="employeeArn"></mapping>
				<mapping target="roleset" value="roles"></mapping>
			</trigger>
			<trigger source="EmployeeArnUpdated">
				<mapping target="arn" value="employeeArn"></mapping>
				<mapping target="roleset" value="roles"></mapping>
			</trigger>
			<activity type="set-variable" id="IFN8ne" name="username" expression='#flow.arn.split(":")[-1]'></activity>
			<activity type="code" id="q26CJL" python-file="lib/AccessManagement.py" handler="retrieve_not_granted_roles"></activity>
			<activity type="loop" id="rMzheY" array="#flow.roles">
				<activity type="set-variable" id="FJN6tv" name="role" expression="#item"></activity>
				<activity type="remove-user-from-iam-group" id="dlyKQu" group-name="#flow.role" username="#flow.username" fail-silent="true"></activity>
			</activity>
			<activity type="code" id="cp3AMN" python-file="lib/AccessManagement.py" handler="retrieve_granted_roles"></activity>
			<activity type="loop" id="XZC39S" array="#flow.roles">
				<activity type="set-variable" id="p0OpGd" name="role" expression="#item"></activity>
				<activity type="add-user-to-iam-group" id="XBvRzc" group-name="#flow.role" username="#flow.username" fail-silent="true"></activity>
			</activity>
		</notifier>
		<notifier name="CreateRiskFromTemplate">
			<trigger source="CreateFromTemplateCompanyRiskRequested">
				<mapping target="arn" value="arn"></mapping>
				<mapping target="templateArn" value="template"></mapping>
				<mapping target="apetiteLikelihood" value="apetiteLikelihood"></mapping>
				<mapping target="apetiteImpact" value="apetiteImpact"></mapping>
				<mapping target="nextReviewDate" value="nextReviewDate"></mapping>
				<mapping target="owner" value="owner"></mapping>
			</trigger>
			<activity id="lSyHrc" type="call-internal-api" query='query MyQuery {|LB|  RiskTemplate {|LB|    get(key: "{{flow.templateArn}}") {|LB|      description|LB|      grossImpact|LB|      grossLikelihood|LB|      name|LB|      reviewPeriodicity|LB|    }|LB|  }|LB|}|LB|' name="template"></activity>
			<activity id="E9gGZK" type="code" code='flow.template = flow.template["data"]["RiskTemplate"]'></activity>
			<activity id="SShzI4" type="call-internal-api" query='mutation MyMutation {|LB|  Company {|LB|    Risk {|LB|      create(input: {|LB|         arn: "{{flow.arn}}", |LB|         name: "{{flow.template.get.name}}", |LB|         description: "{{flow.template.get.description}}", |LB|         grossLikelihood: {{flow.template.get.grossLikelihood}}, |LB|         grossImpact: {{flow.template.get.grossImpact}}, |LB|         apetiteLikelihood: {{flow.apetiteLikelihood}}, |LB|         apetiteImpact: {{flow.apetiteImpact}}, |LB|         reviewPeriodicity: "{{flow.template.get.reviewPeriodicity}}", |LB|         nextReviewDate: "{{flow.nextReviewDate}}", |LB|         owner: "{{flow.owner}}",|LB|         controlLinks: [], |LB|         treatmentPlan: []}) {|LB|        correlationId|LB|      }|LB|    }|LB|  }|LB|}|LB|' name="result"></activity>
		</notifier>
		<notifier name="CreateControlFromTemplate">
			<trigger source="CreateFromTemplateCompanyControlRequested">
				<mapping target="controlTemplateReference" value="controlTemplateReference"></mapping>
				<mapping target="desiredMaturityLevel" value="desiredMaturityLevel"></mapping>
				<mapping target="businessUnit" value="businessUnit"></mapping>
				<mapping target="companyArn" value="companyArn"></mapping>
				<mapping target="nextAssessmentDate" value="nextAssessmentDate"></mapping>
				<mapping target="controlOwner" value="controlOwner"></mapping>
			</trigger>
			<activity id="Evzz4c" type="call-internal-api" query='query MyQuery {|LB|  ControlTemplate {|LB|    get(key: "{{flow.controlTemplateReference}}") {|LB|      assessmentPeriodicity|LB|      description|LB|      name|LB|      requirementArns|LB|      templateVersion|LB|    }|LB|  }|LB|}' name="template"></activity>
			<activity id="cdvkN3" type="call-internal-api" query='query MyQuery {|LB|  Company {|LB|    get(key: "{{flow.companyArn}}") {|LB|      controlframework {|LB|        requirements {|LB|          arn|LB|        }|LB|      }|LB|    }|LB|  }|LB|}' name="eligibleRequirements"></activity>
			<activity id="lP31Pu" type="code" code='flow.template = flow.template["data"]["ControlTemplate"]|LB|flow.requirements = []|LB|for x in flow.eligibleRequirements["data"]["Company"]["get"]["controlframework"]:|LB|    for y in x["requirements"]:|LB|        flow.requirements.append(y["arn"])|LB|flow.links = ";".join(|LB|    [|LB|        x|LB|        for x in flow.template["get"]["requirementArns"]|LB|        if x in flow.requirements|LB|    ]|LB|)'></activity>
			<activity id="CwIsmb" type="call-internal-api" query='mutation MyMutation {|LB|  Company {|LB|    Control {|LB|      create(input: {name: "{{flow.template.get.name}}", description: "{{flow.template.get.description}}", assessmentPeriodicity: "{{flow.template.get.assessmentPeriodicity}}", desiredMaturityLevel: {{flow.desiredMaturityLevel}}, businessUnit: "{{flow.businessUnit}}", companyArn: "{{flow.companyArn}}", requirements: "{{flow.links}}", nextAssessmentDate: "{{flow.nextAssessmentDate}}", controlOwner: "{{flow.controlOwner}}", controlTemplateArn: "{{flow.controlTemplateReference}}"}) {|LB|        correlationId|LB|      }|LB|    }|LB|  }|LB|}|LB|' name="result"></activity>
		</notifier>
		<notifier name="SendIntegrationRequest">
			<trigger source="IntegrationImplementationCreated">
				<mapping target="arn" value="arn"></mapping>
				<mapping target="status" value="status"></mapping>
				<mapping target="requirements" value="requirements"></mapping>
				<mapping target="reference" value="reference"></mapping>
			</trigger>
			<activity id="wh4BxE" type="code" code='flow.sender = "no-reply@draftsman.io"|LB|flow.receiver = "anove-support@endtest-mail.io"|LB|flow.subject = "New integration request"|LB|flow.text = "There is a new integration request: " + flow.arn|LB|flow.text += "\nIt references: " + flow.reference|LB|flow.text += "\n\n" + flow.requirements|LB|flow.html = flow.text'></activity>
			<activity id="6zksDm" type="send-email" receiver="#flow.receiver" subject="#flow.subject" text="#flow.text" html="#flow.html" sender="no-reply@draftsman.io"></activity>
		</notifier>
	</notifiers>
	<functional-scenarios clean-db="true" clean-iam="true" minimum-event-coverage="100" minimum-view-coverage="100">
		<scenario name="ControlTemplate" extends="CreateAdministrator">
			<activity path="ControlTemplate.create" description="Create a control template" type="mutation" id="LEVllJ">
				<input name="name" type="String" value="myTemplate"></input>
				<input name="description" type="String" value="Hello World!"></input>
				<input name="assessmentPeriodicity" type="String" value="1Y"></input>
				<input name="requirementLinks" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr:10;controlframework:eugeneraldataprotectionregulationgdpr:ab"></input>
				<input name="arn" type="String" value="controltemplate:mytemplate"></input>
				<expected-trace command="Admin.ControlTemplate.Create" status="success"></expected-trace>
			</activity>
			<activity path="ControlTemplate.get" type="query" view="ControlTemplate" description="Check if the template is created" id="umWxQQ">
				<input name="key" type="String" value="controltemplate:mytemplate:1-PREVIEW"></input>
				<expect-value name="assessmentPeriodicity" type="String" value="1Y"></expect-value>
			</activity>
			<activity path="ControlTemplate.release" type="mutation" description="Release template" id="khkMru">
				<input name="arn" type="String" value="controltemplate:mytemplate"></input>
				<expected-trace command="Admin.ControlTemplate.Release" status="success"></expected-trace>
			</activity>
			<activity path="ControlTemplate.get" type="query" view="ControlTemplate" description="Check if template is released" id="M53xa8">
				<input name="key" type="String" value="controltemplate:mytemplate:1"></input>
				<expect-value name="assessmentPeriodicity" type="String" value="1Y"></expect-value>
			</activity>
			<activity path="ControlTemplate.update" type="mutation" description="Update the template" id="n4APbV">
				<input name="name" type="String" value=""></input>
				<input name="description" type="String" value=""></input>
				<input name="assessmentPeriodicity" type="String" value="2Y"></input>
				<input name="requirementLinks" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr:11"></input>
				<input name="arn" type="String" value="controltemplate:mytemplate"></input>
				<expected-trace command="Admin.ControlTemplate.Update" status="success"></expected-trace>
			</activity>
			<activity path="ControlTemplate.get" type="query" view="ControlTemplate" description="Check if a new preview is created" id="4JWlT6">
				<input name="key" type="String" value="controltemplate:mytemplate:2-PREVIEW"></input>
				<expect-value name="assessmentPeriodicity" type="String" value="2Y"></expect-value>
			</activity>
			<activity path="ControlTemplate.get" type="query" view="ControlTemplate" description="Check that the released template is unaltered" id="HGF5qG">
				<input name="key" type="String" value="controltemplate:mytemplate:1"></input>
				<expect-value name="assessmentPeriodicity" type="String" value="1Y"></expect-value>
			</activity>
		</scenario>
		<scenario name="InviteAndSwitchUser" extends="Controls">
			<activity type="mutation" id="LrM74s" path="Company.Employee.updateRoles" description="Add employee">
				<input name="arn" type="String" value="anove:company:gate:employee:anove-invite-test@endtest-mail.io"></input>
				<input name="roles" type="String" value="company-administrator"></input>
				<expected-trace command="Customer.Company.UpdateRoles" status="success"></expected-trace>
				<expected-trace command="Admin.User.LinkCompanyToUser" status="success"></expected-trace>
				<expected-trace command="UpdateAccessForEmployee-Notifier" status="success"></expected-trace>
				<expected-trace command="SendInvite-Notifier" status="success"></expected-trace>
			</activity>
			<activity type="switch-user" id="pAc5Ek" user-number="2" description="Switch user to accept invite"></activity>
			<activity type="mutation" id="cc2nHb" description="Accept invite" path="User.activate">
				<input name="firstName" type="String" value="Invited"></input>
				<input name="lastName" type="String" value="User"></input>
				<input name="email" type="String" value="anove-invite-test@endtest-mail.io"></input>
				<expected-trace command="Admin.User.Activate" status="success"></expected-trace>
				<expected-trace command="Customer.Company.UpdateEmployeeArn" status="success"></expected-trace>
			</activity>
			<activity path="-select-" type="refresh-token" id="m5kMxl" description="refresh token"></activity>
		</scenario>
		<scenario extends="Controls" name="ProcessingActivity">
			<activity path="-select-" type="set-variables" description="Prepare processing activity" id="Hu3hDi">
				<input name="activityArn" type="String" value="anove:company:gate:processingactivity:qga"></input>
				<input name="activityTaskArn" type="String" value="anove:company:gate:processingactivity:qga:task"></input>
			</activity>
			<activity path="Company.ProcessingActivity.create" description="Create activity" type="mutation" id="lHdFiq">
				<input name="arn" type="String" value="#activityArn#"></input>
				<input name="name" type="String" value="Test"></input>
				<input name="description" type="String" value="Hello World!"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<input name="requiresDpia" type="Boolean" value="true"></input>
				<input name="weight" type="Int" value="1"></input>
				<expected-trace command="Customer.ProcessingActivity.Create" status="success"></expected-trace>
			</activity>
			<activity path="ProcessingActivity.get" type="query" view="ProcessingActivity" description="Check if activity is created" id="eSpI4H">
				<input name="key" type="String" value="#activityArn#"></input>
				<expect-value name="name" type="String" value="Test"></expect-value>
			</activity>
			<activity path="Company.ProcessingActivity.update" type="mutation" description="Update Activity" id="qrpcBI">
				<input name="arn" type="String" value="#activityArn#"></input>
				<input name="name" type="String" value="Hello World!"></input>
				<input name="description" type="String" value="test 123"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<input name="requiresDpia" type="Boolean" value="false"></input>
				<input name="weight" type="Int" value="2"></input>
				<expected-trace command="Customer.ProcessingActivity.Update" status="success"></expected-trace>
			</activity>
			<activity path="ProcessingActivity.get" type="query" view="ProcessingActivity" description="check if updated" id="L8SETb">
				<input name="key" type="String" value="#activityArn#"></input>
				<expect-value name="name" type="String" value="Hello World!"></expect-value>
			</activity>
			<activity path="Company.ProcessingActivity.Task.create" type="mutation" description="Create a task" id="sh2hlD">
				<input name="arn" type="String" value="#activityTaskArn#"></input>
				<input name="name" type="String" value="Test"></input>
				<input name="description" type="String" value="Hello World!"></input>
				<input name="assignee" type="String" value="#employeeArn#"></input>
				<input name="dueDate" type="String" value="2025-08-01"></input>
				<input name="notes" type="String" value="No notes"></input>
				<expected-trace command="Customer.ProcessingActivity.CreateTask" status="success"></expected-trace>
			</activity>
			<activity path="ProcessingActivity.getTasks" type="query" view="ProcessingActivityTask" description="Check if the task is created" id="dSjpOW">
				<input name="key_begins_with" type="String" value="#activityTaskArn#"></input>
				<expect-value name="resultset.0.name" type="String" value="Test"></expect-value>
			</activity>
			<activity path="Company.ProcessingActivity.Task.update" type="mutation" description="Update task" id="tXvmnI">
				<input name="arn" type="String" value="#activityTaskArn#"></input>
				<input name="name" type="String" value="Hello World!"></input>
				<input name="description" type="String" value=""></input>
				<input name="assignee" type="String" value=""></input>
				<input name="dueDate" type="String" value=""></input>
				<input name="notes" type="String" value=""></input>
				<expected-trace command="Customer.ProcessingActivity.UpdateTask" status="success"></expected-trace>
			</activity>
			<activity path="ProcessingActivity.getTasks" type="query" description="Check if task is updated" view="ProcessingActivityTask" id="OrIWGB">
				<input name="key_begins_with" type="String" value="#activityTaskArn#"></input>
				<expect-value name="resultset.0.name" type="String" value="Hello World!"></expect-value>
			</activity>
			<activity path="Company.ProcessingActivity.Task.complete" type="mutation" description="Complete task" id="s8BZmy">
				<input name="arn" type="String" value="#activityTaskArn#"></input>
				<expected-trace command="Customer.ProcessingActivity.CompleteTask" status="success"></expected-trace>
			</activity>
		</scenario>
		<scenario name="Objectives" extends="Controls">
			<activity path="-select-" type="set-variables" description="Prepare objective" id="vIaN7s">
				<input name="objectiveArn" type="String" value="anove:company:gate:objective:myobjective"></input>
			</activity>
			<activity path="Company.Objective.create" description="Create an objective" type="mutation" id="nAE7MQ">
				<input name="arn" type="String" value="#objectiveArn#"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<input name="name" type="String" value="My Objective"></input>
				<input name="startDate" type="String" value="2024-08-01"></input>
				<input name="dueDate" type="String" value="2025-08-01"></input>
				<input name="definitionOfDone" type="String" value="Hello World!"></input>
				<expected-trace command="Customer.Objective.Create" status="success"></expected-trace>
			</activity>
			<activity path="Objective.get" type="query" view="Objective" description="Assert that the objective view is filled" id="7shrME">
				<input name="key" type="String" value="#objectiveArn#"></input>
				<expect-value name="owner" type="String" value="#employeeArn#"></expect-value>
				<expect-value name="dueDate" type="String" value="2025-08-01"></expect-value>
				<expect-value name="name" type="String" value="My Objective"></expect-value>
				<expect-value name="startDate" type="String" value="2024-08-01"></expect-value>
				<expect-value name="definitionOfDone" type="String" value="Hello World!"></expect-value>
				<expect-value name="completionPercentage" type="Int" value="0"></expect-value>
			</activity>
			<activity path="Company.Objective.update" type="mutation" description="Update the objective" id="bFqAiX">
				<input name="arn" type="String" value="#objectiveArn#"></input>
				<input name="owner" type="String" value=""></input>
				<input name="dueDate" type="String" value="2024-11-01"></input>
				<input name="definitionOfDone" type="String" value=""></input>
				<input name="completionPercentage" type="Int" value="20"></input>
				<expected-trace command="Customer.Objective.Update" status="success"></expected-trace>
			</activity>
			<activity path="Objective.get" type="query" view="Objective" description="Check if the update was successfull" id="dJSWsm">
				<input name="key" type="String" value="#objectiveArn#"></input>
				<expect-value name="owner" type="String" value="#employeeArn#"></expect-value>
				<expect-value name="startDate" type="String" value="2024-08-01"></expect-value>
				<expect-value name="definitionOfDone" type="String" value="Hello World!"></expect-value>
				<expect-value name="dueDate" type="String" value="2024-11-01"></expect-value>
				<expect-value name="completionPercentage" type="Int" value="20"></expect-value>
			</activity>
			<activity path="Company.Objective.update" type="mutation" description="Complete the objective" id="gV4FHH">
				<input name="arn" type="String" value="#objectiveArn#"></input>
				<input name="owner" type="String" value=""></input>
				<input name="dueDate" type="String" value=""></input>
				<input name="definitionOfDone" type="String" value=""></input>
				<input name="completionPercentage" type="Int" value="100"></input>
				<expected-trace command="Customer.Objective.Update" status="success"></expected-trace>
			</activity>
			<activity path="Company.Objective.update" type="mutation" description="Try to reopen the objective with an update command, this should fail." id="G5c2Ou">
				<input name="arn" type="String" value="#objectiveArn#"></input>
				<input name="owner" type="String" value=""></input>
				<input name="dueDate" type="String" value=""></input>
				<input name="definitionOfDone" type="String" value=""></input>
				<input name="completionPercentage" type="Int" value="90"></input>
				<expected-trace command="Customer.Objective.Update" status="error"></expected-trace>
			</activity>
			<activity path="Company.Objective.reopen" type="mutation" description="Use the reopen command" id="Tu3B43">
				<input name="arn" type="String" value="#objectiveArn#"></input>
				<expected-trace command="Customer.Objective.Reopen" status="success"></expected-trace>
			</activity>
			<activity path="Company.Objective.reopen" type="mutation" description="Use the reopen command again, this should fail" id="Wb2bZB">
				<input name="arn" type="String" value="#objectiveArn#"></input>
				<expected-trace command="Customer.Objective.Reopen" status="error"></expected-trace>
			</activity>
			<activity path="Company.Objective.update" type="mutation" description="Set completion to 90%" id="9D03by">
				<input name="arn" type="String" value="#objectiveArn#"></input>
				<input name="owner" type="String" value=""></input>
				<input name="dueDate" type="String" value=""></input>
				<input name="definitionOfDone" type="String" value=""></input>
				<input name="completionPercentage" type="Int" value="90"></input>
				<expected-trace command="Customer.Objective.Update" status="success"></expected-trace>
			</activity>
			<activity path="Objective.get" type="query" view="Objective" description="Check if the objective is completed for 90%" id="dyZ9NW">
				<input name="key" type="String" value="#objectiveArn#"></input>
				<expect-value name="completionPercentage" type="Int" value="90"></expect-value>
			</activity>
			<activity path="Company.Objective.Task.create" type="mutation" description="Create objective task" id="cVbaSd">
				<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
				<input name="name" type="String" value="My Task"></input>
				<input name="description" type="String" value="Hello World"></input>
				<input name="assignee" type="String" value="#employeeArn#"></input>
				<input name="dueDate" type="String" value="2024-09-01"></input>
				<input name="notes" type="String" value="My notes"></input>
				<expected-trace command="Customer.Objective.CreateTask" status="success"></expected-trace>
			</activity>
			<activity path="Objective.get" type="query" view="Objective" description="Check if objective task is linked" id="PiXe7G">
				<input name="key" type="String" value="#objectiveArn#"></input>
				<expect-value name="tasks.0.name" type="String" value="My Task"></expect-value>
			</activity>
			<activity path="User.get" type="query" view="User" description="Get correct employeeArn" id="RX93Hs">
				<input name="key" type="String" value="#user_name#"></input>
				<extract-value put-key="taskAssignee" name="links.0.employeeArn"></extract-value>
				<expect-value name="username" type="String" value="#user_name#"></expect-value>
			</activity>
			<activity path="Company.Objective.Task.update" type="mutation" description="Update task" id="wqaMKg">
				<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
				<input name="name" type="String" value="Test"></input>
				<input name="description" type="String" value=""></input>
				<input name="assignee" type="String" value="#taskAssignee#"></input>
				<input name="dueDate" type="String" value=""></input>
				<input name="notes" type="String" value=""></input>
				<expected-trace command="Customer.Objective.UpdateTask" status="success"></expected-trace>
			</activity>
			<activity path="Objective.get" type="query" view="Objective" description="Check if task was updated" id="chUXOD">
				<input name="key" type="String" value="#objectiveArn#"></input>
				<expect-value name="tasks.0.name" type="String" value="Test"></expect-value>
			</activity>
			<activity path="Company.Objective.Task.complete" type="mutation" description="Complete task" id="EZ3SkE">
				<input name="arn" type="String" value="anove:company:gate:objective:myobjective:mytask"></input>
				<expected-trace command="Customer.Objective.CompleteTask" status="success"></expected-trace>
			</activity>
			<activity path="Objective.getTasks" type="query" view="ObjectiveTask" description="Test task query" id="YNuk5x">
				<input name="key_begins_with" type="String" value="#companyArn#"></input>
				<expect-value name="resultset.0.name" type="String" value="Test"></expect-value>
			</activity>
		</scenario>
		<scenario name="Controls" extends="BusinessUnit">
			<activity type="mutation" id="eRrGne" description="Create control" path="Company.Control.create">
				<input name="name" type="String" value="Test"></input>
				<input name="description" type="String" value="Hello World"></input>
				<input name="controlTemplateArn" type="String" value=""></input>
				<input name="assessmentPeriodicity" type="String" value="1M"></input>
				<input name="desiredMaturityLevel" type="Int" value="3"></input>
				<input name="businessUnit" type="String" value="Engineering"></input>
				<input name="companyArn" type="String" value="#companyArn#"></input>
				<input name="requirements" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr:10"></input>
				<input name="nextAssessmentDate" type="String" value="2024-08-01"></input>
				<input name="controlOwner" type="String" value="anove:company:gate:employee:j.doe"></input>
				<expected-trace command="Customer.Control.Create" status="success"></expected-trace>
			</activity>
			<activity type="query" id="cNMn0t" description="Assert that control is created" path="Control.get" view="Control">
				<input name="key" type="String" value="anove:company:gate:control:test"></input>
				<expect-value name="name" type="String" value="Test"></expect-value>
				<expect-value name="assessmentPeriodicity" type="String" value="1M"></expect-value>
				<expect-value name="requirements.0.name" type="String" value="10"></expect-value>
				<extract-value name="arn" put-key="controlArn"></extract-value>
			</activity>
			<activity type="query" id="tvvozya" path="Company.get" view="Company" description="Fetch employee ARN">
				<input name="key" type="String" value="#companyArn#"></input>
				<extract-value name="employees.0.arn" put-key="employeeArn"></extract-value>
			</activity>
			<activity type="mutation" id="WxdXdu" description="Update Control" path="Company.Control.update">
				<input name="description" type="String" value="Hello World!"></input>
				<input name="controlTemplateArn" type="String" value=""></input>
				<input name="assessmentPeriodicity" type="String" value="6M"></input>
				<input name="desiredMaturityLevel" type="Int" value="4"></input>
				<input name="businessUnit" type="String" value="Engineering"></input>
				<input name="requirements" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr:10"></input>
				<input name="nextAssessmentDate" type="String" value="2024-08-01"></input>
				<input name="controlOwner" type="String" value="#employeeArn#"></input>
				<input name="arn" type="String" value="#controlArn#"></input>
				<expected-trace command="Customer.Control.Update" status="success"></expected-trace>
			</activity>
			<activity type="query" id="cNMn0ta" description="Assert that control is updated" path="Control.get" view="Control">
				<input name="key" type="String" value="anove:company:gate:control:test"></input>
				<expect-value name="assessmentPeriodicity" type="String" value="6M"></expect-value>
			</activity>
			<activity type="mutation" id="Tho3JN" description="Start self assessment" path="Company.Control.Assessment.start">
				<input name="controlArn" type="String" value="#controlArn#"></input>
				<input name="dueDate" type="String" value=""></input>
				<input name="category" type="String" value=""></input>
				<input name="assessorLink" type="String" value=""></input>
				<expected-trace command="Customer.Control.CreateAssessment" status="success"></expected-trace>
			</activity>
			<activity type="query" id="lPOoFp" path="ControlAssessment.filter" view="ControlAssessment" description="Assert that the assessment is created">
				<input name="key_begins_with" type="String" value="#companyArn#"></input>
				<expect-value name="resultset.0.dueDate" type="String" value="2024-08-01"></expect-value>
				<extract-value name="resultset.0.arn" put-key="assessmentArn"></extract-value>
			</activity>
			<activity type="query" id="BBtJXf" description="Assert that a task is created" path="Task.get" view="Task">
				<input name="key" type="String" value="#assessmentArn#"></input>
				<expect-value name="dueDate" type="String" value="2024-08-01"></expect-value>
			</activity>
			<activity type="mutation" id="btIaPX" description="Update assessment" path="Company.Control.Assessment.update">
				<input name="arn" type="String" value="#controlArn#"></input>
				<input name="assessment" type="Nested" value='[{"dueDate":"2024-08-01","notes":"Hello World!","arn":"#assessmentArn#","assessedMaturityLevel":"3","assessedMaturityDescription":"-","linkToEvidence":"abc","assessorLink":"#employeeArn#"}]'></input>
				<expected-trace command="Customer.Control.UpdateAssessment" status="success"></expected-trace>
			</activity>
			<activity type="query" id="BBtJXfa" description="Assert that the task is updated" path="Task.get" view="Task">
				<input name="key" type="String" value="#assessmentArn#"></input>
				<expect-value name="notes" type="String" value="Hello World!"></expect-value>
			</activity>
			<activity type="mutation" id="IqGs9b" description="Complete assessment" path="Company.Control.Assessment.complete">
				<input name="arn" type="String" value="#assessmentArn#"></input>
				<expected-trace command="Customer.Control.CompleteAssessment" status="success"></expected-trace>
			</activity>
			<activity type="query" id="jD4RSp" description="Assert that there is no pending self assessment" path="Control.get" view="Control">
				<input name="key" type="String" value="#controlArn#"></input>
				<expect-value name="hasPendingSelfAssessment" type="Boolean" value="false"></expect-value>
			</activity>
			<activity path="Company.Control.createFromTemplate" type="mutation" description="Create control from template" id="IN7KH9">
				<input name="controlTemplateReference" type="String" value="controltemplate:mytemplate:1"></input>
				<input name="desiredMaturityLevel" type="Int" value="4"></input>
				<input name="businessUnit" type="String" value="engineering"></input>
				<input name="companyArn" type="String" value="#companyArn#"></input>
				<input name="nextAssessmentDate" type="String" value="2025-08-01"></input>
				<input name="controlOwner" type="String" value="#employeeArn#"></input>
				<expected-trace command="CreateControlFromTemplate-Notifier" status="success"></expected-trace>
				<expected-trace command="Customer.Control.Create" status="success"></expected-trace>
			</activity>
		</scenario>
		<scenario name="ActivateUser" extends="">
			<activity description="Switch to first user" type="switch-user" user-number="1" id="YECd9W"></activity>
			<activity type="mutation" id="fPKBHE" path="User.activate" description="Activate user">
				<input name="firstName" type="String" value="Test"></input>
				<input name="lastName" type="String" value="User"></input>
				<input name="email" type="String" value="anove@endtest-mail.io"></input>
				<expected-trace command="Admin.User.Activate" status="success"></expected-trace>
			</activity>
			<activity type="query" id="HwB14x" description="Assert user is created" path="User.get" view="User">
				<input name="key" type="String" value="#user_name#"></input>
				<expect-value name="firstName" type="String" value="Test"></expect-value>
				<expect-value name="lastName" type="String" value="User"></expect-value>
				<expect-value name="email" type="String" value="anove@endtest-mail.io"></expect-value>
				<expect-value name="active" type="Boolean" value="true"></expect-value>
			</activity>
			<activity type="query" id="CyBtfQ" description="Check if profile is set" path="Profile.get" view="Profile">
				<input name="key" type="String" value="#user_name#"></input>
				<expect-value name="firstName" type="String" value="Test"></expect-value>
				<expect-value name="lastName" type="String" value="User"></expect-value>
			</activity>
			<activity path="User.update" type="mutation" description="Update User" id="pptOgJ">
				<input name="firstName" type="String" value="John"></input>
				<input name="lastName" type="String" value="Doe"></input>
				<input name="email" type="String" value="j.doe@example.com"></input>
				<expected-trace command="Admin.User.Update" status="success"></expected-trace>
			</activity>
			<activity path="User.get" type="query" view="User" description="Check if user is updated" id="kCgrwa">
				<input name="key" type="String" value="#user_name#"></input>
				<expect-value name="firstName" type="String" value="John"></expect-value>
				<expect-value name="lastName" type="String" value="Doe"></expect-value>
				<expect-value name="email" type="String" value="j.doe@example.com"></expect-value>
			</activity>
		</scenario>
		<scenario name="Region" extends="CreateAdministrator">
			<activity type="set-variables" id="gFlJ1j" description="Prepare region">
				<input name="region" type="String" value="region:EMEA"></input>
				<input name="regionName" type="String" value="Europe, Middle East &amp; Africa"></input>
				<input name="regionCode" type="String" value="EMEA"></input>
				<input name="countryArn" type="String" value="region:EMEA:country:NL"></input>
				<input name="countryName" type="String" value="Netherlands"></input>
			</activity>
			<activity type="mutation" id="9TGHOL" path="Region.update" description="Create region">
				<input name="arn" type="String" value="#region#"></input>
				<input name="code" type="String" value="#regionCode#"></input>
				<input name="name" type="String" value="#regionName#"></input>
				<input name="countries" type="Nested" value='[{"name":"Netherlands","code":"NL"}]'></input>
				<expected-trace command="Admin.Region.CreateOrUpdate" status="success"></expected-trace>
			</activity>
			<activity type="query" id="d39qIK" description="Assert that region is created" path="Region.get" view="Region">
				<input name="key" type="String" value="#region#"></input>
				<expect-value name="name" type="String" value="#regionName#"></expect-value>
				<expect-value name="code" type="String" value="#regionCode#"></expect-value>
			</activity>
			<activity type="query" id="UQaJkG" path="Country.get" view="Country" description="Assert that country is created">
				<input name="key" type="String" value="#countryArn#"></input>
				<expect-value name="name" type="String" value="#countryName#"></expect-value>
			</activity>
		</scenario>
		<scenario name="SetupControlFramework" extends="CreateAdministrator">
			<activity type="set-variables" id="adGCSz" description="Prepare framework">
				<input name="frameworkArn" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr"></input>
			</activity>
			<activity type="mutation" id="KWl2YT" path="ControlFramework.add" description="Create control framework">
				<input name="arn" type="String" value="#frameworkArn#"></input>
				<input name="description" type="String" value="base64:VGhlIEVVIEdlbmVyYWwgRGF0YSBQcm90ZWN0aW9uIFJlZ3VsYXRpb24gKEdEUFIpLCBpbXBsZW1lbnRlZCBpbiBNYXkgMjAxOCwgaXMgYSBjb21wcmVoZW5zaXZlIGRhdGEgcHJpdmFjeSBsYXcgYXBwbHlpbmcgdG8gYnVzaW5lc3NlcyBoYW5kbGluZyBwZXJzb25hbCBkYXRhIG9mIEV1cm9wZWFuIFVuaW9uIChFVSkgcmVzaWRlbnRzLiBJdCBtYW5kYXRlcyB0cmFuc3BhcmVudCBhbmQgbGF3ZnVsIGRhdGEgcHJvY2Vzc2luZywgbGltaXRpbmcgZGF0YSBjb2xsZWN0aW9uIHRvIG5lY2Vzc2FyeSBwdXJwb3NlcywgZW5zdXJpbmcgYWNjdXJhY3ksIGFuZCBlbmZvcmNpbmcgZGF0YSBzZWN1cml0eS4gVGhlIEdEUFIgZ3JhbnRzIGluZGl2aWR1YWxzIHJpZ2h0cyBvdmVyIHRoZWlyIGRhdGEgYW5kIHJlcXVpcmVzIG9yZ2FuaXphdGlvbnMgdG8gcHJvbXB0bHkgcmVwb3J0IGJyZWFjaGVzLiBOb24tY29tcGxpYW5jZSBtYXkgcmVzdWx0IGluIHN1YnN0YW50aWFsIGZpbmVzLiBJdHMgcHJpbWFyeSBnb2FsIGlzIHRvIHByb3RlY3QgaW5kaXZpZHVhbHMnIHByaXZhY3kgYnkgc2V0dGluZyBzdHJpbmdlbnQgc3RhbmRhcmRzIGZvciB0aGUgcHJvY2Vzc2luZyBvZiBwZXJzb25hbCBkYXRhIHdpdGhpbiBhbmQgb3V0c2lkZSB0aGUgRVUu"></input>
				<input name="name" type="String" value="base64:RVUgR2VuZXJhbCBEYXRhIFByb3RlY3Rpb24gUmVndWxhdGlvbiAoR0RQUik="></input>
				<input name="category" type="String" value="regulation"></input>
				<input name="edition" type="String" value="1.0"></input>
				<input name="unit" type="String" value="article"></input>
				<input name="acronym" type="String" value="EU GDPR"></input>
				<input name="active" type="Boolean" value="true"></input>
				<expected-trace command="Admin.ControlFramework.Create" status="success"></expected-trace>
			</activity>
			<activity type="mutation" id="pm7Rsl" path="Requirement.add" description="Add requirement to framework">
				<input name="arn" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr:10"></input>
				<input name="name" type="String" value="10"></input>
				<input name="description" type="String" value="base64:QXJ0aWNsZSgxMCk6IFByb2Nlc3Npbmcgb2YgcGVyc29uYWwgZGF0YSByZWxhdGluZyB0byBjcmltaW5hbCBjb252aWN0aW9ucyBhbmQgb2ZmZW5jZXMgb3IgcmVsYXRlZCBzZWN1cml0eSBtZWFzdXJlcyBiYXNlZCBvbiBBcnRpY2xlIDYoMSkgc2hhbGwgYmUgY2FycmllZCBvdXQgb25seSB1bmRlciB0aGUgY29udHJvbCBvZiBvZmZpY2lhbCBhdXRob3JpdHkgb3Igd2hlbiB0aGUgcHJvY2Vzc2luZyBpcyBhdXRob3Jpc2VkIGJ5IFVuaW9uIG9yIE1lbWJlciBTdGF0ZSBsYXcgcHJvdmlkaW5nIGZvciBhcHByb3ByaWF0ZSBzYWZlZ3VhcmRzIGZvciB0aGUgcmlnaHRzIGFuZCBmcmVlZG9tcyBvZiBkYXRhIHN1YmplY3RzLiBBbnkgY29tcHJlaGVuc2l2ZSByZWdpc3RlciBvZiBjcmltaW5hbCBjb252aWN0aW9ucyBzaGFsbCBiZSBrZXB0IG9ubHkgdW5kZXIgdGhlIGNvbnRyb2wgb2Ygb2ZmaWNpYWwgYXV0aG9yaXR5Lg=="></input>
				<input name="mandatory" type="Boolean" value="true"></input>
				<input name="summary" type="String" value="-"></input>
				<expected-trace command="Admin.Requirement.Create" status="success"></expected-trace>
			</activity>
			<activity type="query" id="5pTozg" description="Assert that framework is added" path="ControlFramework.get" view="ControlFramework">
				<input name="key" type="String" value="#frameworkArn#"></input>
				<expect-value name="name" type="String" value="EU General Data Protection Regulation (GDPR)"></expect-value>
			</activity>
			<activity type="query" id="OTFRSw" description="Assert that requirement is added" path="Requirement.get" view="Requirement">
				<input name="key" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr:10"></input>
				<expect-value name="name" type="String" value="10"></expect-value>
			</activity>
			<activity path="ControlFramework.update" type="mutation" description="Update controlframework" id="ilIxOa">
				<input name="arn" type="String" value="#frameworkArn#"></input>
				<input name="description" type="String" value="update test"></input>
				<input name="name" type="String" value=""></input>
				<input name="category" type="String" value=""></input>
				<input name="edition" type="String" value=""></input>
				<input name="unit" type="String" value=""></input>
				<input name="acronym" type="String" value=""></input>
				<input name="active" type="Boolean" value="true"></input>
				<expected-trace command="Admin.ControlFramework.Update" status="success"></expected-trace>
			</activity>
			<activity path="ControlFramework.get" type="query" view="ControlFramework" id="iP1JFP" description="Check that the framework was updated">
				<input name="key" type="String" value="#frameworkArn#"></input>
				<expect-value name="description" type="String" value="update test"></expect-value>
			</activity>
			<activity path="Requirement.update" type="mutation" description="Update requirement" id="Sb5CF9">
				<input name="arn" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr:10"></input>
				<input name="name" type="String" value=""></input>
				<input name="description" type="String" value=""></input>
				<input name="mandatory" type="Boolean" value="true"></input>
				<input name="summary" type="String" value="test 123"></input>
				<expected-trace command="Admin.Requirement.Update" status="success"></expected-trace>
			</activity>
			<activity path="Requirement.get" type="query" view="Requirement" description="Check if requirement was updated" id="PhpfAQ">
				<input name="key" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr:10"></input>
				<expect-value name="summary" type="String" value="test 123"></expect-value>
				<expect-value name="mandatory" type="Boolean" value="true"></expect-value>
			</activity>
		</scenario>
		<scenario name="Industry" extends="CreateAdministrator">
			<activity type="set-variables" id="NqvsP2" description="Prepare industry">
				<input name="industry" type="String" value="industry:informationtechnologyitandservices"></input>
				<input name="industryName" type="String" value="Information Technology (IT) and Services"></input>
				<input name="industryDecription" type="String" value="Software development, IT services, and technology innovation."></input>
			</activity>
			<activity type="mutation" id="feLiPo" path="Industry.add" description="Create Industry">
				<input name="arn" type="String" value="#industry#"></input>
				<input name="name" type="String" value="#industryName#"></input>
				<input name="description" type="String" value="#industryDecription#"></input>
				<expected-trace command="Admin.Industry.Create" status="success"></expected-trace>
			</activity>
			<activity type="query" id="E4cwX9" description="Assert that industry is created" path="Industry.get" view="Industry">
				<input name="key" type="String" value="#industry#"></input>
				<expect-value name="name" type="String" value="#industryName#"></expect-value>
				<expect-value name="description" type="String" value="#industryDecription#"></expect-value>
			</activity>
			<activity path="Industry.update" type="mutation" description="Update Industry" id="dxTCQf">
				<input name="arn" type="String" value="#industry#"></input>
				<input name="name" type="String" value="#industryName#"></input>
				<input name="description" type="String" value="#industryDecription#"></input>
				<expected-trace command="Admin.Industry.Update" status="success"></expected-trace>
			</activity>
		</scenario>
		<scenario name="SetupTenant" extends="CreateAdministrator">
			<activity type="mutation" id="138ixT" description="Create tenant" path="Tenant.create">
				<input name="key" type="String" value="anove"></input>
				<input name="name" type="String" value="anove"></input>
				<expected-trace command="Admin.Tenant.Create" status="success"></expected-trace>
			</activity>
			<activity type="mutation" id="8LL5xl" description="Upload css for tenant" path="upload">
				<input name="name" type="String" value="anove/custom.css"></input>
				<input name="content" type="String" value="data:text/plain;charset=utf-8;base64,LmludHJvIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogeWVsbG93Ow0KfQ=="></input>
				<input name="public" type="Boolean" value="true"></input>
				<expected-trace command="Admin.Tenant.LinkStyleSheet" status="success"></expected-trace>
				<expected-trace command="FileIntake-Notifier" status="success"></expected-trace>
			</activity>
			<activity type="query" id="9FHqvU" description="Assert that tenant is created" path="Tenant.get" view="Tenant">
				<input name="key" type="String" value="anove"></input>
				<expect-value name="name" type="String" value="anove"></expect-value>
			</activity>
			<activity path="Tenant.update" type="mutation" description="Update tenant screenname" id="28ABgR">
				<input name="key" type="String" value="anove"></input>
				<input name="name" type="String" value="Anove"></input>
				<expected-trace command="Admin.Tenant.Update" status="success"></expected-trace>
			</activity>
			<activity type="query" id="9FHqvU2" description="Assert that tenant is updated" path="Tenant.get" view="Tenant">
				<input name="key" type="String" value="anove"></input>
				<expect-value name="name" type="String" value="Anove"></expect-value>
			</activity>
			<activity type="mutation" id="8LL5x2" description="Upload logo for tenant" path="upload">
				<input name="name" type="String" value="anove/logo.png"></input>
				<input name="content" type="String" value="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></input>
				<input name="public" type="Boolean" value="true"></input>
				<expected-trace command="Admin.Tenant.LinkLogo" status="success"></expected-trace>
				<expected-trace command="FileIntake-Notifier" status="success"></expected-trace>
			</activity>
		</scenario>
		<scenario name="OnboardCompany" extends="SetupControlFramework;SetupTenant;ActivateUser;Region;Industry;RiskTemplate;ControlTemplate;Integrations;ThirdPartyTemplate">
			<activity description="Switch to first user" type="switch-user" user-number="1" id="YECd9W"></activity>
			<activity type="set-variables" id="mLEj6G" description="Set company arn">
				<input name="companyArn" type="String" value="anove:company:gate"></input>
			</activity>
			<activity type="mutation" id="2149Ji" description="Onboard company" path="Company.create">
				<input name="arn" type="String" value="#companyArn#"></input>
				<input name="name" type="String" value="Gate"></input>
				<input name="description" type="String" value="quality gate company"></input>
				<input name="companySize" type="Int" value="1"></input>
				<input name="revenue" type="String" value="0"></input>
				<input name="industry" type="String" value="#industry#"></input>
				<input name="country" type="String" value="#countryArn#"></input>
				<expected-trace command="Customer.Company.Create" status="success"></expected-trace>
			</activity>
			<activity type="wait" id="GPLHyr" milliseconds="3000" description="3 seconds"></activity>
			<activity type="refresh-token" id="UULFnW" description="Creating a company also creates roles and grant's them to the current user"></activity>
			<activity type="query" id="87lTbb" description="Assert that company is created" path="Company.get" view="Company">
				<input name="key" type="String" value="#companyArn#"></input>
				<expect-value name="name" type="String" value="Gate"></expect-value>
				<expect-value name="description" type="String" value="quality gate company"></expect-value>
			</activity>
			<activity path="Company.update" type="mutation" description="Update a company" id="7jotsG">
				<input name="arn" type="String" value="#companyArn#"></input>
				<input name="description" type="String" value=""></input>
				<input name="companySize" type="Int" value="20"></input>
				<input name="revenue" type="String" value="2M"></input>
				<input name="industryLink" type="String" value=""></input>
				<input name="countryArn" type="String" value=""></input>
				<expected-trace command="Customer.Company.Update" status="success"></expected-trace>
			</activity>
			<activity type="query" id="87lTb2" description="Assert that company is updated" path="Company.get" view="Company">
				<input name="key" type="String" value="#companyArn#"></input>
				<expect-value name="companySize" type="Int" value="20"></expect-value>
				<expect-value name="revenue" type="String" value="2M"></expect-value>
			</activity>
			<activity type="mutation" id="8LL5xl2" description="Upload logo for company" path="upload">
				<input name="name" type="String" value="anove:company:gate/logo.png"></input>
				<input name="content" type="String" value="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWAAAAFgCAYAAACFYaNMAAAdNElEQVR4nOzdTXNUV57n8f//ZkrCVOFKYipmmAAxOTFBT1KzsLzoCJVsh5Pd7Kx6BcArKPwKQLvZGV4BYtkrw3JWJUcZ2RG1aHkDuFlMtmRPOKIrprPtrkIWynsm8kpQPCjznnvPfTzn+9l1dUo6YPHLk+ee3zmRAABqQQADQE0IYACoSbfuAQBZXRisDlU7n4iYvoj2pv+bSvzgwJj7Pzz5elT3+ABbWvcAAFvnBqv9Be3cVZHhzBepubX7aHuj0oEBOXXqHgBgo78y7EWT+CsVXZn/Sh2++x8v9n/8l70HVY0NyIs1YLTD/n5PRPs2L1UzZ4YMNAgBDAA1IYABoCYEMADUhAAGgJoQwABQEwIYAGpCAANATQhgAKgJAQwANSGAAaAmBDAA1IQABoCaEMAAUBMCGABqQgADQE24kggtZUZq9OX1QyaSFTHSq3dMQDYEMNrDyKbR6EHnWWdrNNoav/n/7g9W+xOJhir6cT0DBAAArcAaMADUhAAGgJqwBoxW6Q9WX17M+Xwy6Wmnkzx464okD+TG+6fG4xPWh4Em0roHALyq1x/2frHwl37UWVgR1ffUSE9UVkSM9a3IR8zIiI5EzFiNfGNisxObw9H3T/+0U+b4gSwIYNRqGri/PLW/otr5RERWVEveTqYyNkZ2VOIHsTE73z35equ0nwWkIIBRuWnovvvOz9eMRJ+oyLDWwUwDWeS+HMYP9v7pq/u1jgXBIYBRiUaF7izHYWziyT1mxqgCAYxSnRus9hej6KqI3mhZU21kjNl4LvHWD0++HtU9GPiJAEYpLgxWh6qdm42d7dobTWfFz83kDkGMohHAKNR0xrugnbseBO/b1Nw6iON7BDGKQgCjEEdrvM9visiNusdSsmRpYu/J9mbdA0H7EcBwdvHyb38vGt1q2Rqvq9GBmVxhNgwXBDByq2W5QWUsxhw33XSsRsZGp8FvjsM/S1nDnYnk9k9/WdigfYc8CGDkUsGsd0eM7IjG3xjpjjrm+Y7snxqfdAzlm/r9YU9OH/QnptNXM1lRlffMUTCvlDRWZsPIhQBGJr3+sHfm9MFdNbpe5Pc1RrZU9ItYZKu7392xCdqskvOCdWFFTbwuaj4ufLas5tbuo+2NQr8nvEYAw1qyp1ejPxQVXEnoavwgera0WUbgprkw+HAYiblWZBgblc2f/rrwKUsSsEEAw8ry3320rt34rvOSg8pYJuZerNH975582Zi22fJg7VoketVoIevZLEnACgGMVMl6r0S3nb7JNHhjvRPtd2/XMdu11R+s9mPp3BKVq47fihBGKgIYc10crN0U1Vu5v0FLgvdNBQXxeHJornz/dJsjMHEiAhgzuYavirmvJv501OJZYLJOrPFdhzXisZlE1/f+6Y+ctIa3EMA4kWP4jmKj15u0xuvq4uDDW6LmZt6vnxya95kJ400EMN7iEr6x6J3us+6tNi032EqWJfLvAmE5Am8hgPGa3OGrMjaHYXzUdpgNjw/M5H0ezOEFAhgvJVvNOvHnOb50FJnJlTav9Wa1PFi7ppF+lmNbHrsj8BLX0iNxbrDaT/b5ZmSMbEXPFt4PKXyn9p5sb0bx5H0Rk/XP3V/UTp43OXioU/cAUL9ef9g7vRB/JaLnsnydEbm39+Th78bj0X55o2uu8Z+/G5/99fkHRnVdRLPMhM+9+58u9n78l73/XeLw0ALMgCFnTj//LPODJdWNvccPr5U2qJaYzvwjE1/JOhPWWG5cHHzgWvZAy7EGHLhkLVM129KD6sbuoy/zlzM8lHOHBA/lAscMOGDJuq9Kpqf5RuQe4fu2nDPh3oJ2Mq+7wx8EcMAWos7NjDO2HZYdZssTwioyvHj5t75f44QZCOBAJUsPRrKE6Sgyk9+VOCQvTEM4NtH1bF8V3Zx+GilrTGgudkEEaPqPvZus+1o+uVcZR2by29C2muX14593R7/6Dxf/TVT+p+WXnIpU+z/+ee8fSh4aGoYZcIAWJbqaZenBxKbVB+rUYffbh7eNyD3b16vo+oXBh/5d5Y+5CODAJB91s1SNjWxyBXs+naWFG5nWgx0O+0E7EcCBOXrwZm0UyYQ7znIa7WyNs6wHq8iQWXBYCOCAJNvOMjx4M8ZssPTg5uhITr1j+3pmwWEhgAOSafbL0kNhoqXureRmEAvMgsNCAAci6+yXpYfijHa2xjIR679PZsHhIIADsWg669YvNrLJ0kOxdr99eNv2gRyz4HAQwKGIzO+tX8rstxTG2M+CRWP7N0y0FgEcgOXLH61b7/tl9luaozV1u1lwJHq11x9mPewdLUMAh0DjT2xfyuy3bMZ2R0TvzKkDZsGeI4A9118Z9qwfvjH7LV20tLRpuyNCVDkv2HMEsOcm+/azqFjUujqLfJIdEcZY/T2ryJBlCL8RwL6L9GPLV46OSgMoW2wi65ujWYbwGwHsORWx+gcci3lQ/mggx+04NWL1Zqdi/QaKFiKAPXZhsDq0vTa9e/ic1luFjJgvrF6odm+gaCcC2GOR6orlS0ejp3/aKXk4eEUske1yT++/Xl77LyUPBzUhgD1mbD++Wn4cRnGS9XbL3RCHRq6UPyLUgQD2mKpa1VmNxqz/1iG2+3tnHdhfBLCn+ivDnu36b8cYlh/qoGL39x6J7VISWoYA9tTh/r79+i/li1pMDtVu6ccIF3Z6igD2lO0DOCNC+NZk4ReLtn/3PIjzFAHsLbvDd9RYbodC4ZJWnOXhPIdi3i9/RKgaAewpNfqezeuYAdfLiOU6sFEqyR4igANnJCKAa6Qi/2z5OtaBPUQAe8qosfoH2538bHcyF0pie229sgbsIQLYW3ZrwOPnv2AGXCNjlDfAgBHAgRuPtgiAOmnH6u/fKEsQPiKAgRoZ85w3wIARwB7qD1ZtZ0ssPwA1IoABoCYEcNjYWwrUiAD2UIazHQhgoEYEMFAj1QWrN0EV82/ljwZVI4B9ZXnYN4e81MxM7D6FGP3X0seCyhHAvjLGbn/p4fOz5Q8Gs9hXjI1VZRntQgB7So1arQNPul02+NfKrjIuaveGinYhgD1lJOaQlxZQiayWgDi1zk8EsLfsZsBiIqtjK1EOY3ndkDF2lWW0CwHsKesZE/eN1ebcYLVve2/fv+93ubfPQwSwp+KJ7UHfstLrD9kPXIMFXbB781PZ4dAkPxHAnvr+6faO7Va0X546ZBZcA5XJ0OqFhh0QviKAfWbsliGiKLYLAhTK9tooMZafZtA63boHgDKZL0TSb0c2Rj+uZjx/c2GwOoyi6GOJtX981u2OGPPN3pPtzTJ/bq8/7L37zs/XxETvTX+uGhkZMV88l3jrhwqv5z83WJ3+ua3e+GKJ7K6vR+to3QNAeZYvf7SuEn9u89ofny2crWKdcRo8C9q5qzIzfEbGmI2ig/goeJ/fFJEbM1+k5tbuo+2NIn/uLMuDtWuqetfmtVX9t0H1WILwWGepYz1zSmaFJZuG76JGf5gTvlP9aTBd/M3azaJ+7nH4/mFu+EpS9721/JsPrELRmconNi8zIluEr78IYI+NdrbGasQqhI1EVoHgYhq+tnfVTcPw4uXfzg9MS2dOP/9MxG67nRq5tvw/PvisiJ87S39l2FPRdavxSPygzLGgXgSw50yyDpxuOistczvaxf/+wQ3r8H0puuk6puSjvpFMs3uN5caFwYelPZic7B9Yhe9UdHjI+q/HCGDPTSZy3/a1754+KGTGeaLI/D7HV/Wcl0YsP+q//XWxdUhmFYletXzpaPT0T+yA8BgB7Lnvn27v2C5DiNE8IZnqwmB1mH32e8yxKq2quWayGUIyk/OX1lbsdz8Ylh88RwAHwHYZYjrjnH5kL/rna9TJHWbO17FbVn1P0CtjGSJasH+T65r4dtE/H81CAAcgOrVo/w9Zi5/5qUhpH+fLpGoK24khx7tAbNejjchWhqul0FIEcACy7IZQkWGRM79kRp1/FjqdvX/jNgKTO8RUij0nYyHq2Ae6MfeK+rloLgI4EBNR64JBpKa4vbB5H4K9YCLrh4gzuKyjuj8EPJZl9jt9zyy7EYhmIIAD8d2TL7esH8aJ9IvYg5uEjuV+1xlG03G7jCF2DPCi9kcvaZRlb7Hrmw5aggAOSCxZPta678FdkMhpKaOIXQAZ33jeoiJD14tLlwdr10yGN6LITO64/Dy0BwEckKOPtdZror0z7xw4LUWoum1rK2oXQIZdICeaqFzP+7XJpwCVDGu/ssnDt3AQwIEx0vnU9rUqur78dx/lWkJIbnuwrP/O+OE7RQVRpl0gJzH5d4YcPXiz3AOtMo5kUslhQGgGAjgwe4//eD/LR3LtxHePwzSTRY2c1pBNbAr7GJ5lF8gM/Tw7Q7LXoPUOs9+wEMAByrIjQkR6C9rJsxTh9PCqI3GhZyAYdTzUJmM1OfPSg8ho99GXt7IPDG1GAAco2VlgxPqBnIoMs5wQ5lQ9TpgHRc8Eo6WlTdsrmk78etGrtg8lp6/LdPJbsu3XsPQQIAI4UNGphRtZAkljuWG7Nc2leixJGBW/DWu0szWW2GkW3LO9O+/o4PcMb0BGNtn3GyYCOFBJIE0k46wr+sxmLdSxejwuK4xi6Th9X5tq8sXB2vxbN976pjx4CxkBHLDdbx/eVjGZZpuRms/PX1qbORN0rR5LCbPfF5KlF4dliLRqchK+qtnWcY1s8OAtXARw4HRp8XrG8xJ6na7+oT9rZ4Rj9TgWLfcMBLczFmZWk5MD57OH7+bu44eceBYwAjhwo52tcWyirEWD8UmztiZUj9OUVk2O4qzfasTSAwhgHH00j8W6oCESn7hHtwnV4zRlVZMz7bJQGUdmcoWlBxDASOx++/C2EbutaZE5ed24KdXjNGVUk492WViWR1j3xTECGC91lhZuiMj8O8hmnFXQpOpxmrKqyVbfV3WDdV+8QADjpeksLlpauDLvodysh2SZDhs/QZHV4zRlVZPTvm8seoe2G15FAOM1SQib+OQQVtmZ9ZBMjXFa/y26epymrGryrJq3Ebn33eMvy7t1Gq1EAOMtoydfj04K4Vmz1CZWj9OUVU0+6SHfNHz3Hj8s/LJTtB8BjBOdEMIzr8lpYvU4TZnV5Fdn14Qv5iGAMdNrITxnbbOp1eM0ZVWTX8yuY9E7hC/mIYAxVxLCS4vvzyoNNLl6nKasanKyji7mCmu+SEMAI9U0UGat0UaS/7YIqaJ6nDoAp90XM6vJo0fb87fzAQQwXJwbrPaNisvuh9Krx2liiZx+flG3JiNMBDBya0P1OE0Tbk1GuAhg5NaW6nGaOm9NRtgIYOTSpupxmjpvTUbYCGDk0qbqcZq6bk0GCGDk0rbqcZpYnA5qz3xrMiAEMPJoY/U4TefU4v2qbk0GXiCAkVkbq8dpqrw1GXiBAEZmba0ep6ni1mTgVQQwMmlz9ThN2bcmA28igJFJ66vHaUqqJgMnIYBhzYfqcRqqyagSAQxrPlSP01BNRpUIYFjzpXqchmoyqkIAw4pr9diIbDVt7+8sBVSTnd6oEA4CGFZcq8diHJtmFSqgmtyjmgwbBDCs+FY9TkM1GVUggJHKx+pxGqrJqAIBjFQ+Vo/TUE1GFQhgpHKsHs+8zr7pqCajbAQw5iqgetyqtd9XFVBNHrIMgXkIYMzlffU4jePB8VSTMQ8BjJlCqB6noZqMMhHAmCmE6nEaqskoEwGMmUKpHqehmoyyEMA40flLayuhVI/TUE1GWQhgnChacAyNFlWP01BNRlkIYJwotOpxGqrJKAMBjLeEWD1OQzUZZSCA8ZYQq8dpqCajDAQwXtNfGfZCrR6noZqMohHAeM1k/2A91OpxGqrJKBoBjNcEXz1OQzUZBSKA8RLV43RUk1EkAhgvUT1ORzUZRSKA8RLVYztGnXZDUE3GSwQwElSP7UVLS267PKgm4xgBjATVY3tUk1EUAhgJqsfZUE1GEQhgUD3OgWoyikAAg+pxDkk12W3ZhWoyCODQUT3OLzaR0xsP1WQQwIGjepwf1WS4IoADR/XYEdVkOCCAA0b12B3VZLgggAPmWj0WDWfv7yxFVJPPX/p7HsYFigAOmGv1OIrjIB++vcm1mtxZWGBPcKAI4EBRPS4O1WTkRQAHiupxcagmIy8COFBUj4tFNRl5EMABonpcPKrJyIMADpBz9VgMD9/eUEQ1+cw7P7MMERgCODCFVI8ffxXc2Q82XKvJIhEP4wJDAAeG6nF5qCYjKwI4MFSPS0Y1GRkQwAGhelw+qsnIggAOCNXj8lFNRhYEcEBUxen8WarHdqgmwxYBHIij6nH+vb9Uj+1RTYYtAjgQVI+rQzUZtgjgQFA9rhbVZNgggANA9bh6VJNhgwAOANXj6lFNhg0C2HNJ9diIy+Z+qsc5UU1GGgLYc0n12AXV49yoJiMNAew5qsc1o5qMOQhgj1E9rh/VZMxDAHuM6nH9qCZjHgLYY1SPm4FqMmYhgD1F9bg5qCZjFgLYUyFUjy8MVofLg7VrTf+ITjUZs3TrHgDKcVQ91txf3+Tq8fnfrK10jHz+Yobf6S7K8uW1+z89W7w+Hm3l3vZVplijOypx/hA9qiY39r8J8mEG7CHfq8evhu8LKrp+5vTzz+ob1XydpY7TnmCqyX4igD3kc/V4+fJH67PeXNTItaaGFNVknIQA9oz31WMzmRuwZ985+FV1g8mGajLeRAB7hupxc1FNxpsIYM9QPW44qsl4BQHsEarHzRdNxGkZgmqyXwhgjzhXjyV2mp0h3ejp9g7VZLxAAHvEuXpsTHMfvnmEajJeIIA9QfW4Pagm4wUC2BMhVI99QTUZLxDAnuDW43aJNXJbb+fWZC8QwB5wrh4b2WT5oVpUkyEEsB+cq8eOD4WQXSHV5FOOpRvULv9xWWiE/sqwF//8/F9dvodp0SlbKjKd6c+c7fv0Z0kz/bPuPX54pdhRoUoEcMstD9auqerduseBevz4bOFsU4/gRDqWIFrOtXqMdqOa3G4EcIsVUD1Gy1FNbjcCuMXcq8doOxUZsie4vbiSqMVcq8dGot8ZY1q1fhiJDEXNzD+3Mea6kahVW+oilXURk7tIE0XJVUetefiIv+EhXEudv7S20unqP+b9+rY+QU976NgR0/8/j7f/udpRuSlgJ8t49/HDswUOCRVhCaKlqB77g2pyuAjglqJ67BeqyWEigFto3sWUVqgeNw7V5DARwG2ksdPWI6rHzUM1OUwEcMt4f+txwJxvTVZKOW1DALcMtx77i1uTw0MAt0zotx6n7PEdt20L2lu4NTkoBHCLcOvx8SxRzMkhrNr6S0W5NTksBHCLLKo6PmTx49bjyMRXXts3O/3YbnRj99GXt2odWAGKuDWZPcHtQRW5VdzKF77ceny8he5Kvz/syemDvvx1cTTy6EjGo10q+c/5oJrcHlSRWyLU6nGIqCaHgyWIlqB6HA6qyeEggFuC6nFYJqIbTt+AanIrEMAtQPU4PN1T3R2qyf4jgNuA6nFwqCaHgQBuOKrH4aKa7D8CuOGoHoeLarL/COCGC716HDyqyV4jgBuM6jEiiTddvp5qcrMRwA1G9RijJ1+PqCb7iwBuNKrHcN/FclxNRgMRwA11/tLaisveXyOyxd5fP0RLS07LEGIcW5QoDQHcUFSP8QLVZH8RwA3lWj3+aX+R5QePuFaTIzHsCW4gAriBiqgejz06nhHu1WRRWWdPcPMQwE1E9RhvoJrsJwK4YageYxaqyf4hgBuG6jFmoZrsHwK4YVyrx9HkgPKFz1yryacPbhQ3GLgigBukiOrx6OmfdgocEhrGuZps9OPiRgNXBHCDUD1GGqrJfiGAG4XqMdJRTfYHAdwQVI9hi2qyPwjghqB6DFtUk/1BADcE1WNkQTXZDwRwA1A9RlZUk/1AADcB1WNkRDXZDwRwzc4NVvtUj5EH1eT2I4BrtiCR28MQqsfBoprcfgRwzagewwnV5FYjgGtE9RiuqCa3GwFcI6rHcEU1ud0I4FpRPYY7qsntRQDX5MJgdUj1GEVIqskue4KpJteGAK6JRh23LUBUj3EsqSbH4vIsgGpyTQjgmlA9RpGoJrcTAVwDqscoGtXkdiKA60D1GAWjmtxOBHDFqB6jLFST24cArhjVY5QlqSaLyb0zhmpy9QjgilE9RqmMOO2OoZpcLQK4QlSPUTaqye1CAFeI6jHKRjW5XQjgSlE9RvmoJrcHAVwRqseoCtXk9iCAK0L1GFWhmtweBHBFqB6jSlST24EArgDVY1SNanI7EMBVcKwex6IsPyCTIqrJ777zs0tjExYI4JIVUT0+ajgB2bhWk41EThMHpCOAS0b1GHWhmtx8BHDJqB6jVlSTG40ALhHVY9SNanKzEcAlcq0eG2OcthIBVJObjQAulVujqCMx679w5nyAv8Yc1F4SArgkVI/RFK7VZNfnGJiNAC4J1WM0BdXk5iKAS0L1GE1CNbmZCOASUD1G01BNbiYCuBQTp9kC1WMUjWpyMxHABUuqx+K0/YzqMUpBNbl5COCCUT1GU1FNbh4CuGBUj9FoVJMbhQAuENVjNB3V5GYhgAu0KJHTQwqqxygb1eRmIYCLpOK0/ED1GFWgmtwcBHBBqB6jLagmNwcBXBCqx2gLqsnNQQAXhOox2oRqcjMQwAWgeoy2SfYEU02uHQFcCKrHaCGqybUjgB1RPUZbUU2uHwHsiOox2opqcv0IYEdUj9FqVJNrRQA7oHqMtotOLd52+XqqyW4IYAdUj9F2yZ5gqsm1IYBdUD2GB6gm14cAzonqMXxBNbk+BHBOVI/hC6rJ9SGAc3KsHo+pHqNJXKvJqvHvixtNOAjgHAqoHt+neowmca0mqyh7gnMggHOhegwPUU2uHAGcEdVj+IpqcvUI4IyoHsNXVJOrRwBnRPUYXqOaXCkCOAPn6rHKDtVjNJlrNVlEWYbIgADOwLl6HBtmv2g012qyGFlhT7A9AjgLqscIANXk6hDAlqgeIxRUk6tDAFuieoxQUE2uDgFsieoxQkI1uRoEsAWqxwgN1eRqEMAW1ExWXL6e6jFaybGa3Fv4S/5JSyAIYCvG5ReJ6jFaybWaPOl2CeAUBLAN1fzLB1SP0VKu1WRjOiy7pSCALRiT/4kw1WO0mkM1+d/3u7Q+UxDAFjqnFu/neiBB9Rgtl7eabES2ePCcjgC2MNrZGkuOGjHVY7Rd8rsvmvn3OD40n5YzIr8QwJaOZwL2s1nVjb0n25ulDgqoQLTUvZVpLVh14/un23zys9CpewBtMf5htH/2wn/7B3MY/2dRmb8tTXVj99GXtyobHFCi5Hf/1+cfiEQropK2s+HT3ccP/1dFQ2s9rXsAbbQ8WLsWiV597WhKlbHEcj8Wvce2M/hq5u/+xNyLOrI5esTMFyW4MPhweG6w+ta7f3+w2u+f8L8Dvpv1uz/9d3L+0ppTeSkUzIAtXby8dltEPzHGbPy0v0i1GHhDrz/snTl1sK4qN2ORB9893uZ2jBQEsKWLlz/4R5FX137N6Mdni+8TxAjddMa7qJ3Pk/VhI8n5D0Zka+/xwyt1j63p2AVhob+SHCry+kcqje4RvoDID8k51/rFi/CVo5kdSxAWCGALh/v7b/4yjdjlAPxNslXt9bJSr3/p7wnhFASwheiNq+iNMU5npQK+SQobE3nt30Xc7XIoewoC2IKKfvzy/zCyScECeNvutw9vv3ahp4neq3VALUAAWzDR8XqWyjiSCbNfYAaNXqkgv7pXGCcigFMk+xlfPlzQO1ysCcx2VMR4eXZEn1sx5iOAU0Sdl09zefAGWHj17Igz7/zMLHgOAjhNdLT+Ozk0v6t7KEAbjHa2xkY6yVKEESWA5yCAU6iRFTGyyelOgL29x3+8r0a2VJQHcXMQwHMcFzB6PHgDslOZXFdJPT0taBxHOccve+dWRfSb3SdfcboZkNH4z9+Nf/Xr5bNnz54bj//f//2h7vE0UbfuATRZV2Q0erJN+AI5JRcZ7MfshAAANAtrwABQk/8fAAD//5K0hybsrMNPAAAAAElFTkSuQmCC"></input>
				<input name="public" type="Boolean" value="true"></input>
				<expected-trace command="Customer.Company.LinkLogo" status="success"></expected-trace>
			</activity>
			<activity type="mutation" id="MMb0o7" path="Company.linkControlFramework" description="Link control framework to company">
				<input name="arn" type="String" value="#companyArn#"></input>
				<input name="controlFrameworkArn" type="String" value="#frameworkArn#"></input>
				<expected-trace command="Customer.Company.LinkControlFramework" status="success"></expected-trace>
			</activity>
			<activity type="query" id="HUDqb8" description="Assert that framework is linked" path="Company.get" view="Company">
				<input name="key" type="String" value="#companyArn#"></input>
				<expect-value name="controlframework.0.name" type="String" value="EU General Data Protection Regulation (GDPR)"></expect-value>
			</activity>
			<activity type="mutation" id="8LL5x2" description="Upload logo for company" path="upload">
				<input name="name" type="String" value="anove:company:gate/logo.png"></input>
				<input name="content" type="String" value="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></input>
				<input name="public" type="Boolean" value="true"></input>
				<expected-trace command="Customer.Company.LinkLogo" status="success"></expected-trace>
				<expected-trace command="FileIntake-Notifier" status="success"></expected-trace>
			</activity>
		</scenario>
		<scenario extends="CreateAdministrator" name="Integrations">
			<activity path="-select-" type="set-variables" description="PrepareIntegration" id="ihTsBg">
				<input name="integrationArn" type="String" value="integration:test"></input>
				<input name="integrationName" type="String" value="Test"></input>
				<input name="integrationDescription" type="String" value="ipsum..."></input>
				<input name="integrationPath" type="String" value="integration:test/logo.png"></input>
			</activity>
			<activity path="Integrations.create" type="mutation" description="Create integration" id="Qa2hXA">
				<input name="arn" type="String" value="#integrationArn#"></input>
				<input name="name" type="String" value="#integrationName#"></input>
				<input name="description" type="String" value=""></input>
				<expected-trace command="Admin.Integrations.Create" status="success"></expected-trace>
			</activity>
			<activity path="Integrations.update" type="mutation" description="Update integration" id="kIIMsa">
				<input name="arn" type="String" value="#integrationArn#"></input>
				<input name="name" type="String" value="#integrationName#"></input>
				<input name="description" type="String" value="#integrationDescription#"></input>
				<expected-trace command="Admin.Integrations.Update" status="success"></expected-trace>
			</activity>
			<activity type="mutation" id="8LL5x2" description="Upload logo for integration" path="upload">
				<input name="name" type="String" value="#integrationPath#"></input>
				<input name="content" type="String" value="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></input>
				<input name="public" type="Boolean" value="true"></input>
				<expected-trace command="Admin.Integrations.LinkLogo" status="success"></expected-trace>
				<expected-trace command="FileIntake-Notifier" status="success"></expected-trace>
			</activity>
			<activity path="Integration.get" type="query" view="Integration" description="Check if integration is created" id="uHvzRl">
				<input name="key" type="String" value="#integrationArn#"></input>
				<expect-value name="arn" type="String" value="#integrationArn#"></expect-value>
				<expect-value name="name" type="String" value="#integrationName#"></expect-value>
				<expect-value name="description" type="String" value="#integrationDescription#"></expect-value>
			</activity>
		</scenario>
		<scenario extends="OnboardCompany" name="IntegrationImplementation">
			<activity path="-select-" type="switch-user" description="Make sure that we are user 1" user-number="1" id="4jmCfP"></activity>
			<activity path="-select-" type="set-variables" description="Prepare integration implementation" id="UxFLta">
				<input name="implementationArn" type="String" value="anove:company:gate:integration:test"></input>
			</activity>
			<activity path="Company.IntegrationImplementation.request" type="mutation" description="Create implementation request" id="jB8Cri">
				<input name="arn" type="String" value="#implementationArn#"></input>
				<input name="requirements" type="String" value="ipsum..."></input>
				<input name="reference" type="String" value="#integrationArn#"></input>
				<input name="owner" type="String" value="anove:company:gate:employee:j.doe"></input>
				<expected-trace command="Customer.IntegrationImplementation.Create" status="success"></expected-trace>
				<expected-trace command="SendIntegrationRequest-Notifier" status="success"></expected-trace>
			</activity>
			<activity path="Company.Integration.get" type="query" view="IntegrationImplementation" description="Check if request is created" id="2KZt6G">
				<input name="key" type="String" value="#implementationArn#"></input>
				<expect-value name="status" type="String" value="requested"></expect-value>
				<expect-value name="requirements" type="String" value="ipsum..."></expect-value>
				<expect-value name="integration.name" type="String" value="#integrationName#"></expect-value>
			</activity>
			<activity path="Company.IntegrationImplementation.addNote" type="mutation" description="Add note" id="PawvFm">
				<input name="arn" type="String" value="#implementationArn#"></input>
				<input name="message" type="String" value="Hello World!"></input>
				<expected-trace command="Customer.IntegrationImplementation.AddNote" status="success"></expected-trace>
			</activity>
			<activity path="-select-" type="grant-role" description="Make sure is admin" role="administrator" id="rivEjh"></activity>
			<activity path="Company.IntegrationImplementation.changeStatus" description="Change status" type="mutation" id="W0BRab">
				<input name="arn" type="String" value="#implementationArn#"></input>
				<input name="message" type="String" value="Change status"></input>
				<input name="status" type="String" value="accepted"></input>
				<expected-trace command="Customer.IntegrationImplementation.AddNote" status="success"></expected-trace>
			</activity>
			<activity path="Company.Integration.get" type="query" description="Check that status is changed" view="IntegrationImplementation" id="gbpEdz">
				<input name="key" type="String" value="#implementationArn#"></input>
				<expect-value name="status" type="String" value="accepted"></expect-value>
			</activity>
		</scenario>
		<scenario name="CreateAdministrator">
			<activity type="grant-role" id="WqLUX4" role="administrator" description="Setup requires admin permision"></activity>
		</scenario>
		<scenario extends="Controls" name="ThirdParty">
			<activity path="-select-" type="set-variables" description="Prepare thirdparty" id="ES4Y2c">
				<input name="tpOneArn" type="String" value="anove:company:gate:thirdparty:draftsman"></input>
				<input name="tpTwoArn" type="String" value="anove:company:gate:thirdparty:aws"></input>
				<input name="tpTaskArn" type="String" value="anove:company:gate:thirdparty:draftsman:mytask"></input>
				<input name="tpThreeArn" type="String" value=""></input>
			</activity>
			<activity path="Company.ThirdParty.create" type="mutation" description="Create thirdparty" id="lGYyKm">
				<input name="arn" type="String" value="#tpOneArn#"></input>
				<input name="name" type="String" value="Draftsman"></input>
				<input name="description" type="String" value="-"></input>
				<input name="role" type="String" value="-"></input>
				<input name="address" type="String" value="-"></input>
				<input name="companyRegistrationNumber" type="String" value="-"></input>
				<input name="country" type="String" value="#countryArn#"></input>
				<input name="knownCertification" type="String" value="-"></input>
				<input name="isCritical" type="Boolean" value="false"></input>
				<input name="isDirectThirdParty" type="Boolean" value="true"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<expected-trace command="ThirdPartyManagement.ThirdParty.Create" status="success"></expected-trace>
			</activity>
			<activity path="ThirdParty.get" type="query" description="Query tp" view="ThirdParty" id="HaGJzB">
				<input name="key" type="String" value="#tpOneArn#"></input>
				<expect-value name="name" type="String" value="Draftsman"></expect-value>
			</activity>
			<activity path="Company.ThirdParty.update" type="mutation" description="Update" id="9q4qcY">
				<input name="arn" type="String" value="#tpOneArn#"></input>
				<input name="name" type="String" value="Draftsman"></input>
				<input name="description" type="String" value="Using Tracepaper modeler"></input>
				<input name="role" type="String" value="-"></input>
				<input name="address" type="String" value="-"></input>
				<input name="companyRegistrationNumber" type="String" value="-"></input>
				<input name="country" type="String" value="#countryArn#"></input>
				<input name="knownCertification" type="String" value="-"></input>
				<input name="isCritical" type="Boolean" value="false"></input>
				<input name="isDirectThirdParty" type="Boolean" value="true"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<expected-trace command="ThirdPartyManagement.ThirdParty.Update" status="success"></expected-trace>
			</activity>
			<activity path="ThirdParty.get" type="query" view="ThirdParty" description="Query tp" id="iATNpn">
				<input name="key" type="String" value="#tpOneArn#"></input>
				<expect-value name="description" type="String" value="Using Tracepaper modeler"></expect-value>
			</activity>
			<activity path="Company.ThirdParty.create" type="mutation" description="Create second tp" id="ztCGTy">
				<input name="arn" type="String" value="#tpTwoArn#"></input>
				<input name="name" type="String" value="AWS"></input>
				<input name="description" type="String" value="-"></input>
				<input name="role" type="String" value="-"></input>
				<input name="address" type="String" value="-"></input>
				<input name="companyRegistrationNumber" type="String" value="-"></input>
				<input name="country" type="String" value="#countryArn#"></input>
				<input name="knownCertification" type="String" value="-"></input>
				<input name="isCritical" type="Boolean" value="true"></input>
				<input name="isDirectThirdParty" type="Boolean" value="true"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<expected-trace command="ThirdPartyManagement.ThirdParty.Create" status="success"></expected-trace>
			</activity>
			<activity path="Company.ThirdParty.linkSubprocessor" type="mutation" description="Link tp" id="u3yY7K">
				<input name="arn" type="String" value="#tpOneArn#"></input>
				<input name="subprocessorArn" type="String" value="#tpTwoArn#"></input>
				<expected-trace command="ThirdPartyManagement.ThirdParty.LinkSubprocessor" status="success"></expected-trace>
			</activity>
			<activity path="ThirdParty.get" type="query" view="ThirdParty" description="Query link" id="YZ4a9W">
				<input name="key" type="String" value="#tpOneArn#"></input>
				<expect-value name="subprocessors.thirdparties.0.arn" type="String" value="#tpTwoArn#"></expect-value>
				<expect-value name="subprocessors.arn" type="String" value="#tpOneArn#"></expect-value>
			</activity>
			<activity path="Company.ThirdParty.unlinkSubprocessor" type="mutation" description="Unlink tp" id="UJ99po">
				<input name="arn" type="String" value="#tpOneArn#"></input>
				<input name="subprocessorArn" type="String" value="#tpTwoArn#"></input>
				<expected-trace command="ThirdPartyManagement.ThirdParty.UnlinkSubprocessor" status="success"></expected-trace>
			</activity>
			<activity path="Company.ThirdParty.Task.create" type="mutation" description="Create task" id="C18Keo">
				<input name="arn" type="String" value="#tpTaskArn#"></input>
				<input name="name" type="String" value="Task"></input>
				<input name="description" type="String" value="hello"></input>
				<input name="assignee" type="String" value="#employeeArn#"></input>
				<input name="dueDate" type="String" value="2025-08-01"></input>
				<input name="notes" type="String" value="-"></input>
				<expected-trace command="ThirdPartyManagement.ThirdParty.CreateTask" status="success"></expected-trace>
			</activity>
			<activity path="ThirdParty.getTasks" type="query" view="ThirdPartyTask" description="Check if task is created" id="opb0o6">
				<input name="key_begins_with" type="String" value="#tpOneArn#"></input>
				<expect-value name="resultset.0.name" type="String" value="Task"></expect-value>
			</activity>
			<activity path="Company.ThirdParty.Task.update" type="mutation" description="Update Task" id="uxN3xY">
				<input name="arn" type="String" value="#tpTaskArn#"></input>
				<input name="name" type="String" value="Hello World!"></input>
				<input name="description" type="String" value=""></input>
				<input name="assignee" type="String" value=""></input>
				<input name="dueDate" type="String" value=""></input>
				<input name="notes" type="String" value=""></input>
				<expected-trace command="ThirdPartyManagement.ThirdParty.UpdateTask" status="success"></expected-trace>
			</activity>
			<activity path="ThirdParty.getTasks" type="query" view="ThirdPartyTask" description="Check if task is updated" id="tfqNN8">
				<input name="key_begins_with" type="String" value="#tpOneArn#"></input>
				<expect-value name="resultset.0.name" type="String" value="Hello World!"></expect-value>
			</activity>
			<activity path="Company.ThirdParty.Task.complete" type="mutation" description="Complete task" id="gFSQfO">
				<input name="arn" type="String" value="#tpTaskArn#"></input>
				<expected-trace command="ThirdPartyManagement.ThirdParty.CompleteTask" status="success"></expected-trace>
			</activity>
			<activity path="Company.ThirdParty.createFromTemplate" type="mutation" description="Create from template" id="bxf9ld">
				<input name="arn" type="String" value="#tpThreeArn#"></input>
				<input name="role" type="String" value="-"></input>
				<input name="isCritical" type="Boolean" value="true"></input>
				<input name="isDirectThirdParty" type="Boolean" value="true"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<input name="templateArn" type="String" value="#tpTemplateArn#"></input>
				<expected-trace command="ThirdPartyManagement.ThirdParty.Create" status="success"></expected-trace>
				<expected-trace command="CreateThirdpartyFromTemplate-Notifier" status="success"></expected-trace>
			</activity>
		</scenario>
		<scenario extends="CreateAdministrator" name="RiskTemplate">
			<activity path="RiskTemplate.create" type="mutation" description="Create a risktemplate" id="wPbPVR">
				<input name="arn" type="String" value="risktemplate:template"></input>
				<input name="name" type="String" value="Hello"></input>
				<input name="description" type="String" value="World"></input>
				<input name="grossLikelihood" type="Int" value="3"></input>
				<input name="grossImpact" type="Int" value="3"></input>
				<input name="reviewPeriodicity" type="String" value="3M"></input>
				<expected-trace command="Admin.RiskTemplate.Create" status="success"></expected-trace>
			</activity>
			<activity path="RiskTemplate.get" type="query" view="RiskTemplate" description="Check if template is created" id="RrEjw6">
				<input name="key" type="String" value="risktemplate:template:1-PREVIEW"></input>
				<expect-value name="name" type="String" value="Hello"></expect-value>
			</activity>
			<activity path="RiskTemplate.release" type="mutation" description="Release template" id="HYXX5d">
				<input name="arn" type="String" value="risktemplate:template"></input>
				<expected-trace command="Admin.RiskTemplate.Release" status="success"></expected-trace>
			</activity>
			<activity path="RiskTemplate.get" type="query" view="RiskTemplate" description="Check if template is released" id="29jv4P">
				<input name="key" type="String" value="risktemplate:template:1"></input>
				<expect-value name="name" type="String" value="Hello"></expect-value>
			</activity>
			<activity path="RiskTemplate.update" type="mutation" description="Update risktemplate" id="wEd0uB">
				<input name="arn" type="String" value="risktemplate:template"></input>
				<input name="name" type="String" value="Hello World!"></input>
				<input name="description" type="String" value=""></input>
				<input name="grossLikelihood" type="Int" value="0"></input>
				<input name="grossImpact" type="Int" value="0"></input>
				<input name="reviewPeriodicity" type="String" value=""></input>
				<expected-trace command="Admin.RiskTemplate.Update" status="success"></expected-trace>
			</activity>
			<activity path="RiskTemplate.get" type="query" view="RiskTemplate" description="Check if the released version is unaltered" id="tLQAkP">
				<input name="key" type="String" value="risktemplate:template:1"></input>
				<expect-value name="name" type="String" value="Hello"></expect-value>
			</activity>
			<activity path="RiskTemplate.get" type="query" view="RiskTemplate" description="Check if a new preview version is added" id="cU8mPC">
				<input name="key" type="String" value="risktemplate:template:2-PREVIEW"></input>
				<expect-value name="name" type="String" value="Hello World!"></expect-value>
			</activity>
		</scenario>
		<scenario name="Cleanup" extends="Risks;Objectives;Assets;ProcessingActivity;ThirdPartyAssessment;IntegrationImplementation">
			<activity description="Switch to first user" type="switch-user" user-number="1" id="YECd9W"></activity>
			<activity path="-select-" type="grant-role" description="Make sure is admin" role="administrator" id="E0uGgt"></activity>
			<activity type="mutation" id="BUhvG6" description="Remove business unit" path="Company.BusinessUnit.remove">
				<input name="arn" type="String" value="#companyArn#"></input>
				<input name="name" type="String" value="Engineering"></input>
				<expected-trace command="Customer.Company.RemoveBusinessUnit" status="success"></expected-trace>
			</activity>
			<activity type="mutation" id="4ZqLEA" description="Unlink framework" path="Company.unlinkControlFramework">
				<input name="arn" type="String" value="#companyArn#"></input>
				<input name="controlFrameworkArn" type="String" value="#frameworkArn#"></input>
				<expected-trace command="Customer.Company.UnlinkControlFramework" status="success"></expected-trace>
			</activity>
			<activity path="ControlFramework.delete" type="mutation" description="Delete controlframework" id="u4Zdpi">
				<input name="arn" type="String" value="controlframework:eugeneraldataprotectionregulationgdpr"></input>
				<expected-trace command="Admin.ControlFramework.Delete" status="success"></expected-trace>
				<expected-trace command="RemoveRequirements-Notifier" status="success"></expected-trace>
				<expected-trace command="Admin.Requirement.Delete" status="success"></expected-trace>
			</activity>
			<activity path="ControlTemplate.delete" type="mutation" description="Delete control template" id="kQwkjz">
				<input name="arn" type="String" value="controltemplate:mytemplate"></input>
				<expected-trace command="Admin.ControlTemplate.Delete" status="success"></expected-trace>
			</activity>
			<activity path="Industry.delete" type="mutation" description="Delete industry" id="A4N12N">
				<input name="arn" type="String" value="industry:informationtechnologyitandservices"></input>
				<expected-trace command="Admin.Industry.Delete" status="success"></expected-trace>
			</activity>
			<activity path="Region.delete" type="mutation" description="delete region" id="XQADTM">
				<input name="arn" type="String" value="region:EMEA"></input>
				<expected-trace command="Admin.Region.Delete" status="success"></expected-trace>
			</activity>
			<activity path="RiskTemplate.delete" type="mutation" description="Delete risktemplate" id="uQj6ND">
				<input name="arn" type="String" value="risktemplate:template"></input>
				<expected-trace command="Admin.RiskTemplate.Delete" status="success"></expected-trace>
			</activity>
			<activity path="Tenant.delete" type="mutation" description="Delete tenant" id="u6vnSv">
				<input name="key" type="String" value="anove"></input>
				<expected-trace command="Admin.Tenant.Delete" status="success"></expected-trace>
				<expected-trace command="Customer.Company.Delete" status="success"></expected-trace>
				<expected-trace command="Customer.Objective.Delete" status="success"></expected-trace>
				<expected-trace command="Customer.Risk.Delete" status="success"></expected-trace>
				<expected-trace command="Customer.Control.Delete" status="success"></expected-trace>
				<expected-trace command="Customer.Asset.Delete" status="success"></expected-trace>
				<expected-trace command="Customer.ProcessingActivity.Delete" status="success"></expected-trace>
				<expected-trace command="ThirdPartyManagement.ThirdParty.Delete" status="success"></expected-trace>
				<expected-trace command="ThirdPartyManagement.Assessment.Delete" status="success"></expected-trace>
				<expected-trace command="Customer.IntegrationImplementation.Delete" status="success"></expected-trace>
			</activity>
			<activity path="Integrations.delete" type="mutation" description="Delete integration" id="eb5FOp">
				<input name="arn" type="String" value="#integrationArn#"></input>
				<expected-trace command="Admin.Integrations.Delete" status="success"></expected-trace>
			</activity>
			<activity path="ThirdPartyTemplate.delete" type="mutation" description="Delete tp template" id="9qVA0B">
				<input name="arn" type="String" value="#tpTemplateArn#"></input>
				<expected-trace command="Admin.ThirdPartyTemplate.Delete" status="success"></expected-trace>
			</activity>
		</scenario>
		<scenario extends="CreateAdministrator" name="ThirdPartyTemplate">
			<activity path="-select-" type="set-variables" description="prepare template" id="uamlau">
				<input name="tpTemplateArn" type="String" value="thirdpartytemplate:draftsman"></input>
			</activity>
			<activity path="ThirdPartyTemplate.create" description="Create template" type="mutation" id="4GryEX">
				<input name="arn" type="String" value="#tpTemplateArn#"></input>
				<input name="name" type="String" value="Draftsman"></input>
				<input name="description" type="String" value="-"></input>
				<input name="address" type="String" value="-"></input>
				<input name="companyRegistrationNumber" type="String" value="-"></input>
				<input name="country" type="String" value="region:EMEA:country:NL"></input>
				<input name="knownCertification" type="String" value="-"></input>
				<expected-trace command="Admin.ThirdPartyTemplate.Create" status="success"></expected-trace>
			</activity>
			<activity path="ThirdPartyTemplate.update" type="mutation" description="Update" id="7fK4ou">
				<input name="arn" type="String" value="#tpTemplateArn#"></input>
				<input name="name" type="String" value="Draftsman"></input>
				<input name="description" type="String" value="Provides Tracepaper modelling studio"></input>
				<input name="address" type="String" value="-"></input>
				<input name="companyRegistrationNumber" type="String" value="-"></input>
				<input name="country" type="String" value="region:EMEA:country:NL"></input>
				<input name="knownCertification" type="String" value="-"></input>
				<expected-trace command="Admin.ThirdPartyTemplate.Update" status="success"></expected-trace>
			</activity>
			<activity path="ThirdPartyTemplate.get" type="query" view="ThirdPartyTemplate" description="Check if template is created" id="5UYIKD">
				<input name="key" type="String" value="#tpTemplateArn#"></input>
				<expect-value name="name" type="String" value="Draftsman"></expect-value>
				<expect-value name="description" type="String" value="Provides Tracepaper modelling studio"></expect-value>
			</activity>
		</scenario>
		<scenario name="BusinessUnit" extends="OnboardCompany">
			<activity type="mutation" id="eBu35p" description="Create business unit" path="Company.BusinessUnit.add">
				<input name="arn" type="String" value="#companyArn#"></input>
				<input name="name" type="String" value="Engineering"></input>
				<input name="description" type="String" value="Test"></input>
				<expected-trace command="Customer.Company.AddBusinessUnit" status="success"></expected-trace>
			</activity>
			<activity type="query" id="tvvozy" path="Company.get" view="Company" description="Assert business unit is added">
				<input name="key" type="String" value="#companyArn#"></input>
				<expect-value name="businessUnits.0.name" type="String" value="Engineering"></expect-value>
				<expect-value name="businessUnits.0.description" type="String" value="Test"></expect-value>
			</activity>
			<activity type="mutation" id="eM1zuN" path="Company.BusinessUnit.update" description="Update businessunit">
				<input name="arn" type="String" value="#companyArn#"></input>
				<input name="name" type="String" value="Engineering"></input>
				<input name="description" type="String" value="Hello World!"></input>
				<expected-trace command="Customer.Company.UpdateBusinessUnit" status="success"></expected-trace>
			</activity>
			<activity type="query" id="PnWvqv" description="Assert that the business unit description is updated" path="Company.get" view="Company">
				<input name="key" type="String" value="#companyArn#"></input>
				<expect-value name="businessUnits.0.name" type="String" value="Engineering"></expect-value>
				<expect-value name="businessUnits.0.description" type="String" value="Hello World!"></expect-value>
			</activity>
			<activity type="mutation" id="Rq94z1" description="Try to add a duplicate business unit" path="Company.BusinessUnit.add">
				<input name="arn" type="String" value="#companyArn#"></input>
				<input name="name" type="String" value="Engineering"></input>
				<input name="description" type="String" value="This should fail!"></input>
				<expected-trace command="Customer.Company.AddBusinessUnit" status="error"></expected-trace>
			</activity>
			<activity type="mutation" id="Sf1Adu" description="Try to update a non existing business unit" path="Company.BusinessUnit.update">
				<input name="arn" type="String" value="#companyArn#"></input>
				<input name="name" type="String" value="MyUnit"></input>
				<input name="description" type="String" value="This should fail!"></input>
				<expected-trace command="Customer.Company.UpdateBusinessUnit" status="error"></expected-trace>
			</activity>
		</scenario>
		<scenario extends="Controls" name="Assets">
			<activity path="-select-" type="set-variables" description="Prepare asset" id="KUZZ8u">
				<input name="assetArn" type="String" value="anove:company:gate:asset:qga"></input>
				<input name="assetTaskArn" type="String" value="anove:company:gate:asset:qga:task"></input>
			</activity>
			<activity path="Company.Asset.create" type="mutation" description="Create asset" id="SJfJw2">
				<input name="arn" type="String" value="#assetArn#"></input>
				<input name="name" type="String" value="Gate"></input>
				<input name="description" type="String" value="Hello World!"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<input name="confidentiality" type="String" value="1"></input>
				<input name="integrity" type="String" value="1"></input>
				<input name="availability" type="String" value="1"></input>
				<input name="privacy" type="String" value="1"></input>
				<expected-trace command="Customer.Asset.Create" status="success"></expected-trace>
			</activity>
			<activity path="Asset.get" type="query" description="Check that the asset is created" view="Asset" id="JluhPE">
				<input name="key" type="String" value="#assetArn#"></input>
				<expect-value name="name" type="String" value="Gate"></expect-value>
				<expect-value name="description" type="String" value="Hello World!"></expect-value>
				<expect-value name="owner" type="String" value="#employeeArn#"></expect-value>
				<expect-value name="confidentiality" type="String" value="1"></expect-value>
				<expect-value name="integrity" type="String" value="1"></expect-value>
				<expect-value name="availability" type="String" value="1"></expect-value>
				<expect-value name="privacy" type="String" value="1"></expect-value>
			</activity>
			<activity path="Company.Asset.update" type="mutation" description="Update asset" id="MSY3G5">
				<input name="arn" type="String" value="#assetArn#"></input>
				<input name="name" type="String" value=""></input>
				<input name="description" type="String" value=""></input>
				<input name="owner" type="String" value=""></input>
				<input name="confidentiality" type="String" value="0"></input>
				<input name="integrity" type="String" value="1"></input>
				<input name="availability" type="String" value="2"></input>
				<input name="privacy" type="String" value="3"></input>
				<expected-trace command="Customer.Asset.Update" status="success"></expected-trace>
			</activity>
			<activity path="Asset.get" type="query" description="Check that the asset is updated" view="Asset" id="JluhPWE">
				<input name="key" type="String" value="#assetArn#"></input>
				<expect-value name="name" type="String" value="Gate"></expect-value>
				<expect-value name="description" type="String" value="Hello World!"></expect-value>
				<expect-value name="owner" type="String" value="#employeeArn#"></expect-value>
				<expect-value name="confidentiality" type="String" value="0"></expect-value>
				<expect-value name="integrity" type="String" value="1"></expect-value>
				<expect-value name="availability" type="String" value="2"></expect-value>
				<expect-value name="privacy" type="String" value="3"></expect-value>
			</activity>
			<activity path="Company.Asset.Task.create" type="mutation" description="Create asset task" id="kHWkfl">
				<input name="arn" type="String" value="#assetTaskArn#"></input>
				<input name="name" type="String" value="Task"></input>
				<input name="description" type="String" value="Hello World!"></input>
				<input name="assignee" type="String" value="#employeeArn#"></input>
				<input name="dueDate" type="String" value="2025-08-01"></input>
				<input name="notes" type="String" value="test"></input>
				<expected-trace command="Customer.Asset.CreateTask" status="success"></expected-trace>
			</activity>
			<activity path="Asset.getTasks" type="query" view="AssetTask" description="Check if task is created" id="zk8BOw">
				<input name="key_begins_with" type="String" value="#companyArn#"></input>
				<expect-value name="resultset.0.name" type="String" value="Task"></expect-value>
				<expect-value name="resultset.0.description" type="String" value="Hello World!"></expect-value>
			</activity>
			<activity path="Company.Asset.Task.update" type="mutation" description="Update task" id="05jiZJ">
				<input name="arn" type="String" value="#assetTaskArn#"></input>
				<input name="name" type="String" value="Update Test"></input>
				<input name="description" type="String" value=""></input>
				<input name="assignee" type="String" value=""></input>
				<input name="dueDate" type="String" value=""></input>
				<input name="notes" type="String" value=""></input>
				<expected-trace command="Customer.Asset.UpdateTask" status="success"></expected-trace>
			</activity>
			<activity path="Asset.getTasks" type="query" view="AssetTask" description="Check if task is updated" id="nKoW6W">
				<input name="key_begins_with" type="String" value="#companyArn#"></input>
				<expect-value name="resultset.0.name" type="String" value="Update Test"></expect-value>
			</activity>
			<activity path="Company.Asset.Task.complete" type="mutation" description="Complete the task" id="CbWkXa">
				<input name="arn" type="String" value="#assetTaskArn#"></input>
				<expected-trace command="Customer.Asset.CompleteTask" status="success"></expected-trace>
			</activity>
			<activity path="Company.Asset.Task.update" type="mutation" description="Try to update the task again" id="QBOvOZ">
				<input name="arn" type="String" value="#assetTaskArn#"></input>
				<input name="name" type="String" value="-"></input>
				<input name="description" type="String" value="-"></input>
				<input name="assignee" type="String" value=""></input>
				<input name="dueDate" type="String" value=""></input>
				<input name="notes" type="String" value="-"></input>
				<expected-trace command="Customer.Asset.UpdateTask" status="error"></expected-trace>
			</activity>
		</scenario>
		<scenario name="Risks" extends="InviteAndSwitchUser;RiskTemplate">
			<activity path="-select-" type="switch-user" user-number="1" description="Make sure user 1 is selected" id="83360u"></activity>
			<activity path="-select-" type="set-variables" description="Prepare risk" id="Hqiihg">
				<input name="riskArn" type="String" value="anove:company:gate:risk:myrisk"></input>
				<input name="impactOnRisk" type="Numeric" value="50"></input>
			</activity>
			<activity path="Company.Risk.create" type="mutation" description="Create risk" id="0mFEh7">
				<input name="arn" type="String" value="#riskArn#"></input>
				<input name="name" type="String" value="My Risk"></input>
				<input name="description" type="String" value="-"></input>
				<input name="grossLikelihood" type="Int" value="5"></input>
				<input name="grossImpact" type="Int" value="5"></input>
				<input name="apetiteLikelihood" type="Int" value="4"></input>
				<input name="apetiteImpact" type="Int" value="4"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<input name="reviewPeriodicity" type="String" value="1Y"></input>
				<input name="nextReviewDate" type="String" value="2024-08-01"></input>
				<input name="controlLinks" type="Nested" value='[{"arn":"#controlArn#","impactOnRisk":"#impactOnRisk#"}]'></input>
				<input name="treatmentPlan" type="Nested" value='[{"type":"mitigate","description":"controls"}]'></input>
				<expected-trace command="Customer.Risk.Create" status="success"></expected-trace>
			</activity>
			<activity path="Risk.get" description="assert that risk is created" type="query" view="Risk" id="YEirDR">
				<input name="key" type="String" value="#riskArn#"></input>
				<expect-value name="name" type="String" value="My Risk"></expect-value>
				<expect-value name="description" type="String" value="-"></expect-value>
				<expect-value name="grossLikelihood" type="Int" value="5"></expect-value>
				<expect-value name="grossImpact" type="Int" value="5"></expect-value>
				<expect-value name="apetiteLikelihood" type="Int" value="4"></expect-value>
				<expect-value name="apetiteImpact" type="Int" value="4"></expect-value>
				<expect-value name="reviewPeriodicity" type="String" value="1Y"></expect-value>
				<expect-value name="nextReviewDate" type="String" value="2024-08-01"></expect-value>
				<expect-value name="controlLinks.0.arn" type="String" value="#controlArn#"></expect-value>
				<expect-value name="controlLinks.0.impactOnRisk" type="Int" value="50"></expect-value>
				<expect-value name="treatmentPlan.0.type" type="String" value="mitigate"></expect-value>
				<expect-value name="treatmentPlan.0.description" type="String" value="controls"></expect-value>
			</activity>
			<activity path="Company.Risk.update" type="mutation" description="update risk" id="6xvd01">
				<input name="arn" type="String" value="#riskArn#"></input>
				<input name="description" type="String" value="Hello World"></input>
				<input name="grossLikelihood" type="Int" value="4"></input>
				<input name="grossImpact" type="Int" value="4"></input>
				<input name="apetiteLikelihood" type="Int" value="3"></input>
				<input name="apetiteImpact" type="Int" value="3"></input>
				<input name="reviewPeriodicity" type="String" value="2Y"></input>
				<input name="nextReviewDate" type="String" value="2025-08-01"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<input name="controlLinks" type="Nested" value='[{"arn":"#controlArn#","impactOnRisk":"#impactOnRisk#"}]'></input>
				<input name="treatmentPlan" type="Nested" value='[{"type":"mitigate","description":"user controls"}]'></input>
				<expected-trace command="Customer.Risk.Update" status="success"></expected-trace>
			</activity>
			<activity path="Risk.get" description="assert that risk is updated" type="query" view="Risk" id="YEirDR2">
				<input name="key" type="String" value="#riskArn#"></input>
				<expect-value name="name" type="String" value="My Risk"></expect-value>
				<expect-value name="description" type="String" value="Hello World"></expect-value>
				<expect-value name="grossLikelihood" type="Int" value="4"></expect-value>
				<expect-value name="grossImpact" type="Int" value="4"></expect-value>
				<expect-value name="apetiteLikelihood" type="Int" value="3"></expect-value>
				<expect-value name="apetiteImpact" type="Int" value="3"></expect-value>
				<expect-value name="reviewPeriodicity" type="String" value="2Y"></expect-value>
				<expect-value name="nextReviewDate" type="String" value="2025-08-01"></expect-value>
				<expect-value name="controlLinks.0.arn" type="String" value="#controlArn#"></expect-value>
				<expect-value name="controlLinks.0.impactOnRisk" type="Int" value="50"></expect-value>
				<expect-value name="treatmentPlan.0.type" type="String" value="mitigate"></expect-value>
				<expect-value name="treatmentPlan.0.description" type="String" value="user controls"></expect-value>
			</activity>
			<activity path="Company.Risk.Action.create" type="mutation" description="Create risk action" id="SmnL0n">
				<input name="arn" type="String" value="#riskArn#"></input>
				<input name="name" type="String" value="Test"></input>
				<input name="description" type="String" value="hello world"></input>
				<input name="assignee" type="String" value="#employeeArn#"></input>
				<input name="dueDate" type="String" value="2024-08-01"></input>
				<expected-trace command="Customer.Risk.CreateAction" status="success"></expected-trace>
			</activity>
			<activity path="Risk.get" type="query" view="Risk" description="assert that action is created" id="VvtzPt">
				<input name="key" type="String" value="#riskArn#"></input>
				<extract-value put-key="riskAction" name="actions.0.id"></extract-value>
				<expect-value name="actions.0.name" type="String" value="Test"></expect-value>
			</activity>
			<activity path="Risk.getActions" type="query" view="RiskAction" description="Test riskaction query" id="3pijlQ">
				<input name="key_begins_with" type="String" value="#companyArn#"></input>
				<expect-value name="resultset.0.name" type="String" value="Test"></expect-value>
			</activity>
			<activity path="Company.Risk.Action.update" type="mutation" id="LQchyK">
				<input name="arn" type="String" value="#riskArn#"></input>
				<input name="actions" type="Nested" value='[{"name":"Test 2","description":"hello world!","assignee":"#employeeArn#","dueDate":"2024-08-01","notes":"Hello World!","id":"#riskAction#"}]'></input>
				<expected-trace command="Customer.Risk.UpdateAction" status="success"></expected-trace>
			</activity>
			<activity path="Risk.get" type="query" view="Risk" description="assert that action is updated" id="VvtzPt2">
				<input name="key" type="String" value="#riskArn#"></input>
				<expect-value name="actions.0.name" type="String" value="Test 2"></expect-value>
				<expect-value name="actions.0.notes" type="String" value="Hello World!"></expect-value>
				<extract-value put-key="actionArn" name="actions.0.arn"></extract-value>
			</activity>
			<activity path="Company.Risk.Action.complete" type="mutation" id="mhpHRX" description="Complete risk action">
				<input name="arn" type="String" value="#actionArn#"></input>
				<expected-trace command="Customer.Risk.CompleteAction" status="success"></expected-trace>
			</activity>
			<activity path="Company.Risk.startAssessment" type="mutation" description="Start Risk Assesment" id="cfnphy">
				<input name="arn" type="String" value="#riskArn#"></input>
				<expected-trace command="Customer.Risk.CreateAction" status="success"></expected-trace>
			</activity>
			<activity path="Company.Risk.createFromTemplate" type="mutation" description="Create risk from template" id="sDHPaA">
				<input name="arn" type="String" value="anove:company:gate:risk:fromtemplate"></input>
				<input name="template" type="String" value="risktemplate:template:1"></input>
				<input name="apetiteLikelihood" type="Int" value="1"></input>
				<input name="apetiteImpact" type="Int" value="1"></input>
				<input name="nextReviewDate" type="String" value="2025-09-01"></input>
				<input name="owner" type="String" value="#employeeArn#"></input>
				<expected-trace command="CreateRiskFromTemplate-Notifier" status="success"></expected-trace>
				<expected-trace command="Customer.Risk.Create" status="success"></expected-trace>
			</activity>
		</scenario>
		<scenario extends="ThirdParty" name="ThirdPartyAssessment">
			<activity path="-select-" type="set-variables" description="Prepare assessment" id="tHE87Z">
				<input name="assessmentArn" type="String" value="anove:company:gate:thirdparty:draftsman:assessment:test"></input>
				<input name="assessmentName" type="String" value="Hello"></input>
				<input name="assessmentId" type="String" value="World"></input>
			</activity>
			<activity path="Company.ThirdParty.Assessment.create" type="mutation" description="Create" id="3yitXt">
				<input name="arn" type="String" value="#assessmentArn#"></input>
				<input name="name" type="String" value="#assessmentName#"></input>
				<input name="formBricksId" type="String" value="#assessmentId#"></input>
				<expected-trace command="ThirdPartyManagement.Assessment.Create" status="success"></expected-trace>
			</activity>
			<activity path="Questionaire.get" type="query" view="Questionaire" description="Check if created" id="qV4Rx2">
				<input name="key" type="String" value="#assessmentArn#"></input>
				<expect-value name="arn" type="String" value="#assessmentArn#"></expect-value>
				<expect-value name="name" type="String" value="#assessmentName#"></expect-value>
				<expect-value name="formBricksId" type="String" value="#assessmentId#"></expect-value>
			</activity>
			<activity path="Company.ThirdParty.Assessment.update" type="mutation" description="Update" id="6Hag57">
				<input name="arn" type="String" value="#assessmentArn#"></input>
				<input name="name" type="String" value="#assessmentName#"></input>
				<input name="formBricksId" type="String" value="#assessmentId#"></input>
				<expected-trace command="ThirdPartyManagement.Assessment.Update" status="success"></expected-trace>
			</activity>
			<activity path="Company.ThirdParty.Assessment.delete" type="mutation" description="Delete" id="nquzo8">
				<input name="arn" type="String" value="#assessmentArn#"></input>
				<expected-trace command="ThirdPartyManagement.Assessment.Delete" status="success"></expected-trace>
			</activity>
			<activity path="Company.ThirdParty.Assessment.update" type="mutation" description="Reactivate" id="H60fh9">
				<input name="arn" type="String" value="#assessmentArn#"></input>
				<input name="name" type="String" value="#assessmentName#"></input>
				<input name="formBricksId" type="String" value="#assessmentId#"></input>
				<expected-trace command="ThirdPartyManagement.Assessment.Update" status="success"></expected-trace>
			</activity>
		</scenario>
	</functional-scenarios>
</draftsman>